-------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  log
       log:  /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/matching_eventstudy_example.log
  log type:  text
 opened on:  17 Apr 2025, 11:38:59
  - simulate_yearly_data, out(${data}person_year_data.dta)
  = simulate_yearly_data, out(../data/person_year_data.dta)
    -------------------------------------------------------------------------------------------------------------------------------- begin simulate_yearly_data ---
    - syntax, out(str) [ startyear(int 1990) endyear(int 2005) number_firms(int 100) number_workers(int 10000) ]
    - clear
    - set obs `number_firms'
    = set obs 100
Number of observations (_N) was 0, now 100.
    - g estabid = _n
    - g industry= ceil(uniform()*7)
    - label define industry 1 "Mining" 2 "Construction" 3 "Manufacturing" 4 "Health" 5 "Finance" 6 "FCSL" 7 "Professional Services"
    - label values industry industry
    - g industryeff = .0*rnormal()
    - replace industryeff = -.2 if industry==6
(20 real changes made)
    - replace industryeff = 0 if industry==7
(0 real changes made)
    - g firmsize = rexponential(500)
    - g firmeff = industryeff + 0.01 * log(firmsize) + .01*rnormal()
    - isid estabid
    - label var estabid "Firm ID within industry - only for simulation"
    - label var industry "Industry"
    - label var firmsize "Firm size"
    - label var firmeff "Cominbed firm effect (ind + size + rand)"
    - label var industryeff "Industry effect"
    - tempfile firmdata
    - save `firmdata'
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 saved as .dta format
    - clear
    - set obs `number_workers'
    = set obs 10000
Number of observations (_N) was 0, now 10,000.
    - g persid = _n
    - g female = uniform()<.4
    - g edyrs = 8 + floor(uniform()* 8)
    - g personfe = rnormal(0,1.5)
    - g stateid = round(uniform()*20)
    - g byear = 1900 + round(uniform()*100)
    - label var female "Female"
    - label var edyrs "Years of Schooling"
    - label var personfe "Persone Effect"
    - label var stateid "State ID"
    - label var byear "Birth Year"
    - g years_in_data = `endyear' - `startyear' + 1
    = g years_in_data = 2005 - 1990 + 1
    - expand years_in_data
(150,000 observations created)
    - bys persid : g year = `startyear' + _n - 1
    = bys persid : g year = 1990 + _n - 1
    - g time = year
    - label var time "Year"
    - isid persid time
    - g age = year - byear
    - drop if age<25 | age>65
(93,787 observations deleted)
    - label var age "Age"
    - g estabid = ceil(uniform()*`number_firms')
    = g estabid = ceil(uniform()*100)
    - g leave_firm = 0
    - g mlf = uniform()<.0
    - bys estabid time (persid): replace mlf = mlf[1]
(0 real changes made)
    - replace leave_firm = uniform()<.5 if mlf==1
(0 real changes made)
    - g pcl = uniform()<.02
    - bys estabid time (persid): replace pcl = pcl[1]
(2455 real changes made)
    - replace mlf = 1 if pcl==1
(1,267 real changes made)
    - replace leave_firm = 1 if pcl==1
(1,267 real changes made)
    - label var mlf "Mass lay-off between t-1 and t"
    - label var pcl "Plant closing between t-1 and t"
    - label var leave_firm "Workers leavs firm between t-1 and t"
    - replace estabid = . if uniform()<.40 & leave_firm==1 & (mlf==1 | pcl==1)
(496 real changes made, 496 to missing)
    - replace leave_firm = uniform()<.1 if leave_firm==0
(6,476 real changes made)
    - bys persid (time): replace leave_firm = uniform()<.4 if estabid[_n-1]==.
(2,512 real changes made)
    - bys persid (time): replace estabid = estabid[_n-1] if leave_firm==0 & _n>1
(52818 real changes made, 1093 to missing)
    - merge m:1 estabid using `firmdata' , keep(master matched) nogen
    = merge m:1 estabid using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 , keep(master matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                         1,589
        from master                     1,589  
        from using                          0  

    Matched                            64,624  
    -----------------------------------------
    - g employed = !missing(estabid)
    - label var employed "Employed"
    - g displaced = pcl
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6024 real changes made)
    - order persid time estabid pcl leave_firm displaced
    - sort persid time
    - g logearn = 8.0 + 0.02*(year-2000) + (0.001*(year-1993))^2 - female*0.2 + edyrs * 0.1 + (age-edyrs) * 0.01 + rnormal()*0.02*(year-1995) + rnormal()*0.03 - 0.
> 2 * displaced
    - g earn = exp(logearn)
    - replace earn = 0 if employed==. | employed==0
(1,589 real changes made)
    - drop displaced
    - label var earn "Earnings"
    - label var logearn "Log Earnings"
    - bys persid estabid (time): g tenure = (_n-1)
    - label var tenure "Tenure with firm"
    - order persid year estabid industry
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g fpcl = f.pcl
(5,582 missing values generated)
    - g fmlf = f.mlf
(5,582 missing values generated)
    - g displaced = pcl
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6024 real changes made)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (displaced) : g sep = displaced[_N]
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - replace displaced = f.displaced if f.displaced!=.
(1,104 real changes made)
    - label var displaced "Post-displacement"
    - label var sep "Displaced Worker"
    - label define sep1 1 "Displaced worker" 2 "Non-displaced worker"
    - label values sep sep1
    - bys persid (time): g leave_labor_force = runiform()<.05
    - bys persid (time): replace leave_labor_force = leave_labor_force[_n-1] if _n>1 & leave_labor_force==0
(16559 real changes made)
    - replace employed = 0 if leave_labor_force==1
(19,290 real changes made)
    - replace earn = 0 if leave_labor_force==1
(19,290 real changes made)
    - replace logearn = . if leave_labor_force==1
(19,864 real changes made, 19,864 to missing)
    - replace displaced = 0 if leave_labor_force==1
(3,284 real changes made)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g disp_event = displaced==1 & l.displaced==0
    - order persid time estabid industry displaced sep disp_event
    - g baselinetime = time if f.disp_event==1
(65,517 missing values generated)
    - bys persid (baselinetime) : replace baselinetime = baselinetime[1]
(8974 real changes made)
    - g timesince = time-baselinetime-1
(56,543 missing values generated)
    - rename timesince timesince1
    - rename displaced displaced1
    - rename disp_event disp_event1
    - rename sep sep1
    - rename baselinetime baselinetime1
    - save `out' , replace
    = save ../data/person_year_data.dta , replace
file ../data/person_year_data.dta saved
    ---------------------------------------------------------------------------------------------------------------------------------- end simulate_yearly_data ---
  - generate_treatment_control, in(${data}person_year_data.dta) out(${data}analysis_data.dta)
  = generate_treatment_control, in(../data/person_year_data.dta) out(../data/analysis_data.dta)
    -------------------------------------------------------------------------------------------------------------------------- begin generate_treatment_control ---
    - syntax , [ in(str) out(str) from(integer 1990) to(integer 2004) PREPeriods(integer 5) POSTPeriods(integer 10) ]
    - local totperiods = `postperiods' + `preperiods' + 1
    = local totperiods = 10 + 5 + 1
    - local matchround 1
    - local cell_vars industry female
    - forval t = `from'/`to' {
    = forval t = 1990/2004 {
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1990, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
    - tempfile cells`t'
    = tempfile cells1990
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 1+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,236  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(877 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(46 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,359 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 2+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,749  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(589 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(15 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,160 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 3+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,738  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(795 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(51 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,943 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 4+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,013  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(408 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(17 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(1,605 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 5+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,219  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(877 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(32 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,342 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 6+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,665  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(548 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(7 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,117 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 7+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,355  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(887 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(36 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,468 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 8+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,317  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(680 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(32 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,637 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 9+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,195  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(1,259 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(62 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(4,936 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 10+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,675  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(776 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(14 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,899 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 11+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,373  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(1,339 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(61 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(5,034 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 12+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,390  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(896 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(12 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,494 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 13+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,849  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(811 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(66 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,038 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 14+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001 if time==1990 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,652  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1986,2001)
(553 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2001
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(46 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1990
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,099 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1991, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(14 missing values generated)
    - tempfile cells`t'
    = tempfile cells1991
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 15+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,375  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(679 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,696 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 16+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,840  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(447 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(21 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,393 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 17+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,757  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(595 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,162 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 18+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,227  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(340 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(22 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(1,887 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 19+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,345  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(668 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(36 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,677 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 20+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,558  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(386 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(8 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,172 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 21+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,282  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(655 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,627 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 22+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,212  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(491 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,721 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 23+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,127  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(928 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(72 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(5,199 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 24+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,892  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(609 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(12 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,283 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 25+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,819  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(1,068 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(119 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(5,751 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 26+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,508  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(675 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,833 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 27+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,018  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(620 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(53 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,398 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 28+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000002 if time==1991 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,587  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1987,2002)
(394 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2002
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(21 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1991
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,193 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1992, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(24 missing values generated)
    - tempfile cells`t'
    = tempfile cells1992
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 29+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,595  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(468 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(58 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(4,127 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 30+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,866  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(300 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(24 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,566 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 31+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,684  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(385 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(72 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,299 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 32+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,289  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(229 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(36 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,060 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 33+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,390  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(448 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(40 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,942 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 34+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,598  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(257 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(18 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,341 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 35+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,281  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(437 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(17 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,844 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 36+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,239  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(334 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(56 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,905 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 37+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,142  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(624 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(76 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(5,518 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 38+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,093  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(425 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(26 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,668 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 39+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,769  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(698 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(92 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(6,071 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 40+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,493  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(439 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(41 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(4,054 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 41+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,356  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(449 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(128 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(3,907 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - local matchround = `matchround'+1
    = local matchround = 42+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000003 if time==1992 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,789  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1988,2003)
(286 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2003
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(34 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1992
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(0 real changes made)
    - drop if baselinerestrictions==0
(2,503 observations deleted)
    - drop baselinerestrictions
    - count
  0
    - if r(N)==0 continue
      tsset
      g byte sep = (baselinetime_dummy & (displacement_event==1))
      bys persid (sep): replace sep = sep[_N]
      replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
      bys persid (sep): replace sep = sep[_N]
      drop if sep==9
      g uniform = uniform()
      bys persid: replace uniform=uniform[1]
      drop baselinetime_dummy
      tsset persid time
      tsfill
      g byte noleavers = 1
      tsfill, full
      g byte baselinetime_dummy = time==`t'
      foreach v in earn employed {
      replace `v'=0 if `v'==.
      }
      foreach v in sep byear edyrs female uniform {
      bys persid (`v'): replace `v'=`v'[1] if `v'==.
      }
      foreach v in earn logearn age edyrs firmsize tenure {
      g baseline`v' = `v' if baselinetime_dummy==1
      bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
      }
      tsset persid time
      foreach v in logearn {
      tsset
      g baseline`v'1 = `v' if f1.baselinetime_dummy==1
      bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
      }
      foreach v in logearn {
      tsset
      g baseline`v'2 = `v' if f2.baselinetime_dummy==1
      bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
      }
      local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
      g byte weight1 = .
      g int matchround = .
      g int psmatchid = .
      cap noi {
      psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
      }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1993, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(44 missing values generated)
    - tempfile cells`t'
    = tempfile cells1993
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 43+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,690  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(238 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(91 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,873 real changes made)
    - drop if baselinerestrictions==0
(2,445 observations deleted)
    - drop baselinerestrictions
    - count
  2,007
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(14 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(196 real changes made)
    - drop if sep==9
(210 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1677 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1680 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1680 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1680 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1680 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1680 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1680 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1680 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,680 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1680 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,800 missing values generated)
    - g int matchround = .
(1,800 missing values generated)
    - g int psmatchid = .
(1,800 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 28 predicts failure perfectly;
      baselineage omitted and 114 obs not used.

note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =          6
                                                  LR chi2(4)      =       5.41
                                                  Prob > chi2     =     0.2481
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   56.64332          .        .       .            .           .
baselinelo~2 |  -71.23477          .        .       .            .           .
baselineed~s |  -.3971337          .        .       .            .           .
baselinefi~e |  -.0020521          .        .       .            .           .
       _cons |    131.319          .        .       .            .           .
------------------------------------------------------------------------------
Note: 5 failures and 1 success completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 44 if _treated==0 | _treated==1
(6 real changes made)
    - replace psmatchid = _id if _treated==0
(5 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(70 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,800 real changes made)
    - keep if weight1==1
(1,800 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched44
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000005
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000005 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 44+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,922  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(149 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(50 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,246 real changes made)
    - drop if baselinerestrictions==0
(1,438 observations deleted)
    - drop baselinerestrictions
    - count
  1,335
    - if r(N)==0 continue
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(140 real changes made)
    - drop if sep==9
(150 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1106 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1106 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1106 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1106 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1106 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1106 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1106 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1106 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,106 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1106 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,185 missing values generated)
    - g int matchround = .
(1,185 missing values generated)
    - g int psmatchid = .
(1,185 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =         79
                                                  LR chi2(5)      =       1.55
                                                  Prob > chi2     =     0.9074
Log likelihood = -4.5889227                       Pseudo R2       =     0.1444

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   .2411656   6.951828     0.03   0.972    -13.38417     13.8665
baselinelo~2 |  -1.734265   6.783096    -0.26   0.798    -15.02889    11.56036
 baselineage |   .0604781   .0993457     0.61   0.543    -.1342359    .2551922
baselineed~s |  -.0025749   .7630403    -0.00   0.997    -1.498106    1.492957
baselinefi~e |  -.0006275   .0011336    -0.55   0.580    -.0028493    .0015943
       _cons |   8.850908   63.79565     0.14   0.890    -116.1863    133.8881
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 45 if _treated==0 | _treated==1
(79 real changes made)
    - replace psmatchid = _id if _treated==0
(78 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,106 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(28 real changes made)
    - replace weight1 = 0 if weight1==.
(1,155 real changes made)
    - keep if weight1==1
(1,155 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(15 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched45
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000006
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000006 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 45+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,625  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(186 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(63 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,622 real changes made)
    - drop if baselinerestrictions==0
(1,701 observations deleted)
    - drop baselinerestrictions
    - count
  1,738
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(126 real changes made)
    - drop if sep==9
(135 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1496 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1498 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1498 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1498 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1498 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1498 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1498 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1498 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,498 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1498 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,605 missing values generated)
    - g int matchround = .
(1,605 missing values generated)
    - g int psmatchid = .
(1,605 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =        107
                                                  LR chi2(5)      =       8.66
                                                  Prob > chi2     =     0.1236
Log likelihood = -9.3520226                       Pseudo R2       =     0.3164

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   9.739657   5.376467     1.81   0.070    -.7980238    20.27734
baselinelo~2 |   2.857867    3.74645     0.76   0.446    -4.485041    10.20078
 baselineage |  -.1356203   .0822021    -1.65   0.099    -.2967334    .0254927
baselineed~s |  -1.353404   .6117093    -2.21   0.027    -2.552332   -.1544757
baselinefi~e |   .0019268    .001801     1.07   0.285     -.001603    .0054566
       _cons |  -98.96619   50.94082    -1.94   0.052    -198.8084    .8759774
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 46 if _treated==0 | _treated==1
(107 real changes made)
    - replace psmatchid = _id if _treated==0
(104 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,498 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(84 real changes made)
    - replace weight1 = 0 if weight1==.
(1,515 real changes made)
    - keep if weight1==1
(1,515 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(45 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched46
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000007
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000007 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 46+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,398  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(120 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(41 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(850 real changes made)
    - drop if baselinerestrictions==0
(1,367 observations deleted)
    - drop baselinerestrictions
    - count
  911
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(41 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(83 real changes made)
    - drop if sep==9
(89 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(767 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(770 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(770 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(770 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(825 missing values generated)
    - g int matchround = .
(825 missing values generated)
    - g int psmatchid = .
(825 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =         55
                                                  LR chi2(5)      =      23.29
                                                  Prob > chi2     =     0.0003
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   74.89675          .        .       .            .           .
baselinelo~2 |  -57.23916          .        .       .            .           .
 baselineage |   .9639539          .        .       .            .           .
baselineed~s |  -6.883616          .        .       .            .           .
baselinefi~e |  -.0350678          .        .       .            .           .
       _cons |  -136.9545          .        .       .            .           .
------------------------------------------------------------------------------
Note: 52 failures and 3 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 47 if _treated==0 | _treated==1
(55 real changes made)
    - replace psmatchid = _id if _treated==0
(52 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(728 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(825 real changes made)
    - keep if weight1==1
(825 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched47
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000008
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000008 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 47+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,575  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(236 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(54 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,830 real changes made)
    - drop if baselinerestrictions==0
(2,378 observations deleted)
    - drop baselinerestrictions
    - count
  1,961
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(84 real changes made)
    - drop if sep==9
(90 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1746 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1750 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1750 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,750 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1750 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,875 missing values generated)
    - g int matchround = .
(1,875 missing values generated)
    - g int psmatchid = .
(1,875 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =        125
                                                  LR chi2(5)      =       0.51
                                                  Prob > chi2     =     0.9917
Log likelihood = -17.447395                       Pseudo R2       =     0.0145

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   .0580062   3.020241     0.02   0.985    -5.861557    5.977569
baselinelo~2 |   .7578774   3.038875     0.25   0.803    -5.198208    6.713963
 baselineage |  -.0112777   .0518884    -0.22   0.828    -.1129771    .0904216
baselineed~s |  -.0712279   .3946258    -0.18   0.857    -.8446803    .7022245
baselinefi~e |   .0004658   .0006764     0.69   0.491      -.00086    .0017916
       _cons |  -8.342764   34.98304    -0.24   0.812    -76.90827    60.22274
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 48 if _treated==0 | _treated==1
(125 real changes made)
    - replace psmatchid = _id if _treated==0
(121 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,750 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(1,755 real changes made)
    - keep if weight1==1
(1,755 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched48
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000009
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000009 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 48+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,596  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(128 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(30 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,073 real changes made)
    - drop if baselinerestrictions==0
(1,318 observations deleted)
    - drop baselinerestrictions
    - count
  1,150
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(167 real changes made)
    - drop if sep==9
(179 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(906 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(910 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(910 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(910 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(975 missing values generated)
    - g int matchround = .
(975 missing values generated)
    - g int psmatchid = .
(975 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =         65
                                                  LR chi2(5)      =       4.71
                                                  Prob > chi2     =     0.4527
Log likelihood =  -12.67312                       Pseudo R2       =     0.1566

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.439433   4.546416    -0.54   0.592    -11.35024    6.471379
baselinelo~2 |   2.567431   3.472456     0.74   0.460    -4.238458     9.37332
 baselineage |  -.0116563   .0672817    -0.17   0.862    -.1435259    .1202134
baselineed~s |    .240482   .4926597     0.49   0.625    -.7251132    1.206077
baselinefi~e |  -.0005558   .0009188    -0.60   0.545    -.0023566     .001245
       _cons |  -4.986245   40.29638    -0.12   0.902    -83.96571    73.99322
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 49 if _treated==0 | _treated==1
(65 real changes made)
    - replace psmatchid = _id if _treated==0
(61 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(910 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(855 real changes made)
    - keep if weight1==1
(855 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched49
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000a
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000a saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 49+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,596  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(238 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(21 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,634 real changes made)
    - drop if baselinerestrictions==0
(2,607 observations deleted)
    - drop baselinerestrictions
    - count
  1,751
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(168 real changes made)
    - drop if sep==9
(180 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1466 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1470 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1470 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1470 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1470 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1470 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1470 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1470 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,470 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1470 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,575 missing values generated)
    - g int matchround = .
(1,575 missing values generated)
    - g int psmatchid = .
(1,575 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =        105
                                                  LR chi2(5)      =       0.73
                                                  Prob > chi2     =     0.9812
Log likelihood = -16.627669                       Pseudo R2       =     0.0215

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   1.677307   3.747464     0.45   0.654    -5.667587    9.022202
baselinelo~2 |   .6195482   2.809077     0.22   0.825    -4.886142    6.125239
 baselineage |  -.0140136   .0531274    -0.26   0.792    -.1181415    .0901142
baselineed~s |  -.1369889   .4252397    -0.32   0.747    -.9704435    .6964656
baselinefi~e |   .0002081   .0007078     0.29   0.769    -.0011791    .0015953
       _cons |  -21.06993   37.66973    -0.56   0.576    -94.90124    52.76137
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 50 if _treated==0 | _treated==1
(105 real changes made)
    - replace psmatchid = _id if _treated==0
(101 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,470 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(1,455 real changes made)
    - keep if weight1==1
(1,455 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched50
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000b
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000b saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 50+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,254  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(168 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(30 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,281 real changes made)
    - drop if baselinerestrictions==0
(1,713 observations deleted)
    - drop baselinerestrictions
    - count
  1,373
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(126 real changes made)
    - drop if sep==9
(135 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1155 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(7 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(7 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(7 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1162 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1162 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,162 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1162 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,245 missing values generated)
    - g int matchround = .
(1,245 missing values generated)
    - g int psmatchid = .
(1,245 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =         83
                                                  LR chi2(5)      =       5.68
                                                  Prob > chi2     =     0.3391
Log likelihood = -6.5893865                       Pseudo R2       =     0.3010

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   14.20221   10.78038     1.32   0.188    -6.926952    35.33137
baselinelo~2 |   3.477781   6.208394     0.56   0.575    -8.690448    15.64601
 baselineage |  -.1994119   .1633402    -1.22   0.222    -.5195528     .120729
baselineed~s |  -1.110892   1.152891    -0.96   0.335    -3.370517    1.148734
baselinefi~e |   .0000534   .0009521     0.06   0.955    -.0018127    .0019196
       _cons |  -142.5899   112.9379    -1.26   0.207    -363.9441    78.76433
------------------------------------------------------------------------------
Note: 2 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 51 if _treated==0 | _treated==1
(83 real changes made)
    - replace psmatchid = _id if _treated==0
(81 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,162 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(56 real changes made)
    - replace weight1 = 0 if weight1==.
(1,185 real changes made)
    - keep if weight1==1
(1,185 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(30 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched51
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000c
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000c saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 51+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,139  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(314 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(76 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(2,209 real changes made)
    - drop if baselinerestrictions==0
(3,458 observations deleted)
    - drop baselinerestrictions
    - count
  2,367
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(70 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(21 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(294 real changes made)
    - drop if sep==9
(315 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1915 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1918 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1918 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1918 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1918 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1918 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1918 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1918 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,918 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1918 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(2,055 missing values generated)
    - g int matchround = .
(2,055 missing values generated)
    - g int psmatchid = .
(2,055 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =        137
                                                  LR chi2(5)      =       3.00
                                                  Prob > chi2     =     0.7006
Log likelihood = -19.962477                       Pseudo R2       =     0.0698

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   1.373466   3.128355     0.44   0.661    -4.757997    7.504929
baselinelo~2 |  -3.064049   2.993335    -1.02   0.306    -8.930878     2.80278
 baselineage |  -.0077616   .0488846    -0.16   0.874    -.1035736    .0880505
baselineed~s |   .2111944   .4126948     0.51   0.609    -.5976727    1.020061
baselinefi~e |   -.000809   .0011386    -0.71   0.477    -.0030405    .0014226
       _cons |    11.8583   34.53173     0.34   0.731    -55.82264    79.53925
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 52 if _treated==0 | _treated==1
(137 real changes made)
    - replace psmatchid = _id if _treated==0
(132 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,904 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(1,935 real changes made)
    - keep if weight1==1
(1,935 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched52
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000d
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000d saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 52+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,234  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(217 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(28 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,575 real changes made)
    - drop if baselinerestrictions==0
(2,329 observations deleted)
    - drop baselinerestrictions
    - count
  1,688
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(140 real changes made)
    - drop if sep==9
(150 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1435 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(7 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(7 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(7 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1442 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1442 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1442 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1442 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1442 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1442 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1442 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,442 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1442 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,545 missing values generated)
    - g int matchround = .
(1,545 missing values generated)
    - g int psmatchid = .
(1,545 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 92 obs not used.

note: baselinefirmsize != 90.01143 predicts failure perfectly;
      baselinefirmsize omitted and 8 obs not used.

outcome = baselinelogearn1 <= 8.692779 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 53+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,757  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(347 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(132 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(2,668 real changes made)
    - drop if baselinerestrictions==0
(3,551 observations deleted)
    - drop baselinerestrictions
    - count
  2,859
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(19 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(265 real changes made)
    - drop if sep==9
(284 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(2403 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(2408 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(2408 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(2408 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(2408 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(2408 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(2408 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(2408 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(2,408 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(2408 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(2,580 missing values generated)
    - g int matchround = .
(2,580 missing values generated)
    - g int psmatchid = .
(2,580 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =        172
                                                  LR chi2(5)      =       2.07
                                                  Prob > chi2     =     0.8393
Log likelihood = -17.962557                       Pseudo R2       =     0.0545

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.429189   3.243778    -0.75   0.454    -8.786876    3.928499
baselinelo~2 |   1.594102   2.476708     0.64   0.520    -3.260156     6.44836
 baselineage |  -.0021293    .049563    -0.04   0.966     -.099271    .0950123
baselineed~s |  -.0159329   .3629273    -0.04   0.965    -.7272573    .6953915
baselinefi~e |  -.0000901   .0004031    -0.22   0.823    -.0008801       .0007
       _cons |   6.035028   31.29543     0.19   0.847    -55.30289    67.37294
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 54 if _treated==0 | _treated==1
(172 real changes made)
    - replace psmatchid = _id if _treated==0
(168 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(2,408 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(2,460 real changes made)
    - keep if weight1==1
(2,460 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched54
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000e
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000e saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 54+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,451  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(219 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(67 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,577 real changes made)
    - drop if baselinerestrictions==0
(2,542 observations deleted)
    - drop baselinerestrictions
    - count
  1,690
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(13 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(182 real changes made)
    - drop if sep==9
(195 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1395 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1400 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1400 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,400 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1400 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,500 missing values generated)
    - g int matchround = .
(1,500 missing values generated)
    - g int psmatchid = .
(1,500 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 55+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,223  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(219 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(117 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,619 real changes made)
    - drop if baselinerestrictions==0
(2,269 observations deleted)
    - drop baselinerestrictions
    - count
  1,735
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(17 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(236 real changes made)
    - drop if sep==9
(253 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1383 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1386 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1386 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1386 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1386 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1386 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1386 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1386 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,386 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1386 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,485 missing values generated)
    - g int matchround = .
(1,485 missing values generated)
    - g int psmatchid = .
(1,485 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =         99
                                                  LR chi2(5)      =       2.04
                                                  Prob > chi2     =     0.8431
Log likelihood = -15.731774                       Pseudo R2       =     0.0610

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -4.100342   3.833413    -1.07   0.285    -11.61369    3.413008
baselinelo~2 |  -1.700129   2.548717    -0.67   0.505    -6.695523    3.295266
 baselineage |   .0780452    .057627     1.35   0.176    -.0349016     .190992
baselineed~s |   .5474639   .4656901     1.18   0.240     -.365272      1.4602
baselinefi~e |  -.0000713   .0003992    -0.18   0.858    -.0008538    .0007112
       _cons |   42.45139   37.35793     1.14   0.256    -30.76881    115.6716
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 56 if _treated==0 | _treated==1
(99 real changes made)
    - replace psmatchid = _id if _treated==0
(95 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,386 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(1,365 real changes made)
    - keep if weight1==1
(1,365 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1993 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1993
    - tempfile matched`matchround'
    = tempfile matched56
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000f
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000f saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 56+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000004 if time==1993 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,854  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1989,2004)
(149 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(42 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(961 real changes made)
    - drop if baselinerestrictions==0
(1,675 observations deleted)
    - drop baselinerestrictions
    - count
  1,030
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(55 real changes made)
    - drop if sep==9
(59 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(906 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1993
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(910 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(910 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(910 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2004
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(910 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(910 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(975 missing values generated)
    - g int matchround = .
(975 missing values generated)
    - g int psmatchid = .
(975 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1994, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(71 missing values generated)
    - tempfile cells`t'
    = tempfile cells1994
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 57+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,651  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(96 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,921 real changes made)
    - drop if baselinerestrictions==0
(2,601 observations deleted)
    - drop baselinerestrictions
    - count
  2,050
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(15 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(14 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(209 real changes made)
    - drop if sep==9
(223 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1712 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(13 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(13 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(13 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(13 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(13 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(13 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(13 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1725 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1725 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1725 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1725 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1725 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1725 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1725 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,725 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1725 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,840 missing values generated)
    - g int matchround = .
(1,840 missing values generated)
    - g int psmatchid = .
(1,840 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 16 obs not used.


Probit regression                                 Number of obs   =         99
                                                  LR chi2(5)      =       1.64
                                                  Prob > chi2     =     0.8961
Log likelihood = -4.7689191                       Pseudo R2       =     0.1469

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   -1.43583   10.32094    -0.14   0.889     -21.6645    18.79284
baselinelo~2 |  -3.907295   8.063255    -0.48   0.628    -19.71098    11.89639
 baselineage |  -.0160622   .1385873    -0.12   0.908    -.2876884    .2555639
baselineed~s |   .6212499   1.270706     0.49   0.625    -1.869289    3.111788
baselinefi~e |   .0000927   .0009371     0.10   0.921    -.0017441    .0019294
       _cons |   40.23651   108.3062     0.37   0.710    -172.0397    252.5127
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 58 if _treated==0 | _treated==1
(99 real changes made)
    - replace psmatchid = _id if _treated==0
(98 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,485 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(30 real changes made)
    - replace weight1 = 0 if weight1==.
(1,808 real changes made)
    - keep if weight1==1
(1,808 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(16 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched58
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000h
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000h saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 58+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,914  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,280 real changes made)
    - drop if baselinerestrictions==0
(1,548 observations deleted)
    - drop baselinerestrictions
    - count
  1,366
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(105 real changes made)
    - drop if sep==9
(112 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1175 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(10 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(10 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(10 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1185 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1185 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1185 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1185 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1185 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1185 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1185 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,185 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1185 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,264 missing values generated)
    - g int matchround = .
(1,264 missing values generated)
    - g int psmatchid = .
(1,264 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 55 predicts failure perfectly;
      baselineage omitted and 72 obs not used.

outcome = baselinelogearn1 <= 8.913562 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 59+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,547  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(61 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,703 real changes made)
    - drop if baselinerestrictions==0
(1,730 observations deleted)
    - drop baselinerestrictions
    - count
  1,817
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(60 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(17 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(254 real changes made)
    - drop if sep==9
(271 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1449 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1455 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1455 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1455 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,552 missing values generated)
    - g int matchround = .
(1,552 missing values generated)
    - g int psmatchid = .
(1,552 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 11 obs not used.


Probit regression                                 Number of obs   =         86
                                                  LR chi2(5)      =      10.20
                                                  Prob > chi2     =     0.0698
Log likelihood = -11.078868                       Pseudo R2       =     0.3152

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   3.768055   6.898474     0.55   0.585    -9.752704    17.28882
baselinelo~2 |   2.233693   4.547487     0.49   0.623    -6.679217     11.1466
 baselineage |   .0760631    .107416     0.71   0.479    -.1344683    .2865946
baselineed~s |  -.7520281   .8607066    -0.87   0.382    -2.438982    .9349259
baselinefi~e |  -.0044148   .0023458    -1.88   0.060    -.0090126    .0001829
       _cons |  -51.09849   74.74329    -0.68   0.494    -197.5926    95.39566
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 60 if _treated==0 | _treated==1
(86 real changes made)
    - replace psmatchid = _id if _treated==0
(82 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,275 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(90 real changes made)
    - replace weight1 = 0 if weight1==.
(1,456 real changes made)
    - keep if weight1==1
(1,456 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(48 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched60
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000i
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000i saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 60+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,363  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(46 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(924 real changes made)
    - drop if baselinerestrictions==0
(1,377 observations deleted)
    - drop baselinerestrictions
    - count
  986
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - drop if sep==9
(48 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(879 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(885 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(885 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(885 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(885 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(885 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(885 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(885 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(885 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(885 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(944 missing values generated)
    - g int matchround = .
(944 missing values generated)
    - g int psmatchid = .
(944 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 15 obs not used.


Probit regression                                 Number of obs   =         44
                                                  LR chi2(5)      =       5.57
                                                  Prob > chi2     =     0.3507
Log likelihood = -5.3525249                       Pseudo R2       =     0.3421

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   15.20468    14.9631     1.02   0.310    -14.12245    44.53182
baselinelo~2 |   15.73322   15.17343     1.04   0.300    -14.00616     45.4726
 baselineage |  -.4225841   .3258918    -1.30   0.195     -1.06132    .2161521
baselineed~s |  -2.359214   1.897077    -1.24   0.214    -6.077418    1.358989
baselinefi~e |   .0096873   .0109888     0.88   0.378    -.0118503    .0312249
       _cons |  -244.1351   188.9962    -1.29   0.196    -614.5609    126.2906
------------------------------------------------------------------------------
Note: 10 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 61 if _treated==0 | _treated==1
(44 real changes made)
    - replace psmatchid = _id if _treated==0
(42 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(660 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(60 real changes made)
    - replace weight1 = 0 if weight1==.
(880 real changes made)
    - keep if weight1==1
(880 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(32 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched61
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000j
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000j saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 61+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,667  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(77 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,939 real changes made)
    - drop if baselinerestrictions==0
(2,598 observations deleted)
    - drop baselinerestrictions
    - count
  2,069
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(29 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(14 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(209 real changes made)
    - drop if sep==9
(223 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1730 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(10 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(10 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(10 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(10 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1740 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1740 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1740 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1740 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1740 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1740 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1740 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,740 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1740 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,856 missing values generated)
    - g int matchround = .
(1,856 missing values generated)
    - g int psmatchid = .
(1,856 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =        116
                                                  LR chi2(6)      =      20.21
                                                  Prob > chi2     =     0.0025
Log likelihood = -3.170e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -378.3865   42426.38    -0.01   0.993    -83532.56    82775.78
baselinelo~2 |  -257.1304   27891.97    -0.01   0.993    -54924.38    54410.12
 baselineage |  -2.690225   2210.401    -0.00   0.999    -4334.996    4329.615
baselineed~s |   28.24243   8071.508     0.00   0.997    -15791.62    15848.11
baselinete~e |   35.54549          .        .       .            .           .
baselinefi~e |   -.023195   15.66042    -0.00   0.999    -30.71705    30.67066
       _cons |   5368.752          .        .       .            .           .
------------------------------------------------------------------------------
Note: 110 failures and 1 success completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 62 if _treated==0 | _treated==1
(116 real changes made)
    - replace psmatchid = _id if _treated==0
(114 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,710 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,856 real changes made)
    - keep if weight1==1
(1,856 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched62
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000k
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000k saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 62+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,500  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(33 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(882 real changes made)
    - drop if baselinerestrictions==0
(1,559 observations deleted)
    - drop baselinerestrictions
    - count
  941
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(44 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(135 real changes made)
    - drop if sep==9
(144 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(747 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(750 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(750 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(750 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(750 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(750 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(800 missing values generated)
    - g int matchround = .
(800 missing values generated)
    - g int psmatchid = .
(800 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         50
                                                  LR chi2(6)      =      11.66
                                                  Prob > chi2     =     0.0700
Log likelihood =  -5.519313                       Pseudo R2       =     0.5136

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -1.417581   16.04687    -0.09   0.930    -32.86887    30.03371
baselinelo~2 |   19.93679   15.04584     1.33   0.185    -9.552507    49.42609
 baselineage |  -.3864554   .2918383    -1.32   0.185     -.958448    .1855372
baselineed~s |   -1.67201    1.87178    -0.89   0.372    -5.340631    1.996611
baselinete~e |  -.6490499   1.645127    -0.39   0.693    -3.873439     2.57534
baselinefi~e |  -.0015865   .0025911    -0.61   0.540     -.006665     .003492
       _cons |  -132.8861   150.9908    -0.88   0.379    -428.8225    163.0504
------------------------------------------------------------------------------
Note: 5 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 63 if _treated==0 | _treated==1
(50 real changes made)
    - replace psmatchid = _id if _treated==0
(47 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(720 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(30 real changes made)
    - replace weight1 = 0 if weight1==.
(768 real changes made)
    - keep if weight1==1
(768 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(16 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched63
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000l
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000l saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 63+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,563  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(41 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,674 real changes made)
    - drop if baselinerestrictions==0
(2,777 observations deleted)
    - drop baselinerestrictions
    - count
  1,786
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(120 real changes made)
    - drop if sep==9
(128 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1554 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1560 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1560 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1560 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1560 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1560 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1560 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1560 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,560 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1560 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,664 missing values generated)
    - g int matchround = .
(1,664 missing values generated)
    - g int psmatchid = .
(1,664 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 64+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,163  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(24 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,149 real changes made)
    - drop if baselinerestrictions==0
(1,937 observations deleted)
    - drop baselinerestrictions
    - count
  1,226
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(15 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(105 real changes made)
    - drop if sep==9
(112 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1044 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1050 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1050 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1050 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1050 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1050 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1050 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1050 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,050 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1050 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,120 missing values generated)
    - g int matchround = .
(1,120 missing values generated)
    - g int psmatchid = .
(1,120 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 64 obs not used.


Probit regression                                 Number of obs   =          6
                                                  LR chi2(5)      =       5.41
                                                  Prob > chi2     =     0.3683
Log likelihood = -3.414e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   360.2063          .        .       .            .           .
baselinelo~2 |   438.7018          .        .       .            .           .
 baselineage |  -7.009357   264.0138    -0.03   0.979    -524.4668    510.4481
baselineed~s |  -64.97701          .        .       .            .           .
baselinefi~e |   -.037117   8.656135    -0.00   0.997    -17.00283    16.92859
       _cons |   -6191.35          .        .       .            .           .
------------------------------------------------------------------------------
Note: 4 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 65 if _treated==0 | _treated==1
(6 real changes made)
    - replace psmatchid = _id if _treated==0
(5 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(75 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,120 real changes made)
    - keep if weight1==1
(1,120 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched65
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000m
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000m saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 65+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,484  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(99 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(2,094 real changes made)
    - drop if baselinerestrictions==0
(4,250 observations deleted)
    - drop baselinerestrictions
    - count
  2,234
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(16 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(237 real changes made)
    - drop if sep==9
(253 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1857 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1860 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1860 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1860 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1860 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1860 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1860 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1860 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,860 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1860 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,984 missing values generated)
    - g int matchround = .
(1,984 missing values generated)
    - g int psmatchid = .
(1,984 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 13 obs not used.


Probit regression                                 Number of obs   =        111
                                                  LR chi2(5)      =       8.14
                                                  Prob > chi2     =     0.1487
Log likelihood = -9.7222858                       Pseudo R2       =     0.2951

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -10.06202   7.975018    -1.26   0.207    -25.69277    5.568726
baselinelo~2 |  -.2893424    5.16105    -0.06   0.955    -10.40481    9.826129
 baselineage |   .0785086   .1047774     0.75   0.454    -.1268513    .2838685
baselineed~s |   .7743006    .899844     0.86   0.390    -.9893612    2.537962
baselinefi~e |  -.0108387   .0069246    -1.57   0.118    -.0244107    .0027333
       _cons |   83.85926   79.53184     1.05   0.292    -72.02027    239.7388
------------------------------------------------------------------------------
Note: 20 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 66 if _treated==0 | _treated==1
(111 real changes made)
    - replace psmatchid = _id if _treated==0
(108 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,665 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(90 real changes made)
    - replace weight1 = 0 if weight1==.
(1,888 real changes made)
    - keep if weight1==1
(1,888 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(48 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched66
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000n
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000n saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 66+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,296  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(62 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,565 real changes made)
    - drop if baselinerestrictions==0
(2,626 observations deleted)
    - drop baselinerestrictions
    - count
  1,670
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(119 real changes made)
    - drop if sep==9
(127 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1446 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(9 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(9 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(9 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1455 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1455 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,455 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1455 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,552 missing values generated)
    - g int matchround = .
(1,552 missing values generated)
    - g int psmatchid = .
(1,552 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 15 obs not used.


Probit regression                                 Number of obs   =         82
                                                  LR chi2(5)      =       9.13
                                                  Prob > chi2     =     0.1040
Log likelihood = -8.3035448                       Pseudo R2       =     0.3548

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   14.11044   8.388377     1.68   0.093    -2.330475    30.55136
baselinelo~2 |   -2.22122   5.043701    -0.44   0.660    -12.10669    7.664252
 baselineage |  -.1356873   .1092146    -1.24   0.214     -.349744    .0783694
baselineed~s |  -1.350823   .8561982    -1.58   0.115    -3.028941    .3272948
baselinefi~e |   .0013235   .0009182     1.44   0.149    -.0004762    .0031231
       _cons |  -90.24985   68.43687    -1.32   0.187    -224.3836    43.88394
------------------------------------------------------------------------------
Note: 1 failure and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 67 if _treated==0 | _treated==1
(82 real changes made)
    - replace psmatchid = _id if _treated==0
(79 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,230 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(90 real changes made)
    - replace weight1 = 0 if weight1==.
(1,456 real changes made)
    - keep if weight1==1
(1,456 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(48 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched67
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000o
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000o saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 67+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,787  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(128 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(2,619 real changes made)
    - drop if baselinerestrictions==0
(3,993 observations deleted)
    - drop baselinerestrictions
    - count
  2,794
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(17 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(255 real changes made)
    - drop if sep==9
(272 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(2364 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(2370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(2370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(2370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(2370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(2370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(2370 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(2370 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(2,370 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(2370 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(2,528 missing values generated)
    - g int matchround = .
(2,528 missing values generated)
    - g int psmatchid = .
(2,528 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 18 obs not used.


Probit regression                                 Number of obs   =        140
                                                  LR chi2(5)      =       5.33
                                                  Prob > chi2     =     0.3772
Log likelihood = -7.8188212                       Pseudo R2       =     0.2541

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -9.635632   10.52915    -0.92   0.360    -30.27239    11.00113
baselinelo~2 |  -2.966535   6.356346    -0.47   0.641    -15.42474    9.491675
 baselineage |    .100453    .143707     0.70   0.485    -.1812077    .3821136
baselineed~s |   1.531163   1.327473     1.15   0.249    -1.070637    4.132963
baselinefi~e |   .0003843   .0005549     0.69   0.489    -.0007033     .001472
       _cons |   91.76656   105.9386     0.87   0.386    -115.8693    299.4024
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 68 if _treated==0 | _treated==1
(140 real changes made)
    - replace psmatchid = _id if _treated==0
(138 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(2,100 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(60 real changes made)
    - replace weight1 = 0 if weight1==.
(2,464 real changes made)
    - keep if weight1==1
(2,464 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(32 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched68
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000p
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000p saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 68+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,618  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(63 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,596 real changes made)
    - drop if baselinerestrictions==0
(2,915 observations deleted)
    - drop baselinerestrictions
    - count
  1,703
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(29 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(163 real changes made)
    - drop if sep==9
(174 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1433 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(7 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(7 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(7 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1440 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1440 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,440 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1440 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,536 missing values generated)
    - g int matchround = .
(1,536 missing values generated)
    - g int psmatchid = .
(1,536 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         96
                                                  LR chi2(6)      =       7.27
                                                  Prob > chi2     =     0.2962
Log likelihood = -6.0840338                       Pseudo R2       =     0.3742

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -10.97408   9.842298    -1.11   0.265    -30.26463     8.31647
baselinelo~2 |  -13.64071   11.52029    -1.18   0.236    -36.22006    8.938642
 baselineage |   .2433174   .1768369     1.38   0.169    -.1032766    .5899115
baselineed~s |   2.151315   1.489024     1.44   0.149     -.767119     5.06975
baselinete~e |  -.8458507   1.188472    -0.71   0.477    -3.175214    1.483512
baselinefi~e |   .0009941   .0008355     1.19   0.234    -.0006434    .0026317
       _cons |   188.2153   127.7088     1.47   0.141    -62.08942      438.52
------------------------------------------------------------------------------
Note: 2 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 69 if _treated==0 | _treated==1
(96 real changes made)
    - replace psmatchid = _id if _treated==0
(94 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,440 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(60 real changes made)
    - replace weight1 = 0 if weight1==.
(1,472 real changes made)
    - keep if weight1==1
(1,472 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(32 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched69
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000q
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000q saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 69+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,050  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(116 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,436 real changes made)
    - drop if baselinerestrictions==0
(2,518 observations deleted)
    - drop baselinerestrictions
    - count
  1,532
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(165 real changes made)
    - drop if sep==9
(176 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1271 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1275 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1275 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1275 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1275 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1275 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1275 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1275 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,275 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1275 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,360 missing values generated)
    - g int matchround = .
(1,360 missing values generated)
    - g int psmatchid = .
(1,360 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 10 obs not used.


Probit regression                                 Number of obs   =         75
                                                  LR chi2(5)      =       0.84
                                                  Prob > chi2     =     0.9745
Log likelihood = -8.8027061                       Pseudo R2       =     0.0454

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   -4.42815   7.637897    -0.58   0.562    -19.39815    10.54185
baselinelo~2 |  -.2438102   5.308711    -0.05   0.963    -10.64869    10.16107
 baselineage |   .0416207   .1030549     0.40   0.686    -.1603632    .2436046
baselineed~s |   .4239131     .84518     0.50   0.616    -1.232609    2.080435
baselinefi~e |  -.0004388   .0008705    -0.50   0.614    -.0021451    .0012674
       _cons |   35.07606   71.72229     0.49   0.625     -105.497    175.6492
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 70 if _treated==0 | _treated==1
(75 real changes made)
    - replace psmatchid = _id if _treated==0
(73 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,125 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(60 real changes made)
    - replace weight1 = 0 if weight1==.
(1,296 real changes made)
    - keep if weight1==1
(1,296 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(32 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched70
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000r
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000r saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 70+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000g if time==1994 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,926  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1990,2005)
(0 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(51 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(914 real changes made)
    - drop if baselinerestrictions==0
(1,951 observations deleted)
    - drop baselinerestrictions
    - count
  975
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(15 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(90 real changes made)
    - drop if sep==9
(96 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(824 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1994
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(825 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(825 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1990 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(825 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(880 missing values generated)
    - g int matchround = .
(880 missing values generated)
    - g int psmatchid = .
(880 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 4 predicts failure perfectly;
      baselinetenure omitted and 5 obs not used.


Probit regression                                 Number of obs   =         50
                                                  LR chi2(5)      =       2.34
                                                  Prob > chi2     =     0.8004
Log likelihood = -3.7321358                       Pseudo R2       =     0.2386

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |       6.36    10.5961     0.60   0.548    -14.40798    27.12798
baselinelo~2 |  -3.003453   8.967102    -0.33   0.738    -20.57865    14.57174
 baselineage |    .036824   .1891694     0.19   0.846    -.3339412    .4075892
baselineed~s |  -.2608517   1.273353    -0.20   0.838    -2.756577    2.234873
baselinefi~e |   -.001801   .0030466    -0.59   0.554    -.0077722    .0041701
       _cons |  -30.74458   107.8179    -0.29   0.776    -242.0637    180.5746
------------------------------------------------------------------------------
Note: 1 failure and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 71 if _treated==0 | _treated==1
(50 real changes made)
    - replace psmatchid = _id if _treated==0
(49 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(750 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(30 real changes made)
    - replace weight1 = 0 if weight1==.
(848 real changes made)
    - keep if weight1==1
(848 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1994 - 1
    - g timesincemov = timesince if sep
(16 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1994
    - tempfile matched`matchround'
    = tempfile matched71
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000s
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000s saved as .dta format
    - }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1995, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(85 missing values generated)
    - tempfile cells`t'
    = tempfile cells1995
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 71+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,620  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(285 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(108 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,677 real changes made)
    - drop if baselinerestrictions==0
(2,538 observations deleted)
    - drop baselinerestrictions
    - count
  1,797
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(168 real changes made)
    - drop if sep==9
(180 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1509 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1512 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1512 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1512 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1512 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1512 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1512 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1512 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,512 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1512 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,620 missing values generated)
    - g int matchround = .
(1,620 missing values generated)
    - g int psmatchid = .
(1,620 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 26 obs not used.


Probit regression                                 Number of obs   =         82
                                                  LR chi2(5)      =       5.52
                                                  Prob > chi2     =     0.3562
Log likelihood = -13.224554                       Pseudo R2       =     0.1726

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -.4908381   8.803859    -0.06   0.956    -17.74608    16.76441
baselinelo~2 |  -2.309016   5.053024    -0.46   0.648    -12.21276    7.594729
 baselineage |   .0022168   .1158755     0.02   0.985     -.224895    .2293286
baselineed~s |   -.056846   .9466031    -0.06   0.952    -1.912154    1.798462
baselinefi~e |   .0003678   .0005006     0.73   0.463    -.0006134     .001349
       _cons |   24.25684   84.51921     0.29   0.774    -141.3978    189.9114
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 72 if _treated==0 | _treated==1
(82 real changes made)
    - replace psmatchid = _id if _treated==0
(78 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,148 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(1,500 real changes made)
    - keep if weight1==1
(1,500 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched72
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000u
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000u saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 72+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,927  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(179 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,076 real changes made)
    - drop if baselinerestrictions==0
(1,595 observations deleted)
    - drop baselinerestrictions
    - count
  1,153
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(70 real changes made)
    - drop if sep==9
(75 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1006 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1008 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1008 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1008 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,080 missing values generated)
    - g int matchround = .
(1,080 missing values generated)
    - g int psmatchid = .
(1,080 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         72
                                                  LR chi2(6)      =       8.81
                                                  Prob > chi2     =     0.1847
Log likelihood =  -8.067456                       Pseudo R2       =     0.3531

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   17.16223   16.46804     1.04   0.297    -15.11454    49.43899
baselinelo~2 |  -18.25419   10.43239    -1.75   0.080    -38.70129    2.192907
 baselineage |   .0730981   .1887121     0.39   0.698    -.2967709    .4429671
baselineed~s |   .3373888   1.535091     0.22   0.826    -2.671334    3.346111
baselinete~e |  -.8951047   .8322135    -1.08   0.282    -2.526213    .7360038
baselinefi~e |  -.0002258   .0008979    -0.25   0.801    -.0019858    .0015341
       _cons |   4.156143   128.6596     0.03   0.974     -248.012    256.3242
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 73 if _treated==0 | _treated==1
(72 real changes made)
    - replace psmatchid = _id if _treated==0
(69 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,008 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(84 real changes made)
    - replace weight1 = 0 if weight1==.
(990 real changes made)
    - keep if weight1==1
(990 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(45 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched73
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000v
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000v saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 73+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,721  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(234 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(65 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,300 real changes made)
    - drop if baselinerestrictions==0
(2,094 observations deleted)
    - drop baselinerestrictions
    - count
  1,393
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(126 real changes made)
    - drop if sep==9
(135 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1174 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1176 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1176 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1176 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,260 missing values generated)
    - g int matchround = .
(1,260 missing values generated)
    - g int psmatchid = .
(1,260 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 74+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,410  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(146 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(40 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(824 real changes made)
    - drop if baselinerestrictions==0
(1,381 observations deleted)
    - drop baselinerestrictions
    - count
  883
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(768 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(770 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(770 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(770 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(770 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(770 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(825 missing values generated)
    - g int matchround = .
(825 missing values generated)
    - g int psmatchid = .
(825 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         55
                                                  LR chi2(6)      =       3.11
                                                  Prob > chi2     =     0.7947
Log likelihood = -10.087127                       Pseudo R2       =     0.1336

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -.1584714   10.78477    -0.01   0.988    -21.29623    20.97928
baselinelo~2 |   4.786988   8.425769     0.57   0.570    -11.72722    21.30119
 baselineage |   -.024216   .1527066    -0.16   0.874    -.3235154    .2750834
baselineed~s |  -.3273834   1.133599    -0.29   0.773    -2.549197     1.89443
baselinete~e |  -.3896126    .534378    -0.73   0.466    -1.436974     .657749
baselinefi~e |   .0021403   .0019019     1.13   0.260    -.0015874     .005868
       _cons |  -38.20698   96.76186    -0.39   0.693    -227.8567    151.4428
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 75 if _treated==0 | _treated==1
(55 real changes made)
    - replace psmatchid = _id if _treated==0
(52 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(770 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(84 real changes made)
    - replace weight1 = 0 if weight1==.
(735 real changes made)
    - keep if weight1==1
(735 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(45 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched75
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000w
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000w saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 75+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,594  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(282 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(79 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,691 real changes made)
    - drop if baselinerestrictions==0
(2,500 observations deleted)
    - drop baselinerestrictions
    - count
  1,812
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(168 real changes made)
    - drop if sep==9
(180 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1523 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1526 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1526 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1526 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1526 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1526 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1526 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1526 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,526 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1526 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,635 missing values generated)
    - g int matchround = .
(1,635 missing values generated)
    - g int psmatchid = .
(1,635 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 27 obs not used.


Probit regression                                 Number of obs   =         82
                                                  LR chi2(5)      =       6.37
                                                  Prob > chi2     =     0.2719
Log likelihood = -9.6837551                       Pseudo R2       =     0.2475

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.703147   8.795584    -0.31   0.759    -19.94218    14.53588
baselinelo~2 |   11.14389   10.45273     1.07   0.286    -9.343082    31.63086
 baselineage |   -.088596   .1371223    -0.65   0.518    -.3573508    .1801587
baselineed~s |  -.4423228   1.235302    -0.36   0.720    -2.863471    1.978825
baselinefi~e |   .0009198   .0008715     1.06   0.291    -.0007884    .0026279
       _cons |  -72.37312   113.1376    -0.64   0.522    -294.1188    149.3725
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 76 if _treated==0 | _treated==1
(82 real changes made)
    - replace psmatchid = _id if _treated==0
(79 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,148 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(84 real changes made)
    - replace weight1 = 0 if weight1==.
(1,545 real changes made)
    - keep if weight1==1
(1,545 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(45 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched76
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000x
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000x saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 76+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,424  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(149 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(30 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(697 real changes made)
    - drop if baselinerestrictions==0
(1,528 observations deleted)
    - drop baselinerestrictions
    - count
  747
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(84 real changes made)
    - drop if sep==9
(90 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(613 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(616 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(616 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(616 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(660 missing values generated)
    - g int matchround = .
(660 missing values generated)
    - g int psmatchid = .
(660 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         44
                                                  LR chi2(6)      =       3.40
                                                  Prob > chi2     =     0.7567
Log likelihood = -11.701931                       Pseudo R2       =     0.1270

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   2.095569   13.03088     0.16   0.872    -23.44448    27.63562
baselinelo~2 |   5.395983   8.809525     0.61   0.540    -11.87037    22.66234
 baselineage |   -.020765   .1809482    -0.11   0.909     -.375417     .333887
baselineed~s |   -.670565   1.517156    -0.44   0.658    -3.644135    2.303005
baselinete~e |  -.0725674   .4133269    -0.18   0.861    -.8826732    .7375385
baselinefi~e |  -.0007389   .0010738    -0.69   0.491    -.0028435    .0013656
       _cons |  -60.39655   130.8636    -0.46   0.644    -316.8845    196.0914
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 77 if _treated==0 | _treated==1
(44 real changes made)
    - replace psmatchid = _id if _treated==0
(40 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(616 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(540 real changes made)
    - keep if weight1==1
(540 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched77
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000010
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000010 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 77+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,814  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(288 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(61 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,536 real changes made)
    - drop if baselinerestrictions==0
(2,880 observations deleted)
    - drop baselinerestrictions
    - count
  1,646
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(112 real changes made)
    - drop if sep==9
(120 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1424 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1428 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1428 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1428 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1428 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1428 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1428 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1428 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,428 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1428 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,530 missing values generated)
    - g int matchround = .
(1,530 missing values generated)
    - g int psmatchid = .
(1,530 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 31 obs not used.


Probit regression                                 Number of obs   =         71
                                                  LR chi2(5)      =       2.41
                                                  Prob > chi2     =     0.7894
Log likelihood = -7.9036454                       Pseudo R2       =     0.1325

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   10.89216   10.45215     1.04   0.297    -9.593679      31.378
baselinelo~2 |   3.343578   7.827299     0.43   0.669    -11.99765     18.6848
 baselineage |  -.1238882   .1482014    -0.84   0.403    -.4143577    .1665812
baselineed~s |  -1.481444   1.468375    -1.01   0.313    -4.359406    1.396517
baselinefi~e |   .0003695   .0008258     0.45   0.655     -.001249     .001988
       _cons |  -112.9027    120.096    -0.94   0.347    -348.2865     122.481
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 78 if _treated==0 | _treated==1
(71 real changes made)
    - replace psmatchid = _id if _treated==0
(69 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(994 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(56 real changes made)
    - replace weight1 = 0 if weight1==.
(1,470 real changes made)
    - keep if weight1==1
(1,470 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(30 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched78
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000011
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000011 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 78+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,498  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(207 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(66 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,045 real changes made)
    - drop if baselinerestrictions==0
(2,171 observations deleted)
    - drop baselinerestrictions
    - count
  1,120
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - drop if sep==9
(45 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1003 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1008 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1008 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1008 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,008 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1008 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,080 missing values generated)
    - g int matchround = .
(1,080 missing values generated)
    - g int psmatchid = .
(1,080 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 16 obs not used.


Probit regression                                 Number of obs   =         56
                                                  LR chi2(5)      =       4.79
                                                  Prob > chi2     =     0.4415
Log likelihood =  -6.231145                       Pseudo R2       =     0.2778

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -7.742354   12.51057    -0.62   0.536    -32.26263    16.77792
baselinelo~2 |   12.25791   9.778675     1.25   0.210    -6.907942    31.42376
 baselineage |  -.0158563   .1785541    -0.09   0.929    -.3658159    .3341034
baselineed~s |  -.4203545   1.648384    -0.26   0.799    -3.651129     2.81042
baselinefi~e |    .000643   .0007692     0.84   0.403    -.0008646    .0021506
       _cons |  -38.24724    138.188    -0.28   0.782    -309.0908    232.5964
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 79 if _treated==0 | _treated==1
(56 real changes made)
    - replace psmatchid = _id if _treated==0
(54 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(784 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(56 real changes made)
    - replace weight1 = 0 if weight1==.
(1,020 real changes made)
    - keep if weight1==1
(1,020 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(30 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched79
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000012
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000012 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 79+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,442  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(400 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(73 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,761 real changes made)
    - drop if baselinerestrictions==0
(4,155 observations deleted)
    - drop baselinerestrictions
    - count
  1,887
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(13 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(182 real changes made)
    - drop if sep==9
(195 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1579 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1582 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1582 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1582 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1582 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1582 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1582 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1582 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,582 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1582 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,695 missing values generated)
    - g int matchround = .
(1,695 missing values generated)
    - g int psmatchid = .
(1,695 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 20 obs not used.


Probit regression                                 Number of obs   =         93
                                                  LR chi2(5)      =       9.82
                                                  Prob > chi2     =     0.0805
Log likelihood = -11.588332                       Pseudo R2       =     0.2976

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -17.39731   12.11118    -1.44   0.151    -41.13478    6.340163
baselinelo~2 |   24.14295   11.43507     2.11   0.035     1.730623    46.55528
 baselineage |  -.0310472   .1254189    -0.25   0.804    -.2768637    .2147694
baselineed~s |  -.6624561   .9190375    -0.72   0.471    -2.463736    1.138824
baselinefi~e |  -.0005436   .0014019    -0.39   0.698    -.0032912     .002204
       _cons |  -55.60829   81.42472    -0.68   0.495    -215.1978    103.9812
------------------------------------------------------------------------------
Note: 2 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 80 if _treated==0 | _treated==1
(93 real changes made)
    - replace psmatchid = _id if _treated==0
(89 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,302 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(112 real changes made)
    - replace weight1 = 0 if weight1==.
(1,575 real changes made)
    - keep if weight1==1
(1,575 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(60 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched80
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000013
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000013 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 80+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,255  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(249 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(61 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,381 real changes made)
    - drop if baselinerestrictions==0
(2,526 observations deleted)
    - drop baselinerestrictions
    - count
  1,480
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(84 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(111 real changes made)
    - drop if sep==9
(119 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1270 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1274 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1274 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1274 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1274 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1274 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1274 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1274 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,274 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1274 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,365 missing values generated)
    - g int matchround = .
(1,365 missing values generated)
    - g int psmatchid = .
(1,365 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         91
                                                  LR chi2(6)      =       3.45
                                                  Prob > chi2     =     0.7504
Log likelihood = -20.386648                       Pseudo R2       =     0.0780

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   1.782042    5.77034     0.31   0.757    -9.527617     13.0917
baselinelo~2 |  -.7116692   4.127346    -0.17   0.863    -8.801119    7.377781
 baselineage |   .0358512   .0678006     0.53   0.597    -.0970355    .1687379
baselineed~s |  -.1611334   .5784243    -0.28   0.781    -1.294824    .9725574
baselinete~e |   .1098028    .317934     0.35   0.730    -.5133363    .7329419
baselinefi~e |  -.0001079   .0007397    -0.15   0.884    -.0015576    .0013419
       _cons |  -11.50651   47.51851    -0.24   0.809    -104.6411    81.62805
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(10 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 81 if _treated==0 | _treated==1
(91 real changes made)
    - replace psmatchid = _id if _treated==0
(85 real changes made)
    - replace psmatchid = _n1 if _treated==1
(5 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,260 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(140 real changes made)
    - replace weight1 = 0 if weight1==.
(1,215 real changes made)
    - keep if weight1==1
(1,215 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(75 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched81
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000014
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000014 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 81+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,823  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(433 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(116 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(2,180 real changes made)
    - drop if baselinerestrictions==0
(4,054 observations deleted)
    - drop baselinerestrictions
    - count
  2,336
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(14 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(195 real changes made)
    - drop if sep==9
(209 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1985 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1988 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1988 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,988 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1988 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(2,130 missing values generated)
    - g int matchround = .
(2,130 missing values generated)
    - g int psmatchid = .
(2,130 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 29 obs not used.


Probit regression                                 Number of obs   =        113
                                                  LR chi2(5)      =      20.10
                                                  Prob > chi2     =     0.0012
Log likelihood = -1.360e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -45.22102          .        .       .            .           .
baselinelo~2 |  -182.2387          .        .       .            .           .
 baselineage |   6.205931          .        .       .            .           .
baselineed~s |   13.76965          .        .       .            .           .
baselinefi~e |  -.0610336   16.65202    -0.00   0.997     -32.6984    32.57634
       _cons |   1658.525          .        .       .            .           .
------------------------------------------------------------------------------
Note: 111 failures and 1 success completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 82 if _treated==0 | _treated==1
(113 real changes made)
    - replace psmatchid = _id if _treated==0
(111 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,554 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(2,130 real changes made)
    - keep if weight1==1
(2,130 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched82
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000015
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000015 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 82+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,739  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(295 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(61 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,315 real changes made)
    - drop if baselinerestrictions==0
(3,035 observations deleted)
    - drop baselinerestrictions
    - count
  1,409
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(112 real changes made)
    - drop if sep==9
(120 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1203 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1204 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1204 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1204 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1204 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1204 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1204 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1204 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,204 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1204 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,290 missing values generated)
    - g int matchround = .
(1,290 missing values generated)
    - g int psmatchid = .
(1,290 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 5 predicts failure perfectly;
      baselinetenure omitted and 18 obs not used.


Probit regression                                 Number of obs   =         68
                                                  LR chi2(5)      =       4.14
                                                  Prob > chi2     =     0.5288
Log likelihood = -6.9506615                       Pseudo R2       =     0.2297

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -15.90071   13.72271    -1.16   0.247    -42.79673    10.99531
baselinelo~2 |  -5.924553   9.583034    -0.62   0.536    -24.70695    12.85785
 baselineage |   .2910825   .2462604     1.18   0.237    -.1915789     .773744
baselineed~s |   2.055678    1.88466     1.09   0.275    -1.638189    5.749544
baselinefi~e |  -.0007389   .0011079    -0.67   0.505    -.0029103    .0014325
       _cons |   161.0481   159.5397     1.01   0.313     -151.644    473.7401
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 83 if _treated==0 | _treated==1
(68 real changes made)
    - replace psmatchid = _id if _treated==0
(66 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(952 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(56 real changes made)
    - replace weight1 = 0 if weight1==.
(1,230 real changes made)
    - keep if weight1==1
(1,230 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1995 - 1
    - g timesincemov = timesince if sep
(30 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1995
    - tempfile matched`matchround'
    = tempfile matched83
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000016
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000016 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 83+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,937  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(240 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(106 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,202 real changes made)
    - drop if baselinerestrictions==0
(2,409 observations deleted)
    - drop baselinerestrictions
    - count
  1,288
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(112 real changes made)
    - drop if sep==9
(120 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1090 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1092 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1092 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1092 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1092 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1092 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1092 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1092 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,092 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1092 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,170 missing values generated)
    - g int matchround = .
(1,170 missing values generated)
    - g int psmatchid = .
(1,170 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 84+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000t if time==1995 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,856  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1991,2006)
(179 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(50 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(826 real changes made)
    - drop if baselinerestrictions==0
(1,792 observations deleted)
    - drop baselinerestrictions
    - count
  885
    - if r(N)==0 continue
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(70 real changes made)
    - drop if sep==9
(75 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(756 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1995
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(756 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(756 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(756 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(756 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(756 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(756 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(756 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1991 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(756 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(756 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(810 missing values generated)
    - g int matchround = .
(810 missing values generated)
    - g int psmatchid = .
(810 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome = baselinelogearn2 <= 8.739435 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1996, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(114 missing values generated)
    - tempfile cells`t'
    = tempfile cells1996
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 85+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,392  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(533 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(84 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,325 real changes made)
    - drop if baselinerestrictions==0
(2,432 observations deleted)
    - drop baselinerestrictions
    - count
  1,427
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(39 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(104 real changes made)
    - drop if sep==9
(112 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1221 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1222 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1222 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1222 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1222 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1222 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1222 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1222 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,222 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1222 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,316 missing values generated)
    - g int matchround = .
(1,316 missing values generated)
    - g int psmatchid = .
(1,316 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         94
                                                  LR chi2(6)      =       2.39
                                                  Prob > chi2     =     0.8804
Log likelihood =  -12.08977                       Pseudo R2       =     0.0900

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -13.56452   11.42311    -1.19   0.235     -35.9534    8.824352
baselinelo~2 |  -2.003863   7.613971    -0.26   0.792    -16.92697    12.91925
 baselineage |   .1620227    .145988     1.11   0.267    -.1241086     .448154
baselineed~s |   1.303874   1.240712     1.05   0.293    -1.127877    3.735625
baselinete~e |  -.0298735   .2592673    -0.12   0.908    -.5380281     .478281
baselinefi~e |   .0004677   .0005367     0.87   0.383    -.0005842    .0015197
       _cons |   121.4309   110.4609     1.10   0.272    -95.06841    337.9302
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 86 if _treated==0 | _treated==1
(94 real changes made)
    - replace psmatchid = _id if _treated==0
(91 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,222 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(78 real changes made)
    - replace weight1 = 0 if weight1==.
(1,232 real changes made)
    - keep if weight1==1
(1,232 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
(42 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched86
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000018
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000018 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 86+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,882  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(352 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(30 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(920 real changes made)
    - drop if baselinerestrictions==0
(1,539 observations deleted)
    - drop baselinerestrictions
    - count
  991
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(13 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(90 real changes made)
    - drop if sep==9
(97 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(830 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(832 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(832 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(832 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(832 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(832 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(832 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(832 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(832 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(832 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(896 missing values generated)
    - g int matchround = .
(896 missing values generated)
    - g int psmatchid = .
(896 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 50 obs not used.


Probit regression                                 Number of obs   =         14
                                                  LR chi2(5)      =       7.20
                                                  Prob > chi2     =     0.2058
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   366.9352          .        .       .            .           .
baselinelo~2 |  -83.06628          .        .       .            .           .
 baselineage |  -1.434295          .        .       .            .           .
baselinete~e |  -4.187867          .        .       .            .           .
baselinefi~e |   .0169077          .        .       .            .           .
       _cons |  -2442.454          .        .       .            .           .
------------------------------------------------------------------------------
Note: 13 failures and 1 success completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 87 if _treated==0 | _treated==1
(14 real changes made)
    - replace psmatchid = _id if _treated==0
(13 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(169 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(896 real changes made)
    - keep if weight1==1
(896 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched87
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000019
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000019 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 87+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,808  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(480 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(88 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,104 real changes made)
    - drop if baselinerestrictions==0
(2,139 observations deleted)
    - drop baselinerestrictions
    - count
  1,189
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(26 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(117 real changes made)
    - drop if sep==9
(126 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(987 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(988 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(988 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(988 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,064 missing values generated)
    - g int matchround = .
(1,064 missing values generated)
    - g int psmatchid = .
(1,064 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 6 predicts failure perfectly;
      baselinetenure omitted and 17 obs not used.


Probit regression                                 Number of obs   =         59
                                                  LR chi2(5)      =      17.47
                                                  Prob > chi2     =     0.0037
Log likelihood = -1.622e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -1341.704   935152.1    -0.00   0.999     -1834206     1831523
baselinelo~2 |  -136.2239   918464.1    -0.00   1.000     -1800293     1800020
 baselineage |   8.107358   1756.659     0.00   0.996    -3434.881    3451.096
baselineed~s |   119.8334   10284.85     0.01   0.991    -20038.11    20277.78
baselinefi~e |  -.0878252   56.13434    -0.00   0.999    -110.1091    109.9335
       _cons |   12003.81          .        .       .            .           .
------------------------------------------------------------------------------
Note: 54 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 88 if _treated==0 | _treated==1
(59 real changes made)
    - replace psmatchid = _id if _treated==0
(57 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(741 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,064 real changes made)
    - keep if weight1==1
(1,064 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched88
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001a
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001a saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 88+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,478  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(295 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(63 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(752 real changes made)
    - drop if baselinerestrictions==0
(1,373 observations deleted)
    - drop baselinerestrictions
    - count
  810
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(26 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(39 real changes made)
    - drop if sep==9
(42 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(713 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(715 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(715 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(715 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(715 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(715 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(715 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(715 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(715 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(715 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(770 missing values generated)
    - g int matchround = .
(770 missing values generated)
    - g int psmatchid = .
(770 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         55
                                                  LR chi2(6)      =      17.18
                                                  Prob > chi2     =     0.0086
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   252.6652          .        .       .            .           .
baselinelo~2 |   46.45726          .        .       .            .           .
 baselineage |  -.4747093          .        .       .            .           .
baselineed~s |  -12.54979          .        .       .            .           .
baselinete~e |  -45.90493          .        .       .            .           .
baselinefi~e |  -.1944177          .        .       .            .           .
       _cons |  -2363.403          .        .       .            .           .
------------------------------------------------------------------------------
Note: 53 failures and 2 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 89 if _treated==0 | _treated==1
(55 real changes made)
    - replace psmatchid = _id if _treated==0
(53 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(689 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(770 real changes made)
    - keep if weight1==1
(770 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched89
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001b
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001b saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 89+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,682  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(575 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(97 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,466 real changes made)
    - drop if baselinerestrictions==0
(2,528 observations deleted)
    - drop baselinerestrictions
    - count
  1,579
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(26 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(16 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(208 real changes made)
    - drop if sep==9
(224 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1258 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1261 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1261 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1261 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1261 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1261 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1261 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1261 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,261 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1261 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,358 missing values generated)
    - g int matchround = .
(1,358 missing values generated)
    - g int psmatchid = .
(1,358 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         97
                                                  LR chi2(6)      =       9.89
                                                  Prob > chi2     =     0.1296
Log likelihood = -4.7995793                       Pseudo R2       =     0.5073

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -110.5205   94.53038    -1.17   0.242    -295.7967    74.75564
baselinelo~2 |   25.66223   28.17151     0.91   0.362    -29.55292    80.87739
 baselineage |   .7043193    .589073     1.20   0.232    -.4502425    1.858881
baselineed~s |   8.491427   7.123667     1.19   0.233    -5.470703    22.45356
baselinete~e |   1.722951   1.873989     0.92   0.358    -1.950001    5.395903
baselinefi~e |   .0060415   .0062889     0.96   0.337    -.0062845    .0183675
       _cons |   645.7706   545.1334     1.18   0.236    -422.6712    1714.212
------------------------------------------------------------------------------
Note: 62 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 90 if _treated==0 | _treated==1
(97 real changes made)
    - replace psmatchid = _id if _treated==0
(95 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,261 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(52 real changes made)
    - replace weight1 = 0 if weight1==.
(1,302 real changes made)
    - keep if weight1==1
(1,302 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
(28 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched90
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001c
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001c saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 90+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,514  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(295 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(31 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(609 real changes made)
    - drop if baselinerestrictions==0
(1,563 observations deleted)
    - drop baselinerestrictions
    - count
  656
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(64 real changes made)
    - drop if sep==9
(69 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(545 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(546 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(546 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(546 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(546 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(546 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(546 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(546 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(546 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(546 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(588 missing values generated)
    - g int matchround = .
(588 missing values generated)
    - g int psmatchid = .
(588 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 91+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,610  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(551 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(47 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,398 real changes made)
    - drop if baselinerestrictions==0
(2,553 observations deleted)
    - drop baselinerestrictions
    - count
  1,506
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(13 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(51 real changes made)
    - drop if sep==9
(55 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1347 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1352 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1352 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1352 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1352 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1352 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1352 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1352 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,352 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1352 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,456 missing values generated)
    - g int matchround = .
(1,456 missing values generated)
    - g int psmatchid = .
(1,456 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 6 predicts failure perfectly;
      baselinetenure omitted and 42 obs not used.


Probit regression                                 Number of obs   =         62
                                                  LR chi2(5)      =       3.33
                                                  Prob > chi2     =     0.6489
Log likelihood = -3.4527719                       Pseudo R2       =     0.3255

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   13.94017   32.63359     0.43   0.669    -50.02049    77.90083
baselinelo~2 |  -19.52405   30.41006    -0.64   0.521    -79.12668    40.07858
 baselineage |  -.1783666   .4636168    -0.38   0.700    -1.087039    .7303055
baselineed~s |   .0763237   2.925741     0.03   0.979    -5.658024    5.810672
baselinefi~e |  -.0045608   .0062861    -0.73   0.468    -.0168813    .0077596
       _cons |   56.97806   239.6706     0.24   0.812    -412.7677    526.7238
------------------------------------------------------------------------------
Note: 19 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 92 if _treated==0 | _treated==1
(62 real changes made)
    - replace psmatchid = _id if _treated==0
(61 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(806 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(26 real changes made)
    - replace weight1 = 0 if weight1==.
(1,428 real changes made)
    - keep if weight1==1
(1,428 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
(14 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched92
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001d
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001d saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 92+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,410  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(391 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(36 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,074 real changes made)
    - drop if baselinerestrictions==0
(1,862 observations deleted)
    - drop baselinerestrictions
    - count
  1,157
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(91 real changes made)
    - drop if sep==9
(98 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(983 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(988 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(988 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(988 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,064 missing values generated)
    - g int matchround = .
(1,064 missing values generated)
    - g int psmatchid = .
(1,064 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 93+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,374  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(773 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(52 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,580 real changes made)
    - drop if baselinerestrictions==0
(3,899 observations deleted)
    - drop baselinerestrictions
    - count
  1,702
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(17 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(219 real changes made)
    - drop if sep==9
(236 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1361 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1365 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1365 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1365 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1365 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1365 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1365 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1365 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,365 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1365 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,470 missing values generated)
    - g int matchround = .
(1,470 missing values generated)
    - g int psmatchid = .
(1,470 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 94+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,124  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(487 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(36 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,259 real changes made)
    - drop if baselinerestrictions==0
(2,281 observations deleted)
    - drop baselinerestrictions
    - count
  1,356
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(13 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(91 real changes made)
    - drop if sep==9
(98 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1168 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1170 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1170 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1170 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1170 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1170 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1170 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1170 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,170 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1170 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,260 missing values generated)
    - g int matchround = .
(1,260 missing values generated)
    - g int psmatchid = .
(1,260 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 6 predicts failure perfectly;
      baselinetenure omitted and 36 obs not used.


Probit regression                                 Number of obs   =         54
                                                  LR chi2(5)      =       9.96
                                                  Prob > chi2     =     0.0764
Log likelihood = -4.719e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   557.3391          .        .       .            .           .
baselinelo~2 |   428.0657          .        .       .            .           .
 baselineage |  -10.18564    466.779    -0.02   0.983    -925.0557    904.6844
baselineed~s |  -97.44637   1687.937    -0.06   0.954    -3405.742    3210.849
baselinefi~e |   -.006458   6.306133    -0.00   0.999    -12.36625    12.35334
       _cons |  -7479.066          .        .       .            .           .
------------------------------------------------------------------------------
Note: 51 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 95 if _treated==0 | _treated==1
(54 real changes made)
    - replace psmatchid = _id if _treated==0
(53 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(689 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,260 real changes made)
    - keep if weight1==1
(1,260 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched95
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001e
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001e saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 95+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             7,055  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(866 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(173 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,882 real changes made)
    - drop if baselinerestrictions==0
(4,162 observations deleted)
    - drop baselinerestrictions
    - count
  2,027
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(38 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(16 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(208 real changes made)
    - drop if sep==9
(224 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1674 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1677 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1677 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1677 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1677 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1677 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1677 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1677 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,677 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1677 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,806 missing values generated)
    - g int matchround = .
(1,806 missing values generated)
    - g int psmatchid = .
(1,806 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =        129
                                                  LR chi2(6)      =      13.43
                                                  Prob > chi2     =     0.0368
Log likelihood = -7.5357198                       Pseudo R2       =     0.4711

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -.3615946   15.78081    -0.02   0.982    -31.29142    30.56823
baselinelo~2 |   9.561711   11.30158     0.85   0.398    -12.58899    31.71241
 baselineage |  -.1934963   .2475894    -0.78   0.434    -.6787626    .2917699
baselineed~s |  -.3423476   1.879126    -0.18   0.855    -4.025367    3.340672
baselinete~e |   .0912854   .3786043     0.24   0.809    -.6507654    .8333362
baselinefi~e |   .0006392    .000517     1.24   0.216     -.000374    .0016524
       _cons |  -78.04976   168.1191    -0.46   0.642    -407.5572    251.4577
------------------------------------------------------------------------------
Note: 3 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 96 if _treated==0 | _treated==1
(129 real changes made)
    - replace psmatchid = _id if _treated==0
(126 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,664 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(52 real changes made)
    - replace weight1 = 0 if weight1==.
(1,750 real changes made)
    - keep if weight1==1
(1,750 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
(28 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched96
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001f
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001f saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 96+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,712  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(569 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(62 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,272 real changes made)
    - drop if baselinerestrictions==0
(2,773 observations deleted)
    - drop baselinerestrictions
    - count
  1,370
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(13 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(15 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(195 real changes made)
    - drop if sep==9
(210 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1077 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1079 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1079 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1079 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1079 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1079 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1079 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1079 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,079 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1079 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,162 missing values generated)
    - g int matchround = .
(1,162 missing values generated)
    - g int psmatchid = .
(1,162 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 72 obs not used.

note: baselinetenure != 6 predicts failure perfectly;
      baselinetenure omitted and 4 obs not used.

outcome = baselinelogearn2 <= 8.728194 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 97+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,085  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(481 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(87 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,099 real changes made)
    - drop if baselinerestrictions==0
(2,420 observations deleted)
    - drop baselinerestrictions
    - count
  1,184
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(117 real changes made)
    - drop if sep==9
(126 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(982 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(988 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(988 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(988 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(988 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(988 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,064 missing values generated)
    - g int matchround = .
(1,064 missing values generated)
    - g int psmatchid = .
(1,064 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 28 predicts failure perfectly;
      baselineage omitted and 70 obs not used.

note: baselinetenure omitted because of collinearity.

Probit regression                                 Number of obs   =          6
                                                  LR chi2(4)      =       5.41
                                                  Prob > chi2     =     0.2481
Log likelihood = -1.725e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -705.9518          .        .       .            .           .
baselinelo~2 |   113.8592          .        .       .            .           .
baselineed~s |   51.77111          .        .       .            .           .
baselinefi~e |   .0115732   59.54997     0.00   1.000    -116.7042    116.7274
       _cons |   4848.464          .        .       .            .           .
------------------------------------------------------------------------------
Note: 4 failures and 1 success completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 98 if _treated==0 | _treated==1
(6 real changes made)
    - replace psmatchid = _id if _treated==0
(5 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(65 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,064 real changes made)
    - keep if weight1==1
(1,064 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched98
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001g
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001g saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 98+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000017 if time==1996 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,851  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1992,2007)
(341 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(44 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(788 real changes made)
    - drop if baselinerestrictions==0
(1,661 observations deleted)
    - drop baselinerestrictions
    - count
  849
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(52 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(51 real changes made)
    - drop if sep==9
(55 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(737 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1996
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(741 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(741 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(741 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(741 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(741 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(741 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(741 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1992 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(741 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(741 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(798 missing values generated)
    - g int matchround = .
(798 missing values generated)
    - g int psmatchid = .
(798 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         57
                                                  LR chi2(6)      =       2.64
                                                  Prob > chi2     =     0.8524
Log likelihood = -13.163083                       Pseudo R2       =     0.0912

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.904381   11.16695    -0.26   0.795    -24.79121    18.98244
baselinelo~2 |    3.43962   8.724239     0.39   0.693    -13.65957    20.53881
 baselineage |  -.0404303   .1390548    -0.29   0.771    -.3129727    .2321121
baselineed~s |  -.0774088   1.187108    -0.07   0.948    -2.404097     2.24928
baselinete~e |  -.2331213   .2234862    -1.04   0.297    -.6711462    .2049035
baselinefi~e |   -.000456   .0006072    -0.75   0.453     -.001646     .000734
       _cons |   -2.38288   101.5258    -0.02   0.981    -201.3699    196.6041
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 99 if _treated==0 | _treated==1
(57 real changes made)
    - replace psmatchid = _id if _treated==0
(53 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(741 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(104 real changes made)
    - replace weight1 = 0 if weight1==.
(686 real changes made)
    - keep if weight1==1
(686 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1996 - 1
    - g timesincemov = timesince if sep
(56 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1996
    - tempfile matched`matchround'
    = tempfile matched99
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001h
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001h saved as .dta format
    - }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1997, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(116 missing values generated)
    - tempfile cells`t'
    = tempfile cells1997
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 99+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,418  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(793 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(66 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,077 real changes made)
    - drop if baselinerestrictions==0
(2,458 observations deleted)
    - drop baselinerestrictions
    - count
  1,167
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(108 real changes made)
    - drop if sep==9
(117 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(969 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(972 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(972 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(972 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(972 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(972 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(972 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(972 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(972 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(972 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,053 missing values generated)
    - g int matchround = .
(1,053 missing values generated)
    - g int psmatchid = .
(1,053 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         81
                                                  LR chi2(6)      =      10.42
                                                  Prob > chi2     =     0.1079
Log likelihood = -4.1657815                       Pseudo R2       =     0.5558

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   13.19079   31.44109     0.42   0.675     -48.4326    74.81419
baselinelo~2 |   41.76336   38.57324     1.08   0.279     -33.8388    117.3655
 baselineage |  -.7579382   .7016199    -1.08   0.280    -2.133088    .6172115
baselineed~s |  -5.027945   4.553669    -1.10   0.270    -13.95297    3.897082
baselinete~e |  -.3093286   .4187036    -0.74   0.460    -1.129973    .5113155
baselinefi~e |   .0031556   .0038097     0.83   0.407    -.0043112    .0106225
       _cons |  -429.8256   417.4104    -1.03   0.303    -1247.935    388.2838
------------------------------------------------------------------------------
Note: 35 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 100 if _treated==0 | _treated==1
(81 real changes made)
    - replace psmatchid = _id if _treated==0
(79 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(972 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(48 real changes made)
    - replace weight1 = 0 if weight1==.
(1,001 real changes made)
    - keep if weight1==1
(1,001 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(26 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched100
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001j
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001j saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 100+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,831  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(505 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(812 real changes made)
    - drop if baselinerestrictions==0
(1,446 observations deleted)
    - drop baselinerestrictions
    - count
  880
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(108 real changes made)
    - drop if sep==9
(117 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(704 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(708 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(708 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(708 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(708 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(708 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(708 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(708 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(708 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(708 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(767 missing values generated)
    - g int matchround = .
(767 missing values generated)
    - g int psmatchid = .
(767 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 7 predicts failure perfectly;
      baselinetenure omitted and 25 obs not used.


Probit regression                                 Number of obs   =         34
                                                  LR chi2(5)      =       3.65
                                                  Prob > chi2     =     0.6014
Log likelihood = -5.7832679                       Pseudo R2       =     0.2397

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   9.706541   14.29826     0.68   0.497    -18.31754    37.73062
baselinelo~2 |  -9.759629   23.62049    -0.41   0.679    -56.05495    36.53569
 baselineage |  -.0707152   .3001099    -0.24   0.814    -.6589198    .5174894
baselineed~s |   .2556955   2.933488     0.09   0.931    -5.493835    6.005226
baselinefi~e |  -.0002571   .0008885    -0.29   0.772    -.0019985    .0014843
       _cons |   -1.33974   244.1252    -0.01   0.996    -479.8162    477.1368
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 101 if _treated==0 | _treated==1
(34 real changes made)
    - replace psmatchid = _id if _treated==0
(32 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(408 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(48 real changes made)
    - replace weight1 = 0 if weight1==.
(715 real changes made)
    - keep if weight1==1
(715 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(26 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched101
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001k
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001k saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 101+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,806  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(694 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(72 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(910 real changes made)
    - drop if baselinerestrictions==0
(2,126 observations deleted)
    - drop baselinerestrictions
    - count
  986
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(84 real changes made)
    - drop if sep==9
(91 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(826 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(828 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(828 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(828 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(828 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(828 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(828 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(828 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(828 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(828 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(897 missing values generated)
    - g int matchround = .
(897 missing values generated)
    - g int psmatchid = .
(897 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 15 predicts failure perfectly;
      baselineedyrs omitted and 57 obs not used.

outcome = baselinelogearn2 <= 9.509218 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 102+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,487  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(445 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(55 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(633 real changes made)
    - drop if baselinerestrictions==0
(1,356 observations deleted)
    - drop baselinerestrictions
    - count
  686
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(84 real changes made)
    - drop if sep==9
(91 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(549 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(552 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(552 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(552 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(598 missing values generated)
    - g int matchround = .
(598 missing values generated)
    - g int psmatchid = .
(598 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 103+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,647  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(837 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(77 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,231 real changes made)
    - drop if baselinerestrictions==0
(2,476 observations deleted)
    - drop baselinerestrictions
    - count
  1,334
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(36 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(13 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(154 real changes made)
    - drop if sep==9
(167 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1077 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1080 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1080 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1080 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1080 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1080 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1080 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1080 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,080 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1080 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,170 missing values generated)
    - g int matchround = .
(1,170 missing values generated)
    - g int psmatchid = .
(1,170 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         90
                                                  LR chi2(6)      =       3.39
                                                  Prob > chi2     =     0.7581
Log likelihood = -11.456322                       Pseudo R2       =     0.1290

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -7.755989   8.581242    -0.90   0.366    -24.57491    9.062935
baselinelo~2 |  -1.360543   9.364729    -0.15   0.884    -19.71507    16.99399
 baselineage |   .1056032    .137694     0.77   0.443     -.164272    .3754784
baselineed~s |   .6838018   1.090831     0.63   0.531    -1.454188    2.821792
baselinete~e |  -.1219862   .1813103    -0.67   0.501    -.4773479    .2333755
baselinefi~e |  -.0010542   .0012064    -0.87   0.382    -.0034188    .0013103
       _cons |   72.06419   95.90736     0.75   0.452    -115.9108    260.0392
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 104 if _treated==0 | _treated==1
(90 real changes made)
    - replace psmatchid = _id if _treated==0
(87 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,080 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(72 real changes made)
    - replace weight1 = 0 if weight1==.
(1,092 real changes made)
    - keep if weight1==1
(1,092 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(39 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched104
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001l
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001l saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 104+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,557  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(445 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(26 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(583 real changes made)
    - drop if baselinerestrictions==0
(1,480 observations deleted)
    - drop baselinerestrictions
    - count
  632
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(48 real changes made)
    - drop if sep==9
(52 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(535 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(540 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(540 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(540 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(540 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(540 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(540 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(540 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(540 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(540 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(585 missing values generated)
    - g int matchround = .
(585 missing values generated)
    - g int psmatchid = .
(585 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 7 predicts failure perfectly;
      baselinetenure omitted and 22 obs not used.

note: baselinefirmsize != 1270.689 predicts failure perfectly;
      baselinefirmsize omitted and 18 obs not used.


Probit regression                                 Number of obs   =          5
                                                  LR chi2(4)      =       5.00
                                                  Prob > chi2     =     0.2869
Log likelihood = -6.945e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   447.0025   183221.9     0.00   0.998    -358661.4    359555.4
baselinelo~2 |   993.7196   541468.5     0.00   0.999     -1060265     1062252
 baselineage |  -16.31501   8816.007    -0.00   0.999    -17295.37    17262.74
baselineed~s |  -125.0272   59924.57    -0.00   0.998      -117575      117325
       _cons |  -11042.75    5419385    -0.00   0.998    -1.06e+07    1.06e+07
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 105 if _treated==0 | _treated==1
(5 real changes made)
    - replace psmatchid = _id if _treated==0
(4 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(48 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(585 real changes made)
    - keep if weight1==1
(585 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched105
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001m
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001m saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 105+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,732  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(832 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(52 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,280 real changes made)
    - drop if baselinerestrictions==0
(2,513 observations deleted)
    - drop baselinerestrictions
    - count
  1,387
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(36 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(108 real changes made)
    - drop if sep==9
(117 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1172 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1176 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1176 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1176 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,274 missing values generated)
    - g int matchround = .
(1,274 missing values generated)
    - g int psmatchid = .
(1,274 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         98
                                                  LR chi2(6)      =       6.03
                                                  Prob > chi2     =     0.4197
Log likelihood = -10.396904                       Pseudo R2       =     0.2248

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   3.099749   10.01175     0.31   0.757    -16.52292    22.72242
baselinelo~2 |   7.325501   12.08695     0.61   0.544    -16.36449    31.01549
 baselineage |  -.1210033   .1605941    -0.75   0.451    -.4357619    .1937554
baselineed~s |  -1.022564   1.470803    -0.70   0.487    -3.905286    1.860158
baselinete~e |   .0886452   .2456051     0.36   0.718     -.392732    .5700224
baselinefi~e |  -.0060334    .004237    -1.42   0.154    -.0143377    .0022709
       _cons |   -80.5204   127.7358    -0.63   0.528    -330.8779    169.8371
------------------------------------------------------------------------------
Note: 16 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 106 if _treated==0 | _treated==1
(98 real changes made)
    - replace psmatchid = _id if _treated==0
(95 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,176 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(72 real changes made)
    - replace weight1 = 0 if weight1==.
(1,196 real changes made)
    - keep if weight1==1
(1,196 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(39 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched106
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001n
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001n saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 106+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,506  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(586 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(52 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(947 real changes made)
    - drop if baselinerestrictions==0
(1,894 observations deleted)
    - drop baselinerestrictions
    - count
  1,026
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(132 real changes made)
    - drop if sep==9
(143 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(815 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(816 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(816 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(816 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(884 missing values generated)
    - g int matchround = .
(884 missing values generated)
    - g int psmatchid = .
(884 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 7 predicts failure perfectly;
      baselinetenure omitted and 33 obs not used.


Probit regression                                 Number of obs   =         35
                                                  LR chi2(5)      =       9.08
                                                  Prob > chi2     =     0.1058
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -19.64963          .        .       .            .           .
baselinelo~2 |   237.9115          .        .       .            .           .
 baselineage |  -1.233401          .        .       .            .           .
baselineed~s |    -18.086          .        .       .            .           .
baselinefi~e |  -.0066352          .        .       .            .           .
       _cons |  -1746.102          .        .       .            .           .
------------------------------------------------------------------------------
Note: 34 failures and 1 success completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 107 if _treated==0 | _treated==1
(35 real changes made)
    - replace psmatchid = _id if _treated==0
(34 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(408 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(884 real changes made)
    - keep if weight1==1
(884 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched107
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001o
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001o saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 107+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,601  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(1,190 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(93 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,355 real changes made)
    - drop if baselinerestrictions==0
(3,943 observations deleted)
    - drop baselinerestrictions
    - count
  1,468
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(48 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(15 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(180 real changes made)
    - drop if sep==9
(195 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1175 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1176 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1176 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1176 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,176 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1176 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,274 missing values generated)
    - g int matchround = .
(1,274 missing values generated)
    - g int psmatchid = .
(1,274 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 7 predicts failure perfectly;
      baselinetenure omitted and 41 obs not used.


Probit regression                                 Number of obs   =         57
                                                  LR chi2(5)      =       1.71
                                                  Prob > chi2     =     0.8871
Log likelihood = -13.626147                       Pseudo R2       =     0.0592

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   5.597483   9.597447     0.58   0.560    -13.21317    24.40813
baselinelo~2 |  -10.70141   10.23193    -1.05   0.296    -30.75562    9.352793
 baselineage |   .0531886   .1340216     0.40   0.691     -.209489    .3158661
baselineed~s |   .4483032   1.075698     0.42   0.677    -1.660027    2.556633
baselinefi~e |   -.000759   .0015042    -0.50   0.614    -.0037072    .0021892
       _cons |   38.72321   93.09272     0.42   0.677    -143.7352    221.1816
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 108 if _treated==0 | _treated==1
(57 real changes made)
    - replace psmatchid = _id if _treated==0
(53 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(684 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(96 real changes made)
    - replace weight1 = 0 if weight1==.
(1,170 real changes made)
    - keep if weight1==1
(1,170 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(52 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched108
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001p
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001p saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 108+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,463  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(793 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(74 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,113 real changes made)
    - drop if baselinerestrictions==0
(2,464 observations deleted)
    - drop baselinerestrictions
    - count
  1,206
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(11 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(83 real changes made)
    - drop if sep==9
(90 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1030 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1032 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1032 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1032 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,118 missing values generated)
    - g int matchround = .
(1,118 missing values generated)
    - g int psmatchid = .
(1,118 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 28 predicts failure perfectly;
      baselineage omitted and 84 obs not used.

outcome = baselinelogearn1 <= 8.796019 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 109+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,780  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(1,228 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(147 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,533 real changes made)
    - drop if baselinerestrictions==0
(3,891 observations deleted)
    - drop baselinerestrictions
    - count
  1,661
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(15 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(180 real changes made)
    - drop if sep==9
(195 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1353 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1356 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1356 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1356 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1356 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1356 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1356 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1356 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,356 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1356 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,469 missing values generated)
    - g int matchround = .
(1,469 missing values generated)
    - g int psmatchid = .
(1,469 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 15 predicts failure perfectly;
      baselineedyrs omitted and 95 obs not used.

note: baselinetenure != 7 predicts failure perfectly;
      baselinetenure omitted and 4 obs not used.


Probit regression                                 Number of obs   =         14
                                                  LR chi2(4)      =       7.20
                                                  Prob > chi2     =     0.1254
Log likelihood = -4.463e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -790.2253   11547.13    -0.07   0.945    -23422.18    21841.73
baselinelo~2 |   432.1703          .        .       .            .           .
 baselineage |   1.209724   4640.267     0.00   1.000    -9093.546    9095.965
baselinefi~e |  -.0135077   215.0732    -0.00   1.000    -421.5493    421.5223
       _cons |   3404.215          .        .       .            .           .
------------------------------------------------------------------------------
Note: 11 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 110 if _treated==0 | _treated==1
(14 real changes made)
    - replace psmatchid = _id if _treated==0
(13 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(156 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,469 real changes made)
    - keep if weight1==1
(1,469 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched110
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001q
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001q saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 110+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,380  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(777 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(46 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,098 real changes made)
    - drop if baselinerestrictions==0
(2,413 observations deleted)
    - drop baselinerestrictions
    - count
  1,190
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(23 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(72 real changes made)
    - drop if sep==9
(78 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1026 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1032 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1032 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1032 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,032 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1032 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,118 missing values generated)
    - g int matchround = .
(1,118 missing values generated)
    - g int psmatchid = .
(1,118 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         86
                                                  LR chi2(6)      =       5.87
                                                  Prob > chi2     =     0.4378
Log likelihood = -6.5634468                       Pseudo R2       =     0.3090

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -12.37289   14.91067    -0.83   0.407    -41.59726    16.85149
baselinelo~2 |    9.11374   16.54422     0.55   0.582    -23.31233    41.53981
 baselineage |  -.1383357   .3010408    -0.46   0.646    -.7283648    .4516934
baselineed~s |   .3114555   1.761955     0.18   0.860    -3.141913    3.764824
baselinete~e |  -.0255494   .4279843    -0.06   0.952    -.8643833    .8132845
baselinefi~e |   -.000544   .0011953    -0.46   0.649    -.0028867    .0017988
       _cons |   29.11549   144.0341     0.20   0.840    -253.1862    311.4172
------------------------------------------------------------------------------
Note: 1 failure and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 111 if _treated==0 | _treated==1
(86 real changes made)
    - replace psmatchid = _id if _treated==0
(84 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(1,032 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(48 real changes made)
    - replace weight1 = 0 if weight1==.
(1,066 real changes made)
    - keep if weight1==1
(1,066 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(26 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched111
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001r
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001r saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 111+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,098  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(727 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(82 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(923 real changes made)
    - drop if baselinerestrictions==0
(2,371 observations deleted)
    - drop baselinerestrictions
    - count
  1,000
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(108 real changes made)
    - drop if sep==9
(117 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(815 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(816 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(816 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(816 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(816 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(816 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(884 missing values generated)
    - g int matchround = .
(884 missing values generated)
    - g int psmatchid = .
(884 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         68
                                                  LR chi2(6)      =       4.86
                                                  Prob > chi2     =     0.5620
Log likelihood = -6.5933105                       Pseudo R2       =     0.2693

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |    3.48481   14.29622     0.24   0.807    -24.53526    31.50488
baselinelo~2 |   17.15175   17.49964     0.98   0.327    -17.14692    51.45043
 baselineage |  -.3188428    .293354    -1.09   0.277    -.8938061    .2561205
baselineed~s |  -1.749498   2.203718    -0.79   0.427    -6.068707    2.569711
baselinete~e |   .1072663   .3071182     0.35   0.727    -.4946743    .7092068
baselinefi~e |   -.001933   .0022693    -0.85   0.394    -.0063807    .0025146
       _cons |  -161.9855   193.9749    -0.84   0.404    -542.1694    218.1984
------------------------------------------------------------------------------
Note: 7 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 112 if _treated==0 | _treated==1
(68 real changes made)
    - replace psmatchid = _id if _treated==0
(66 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(816 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(48 real changes made)
    - replace weight1 = 0 if weight1==.
(832 real changes made)
    - keep if weight1==1
(832 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
(26 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched112
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001s
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001s saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 112+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001i if time==1997 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,833  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1993,2008)
(501 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(37 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(754 real changes made)
    - drop if baselinerestrictions==0
(1,515 observations deleted)
    - drop baselinerestrictions
    - count
  817
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(108 real changes made)
    - drop if sep==9
(117 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(646 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1997
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(648 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(648 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1993 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(648 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(702 missing values generated)
    - g int matchround = .
(702 missing values generated)
    - g int psmatchid = .
(702 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 7 predicts failure perfectly;
      baselinetenure omitted and 24 obs not used.


Probit regression                                 Number of obs   =         30
                                                  LR chi2(5)      =       8.77
                                                  Prob > chi2     =     0.1187
Log likelihood = -1.379e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   235.4067          .        .       .            .           .
baselinelo~2 |   886.8369          .        .       .            .           .
 baselineage |  -15.82883          .        .       .            .           .
baselineed~s |  -85.31306          .        .       .            .           .
baselinefi~e |  -.0256794   12.44003    -0.00   0.998    -24.40769    24.35634
       _cons |  -8641.745          .        .       .            .           .
------------------------------------------------------------------------------
Note: 29 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 113 if _treated==0 | _treated==1
(30 real changes made)
    - replace psmatchid = _id if _treated==0
(29 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(348 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(702 real changes made)
    - keep if weight1==1
(702 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1997 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1997
    - tempfile matched`matchround'
    = tempfile matched113
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001t
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001t saved as .dta format
    - }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1998, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(120 missing values generated)
    - tempfile cells`t'
    = tempfile cells1998
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 113+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,498  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,051 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(67 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(930 real changes made)
    - drop if baselinerestrictions==0
(2,432 observations deleted)
    - drop baselinerestrictions
    - count
  1,015
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(1 real change made)
    - bys persid (sep): replace sep = sep[_N]
(11 real changes made)
    - drop if sep==9
(12 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(919 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(924 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(924 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(924 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,008 missing values generated)
    - g int matchround = .
(1,008 missing values generated)
    - g int psmatchid = .
(1,008 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 114+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,790  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(630 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(17 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(678 real changes made)
    - drop if baselinerestrictions==0
(1,420 observations deleted)
    - drop baselinerestrictions
    - count
  740
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(44 real changes made)
    - drop if sep==9
(48 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(634 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(638 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(638 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(638 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(638 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(638 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(638 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(638 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(638 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(638 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(696 missing values generated)
    - g int matchround = .
(696 missing values generated)
    - g int psmatchid = .
(696 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 115+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,755  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(884 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(65 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(834 real changes made)
    - drop if baselinerestrictions==0
(1,961 observations deleted)
    - drop baselinerestrictions
    - count
  910
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(77 real changes made)
    - drop if sep==9
(84 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(757 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(759 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(759 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(759 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(759 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(759 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(759 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(759 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(759 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(759 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(828 missing values generated)
    - g int matchround = .
(828 missing values generated)
    - g int psmatchid = .
(828 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 116+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,431  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(570 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(61 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(537 real changes made)
    - drop if baselinerestrictions==0
(1,275 observations deleted)
    - drop baselinerestrictions
    - count
  586
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(55 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(482 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(484 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(484 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(484 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(484 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(484 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(484 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(484 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(484 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(484 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(528 missing values generated)
    - g int matchround = .
(528 missing values generated)
    - g int psmatchid = .
(528 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 117+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,298  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,015 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(62 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,009 real changes made)
    - drop if baselinerestrictions==0
(2,182 observations deleted)
    - drop baselinerestrictions
    - count
  1,101
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(121 real changes made)
    - drop if sep==9
(132 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(888 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(891 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(891 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(891 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(891 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(891 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(891 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(891 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(891 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(891 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(972 missing values generated)
    - g int matchround = .
(972 missing values generated)
    - g int psmatchid = .
(972 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 118+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,696  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(624 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(29 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(526 real changes made)
    - drop if baselinerestrictions==0
(1,498 observations deleted)
    - drop baselinerestrictions
    - count
  574
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(55 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(471 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(473 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(473 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(473 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(473 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(473 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(473 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(473 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(473 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(473 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(516 missing values generated)
    - g int matchround = .
(516 missing values generated)
    - g int psmatchid = .
(516 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 119+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,896  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,131 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(46 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,031 real changes made)
    - drop if baselinerestrictions==0
(2,640 observations deleted)
    - drop baselinerestrictions
    - count
  1,125
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(109 real changes made)
    - drop if sep==9
(119 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(922 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(924 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(924 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(924 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(924 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(924 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,008 missing values generated)
    - g int matchround = .
(1,008 missing values generated)
    - g int psmatchid = .
(1,008 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 120+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,287  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(722 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(55 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(798 real changes made)
    - drop if baselinerestrictions==0
(1,694 observations deleted)
    - drop baselinerestrictions
    - count
  871
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(120 real changes made)
    - drop if sep==9
(131 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(678 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(682 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(682 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(682 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(682 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(682 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(682 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(682 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(682 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(682 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(744 missing values generated)
    - g int matchround = .
(744 missing values generated)
    - g int psmatchid = .
(744 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 121+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,458  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,513 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(75 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,042 real changes made)
    - drop if baselinerestrictions==0
(3,808 observations deleted)
    - drop baselinerestrictions
    - count
  1,137
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(33 real changes made)
    - drop if sep==9
(36 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1009 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1012 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1012 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1012 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1012 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1012 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1012 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1012 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,012 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1012 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,104 missing values generated)
    - g int matchround = .
(1,104 missing values generated)
    - g int psmatchid = .
(1,104 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 122+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,648  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,107 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(79 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(931 real changes made)
    - drop if baselinerestrictions==0
(2,525 observations deleted)
    - drop baselinerestrictions
    - count
  1,016
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(110 real changes made)
    - drop if sep==9
(120 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(821 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(825 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(825 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(825 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(825 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(825 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(900 missing values generated)
    - g int matchround = .
(900 missing values generated)
    - g int psmatchid = .
(900 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 123+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             7,224  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,707 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(151 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,351 real changes made)
    - drop if baselinerestrictions==0
(4,043 observations deleted)
    - drop baselinerestrictions
    - count
  1,474
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(77 real changes made)
    - drop if sep==9
(84 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1274 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1276 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1276 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1276 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1276 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1276 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1276 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1276 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,276 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1276 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,392 missing values generated)
    - g int matchround = .
(1,392 missing values generated)
    - g int psmatchid = .
(1,392 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 124+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,552  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(1,068 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(40 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,020 real changes made)
    - drop if baselinerestrictions==0
(2,371 observations deleted)
    - drop baselinerestrictions
    - count
  1,113
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(110 real changes made)
    - drop if sep==9
(120 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(910 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(913 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(913 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(913 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(913 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(913 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(913 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(913 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(913 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(913 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(996 missing values generated)
    - g int matchround = .
(996 missing values generated)
    - g int psmatchid = .
(996 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 125+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,021  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(956 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(73 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(689 real changes made)
    - drop if baselinerestrictions==0
(2,313 observations deleted)
    - drop baselinerestrictions
    - count
  752
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(76 real changes made)
    - drop if sep==9
(83 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(613 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(616 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(616 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(616 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(616 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(616 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(672 missing values generated)
    - g int matchround = .
(672 missing values generated)
    - g int psmatchid = .
(672 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 126+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001u if time==1998 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,609  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1994,2009)
(589 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(5 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(601 real changes made)
    - drop if baselinerestrictions==0
(1,364 observations deleted)
    - drop baselinerestrictions
    - count
  656
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(55 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(546 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1998
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(550 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(550 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(550 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(550 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(550 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(550 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(550 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1994 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(550 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(550 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(600 missing values generated)
    - g int matchround = .
(600 missing values generated)
    - g int psmatchid = .
(600 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==1999, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(101 missing values generated)
    - tempfile cells`t'
    = tempfile cells1999
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 127+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,600  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,350 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(958 real changes made)
    - drop if baselinerestrictions==0
(2,196 observations deleted)
    - drop baselinerestrictions
    - count
  1,054
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(110 real changes made)
    - drop if sep==9
(121 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(848 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(850 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(850 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(850 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(850 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(850 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(850 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(850 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(850 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(850 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(935 missing values generated)
    - g int matchround = .
(935 missing values generated)
    - g int psmatchid = .
(935 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 128+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,917  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(822 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(27 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(568 real changes made)
    - drop if baselinerestrictions==0
(1,470 observations deleted)
    - drop baselinerestrictions
    - count
  625
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(50 real changes made)
    - drop if sep==9
(55 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(518 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(520 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(520 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(520 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(520 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(520 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(520 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(520 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(520 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(520 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(572 missing values generated)
    - g int matchround = .
(572 missing values generated)
    - g int psmatchid = .
(572 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 129+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,751  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,070 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(46 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(780 real changes made)
    - drop if baselinerestrictions==0
(1,823 observations deleted)
    - drop baselinerestrictions
    - count
  858
    - if r(N)==0 continue
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(70 real changes made)
    - drop if sep==9
(77 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(710 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(710 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(710 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(710 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(781 missing values generated)
    - g int matchround = .
(781 missing values generated)
    - g int psmatchid = .
(781 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 61 obs not used.


Probit regression                                 Number of obs   =         10
                                                  LR chi2(5)      =      10.01
                                                  Prob > chi2     =     0.0750
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   234.9806          .        .       .            .           .
baselinelo~2 |   -77.9234          .        .       .            .           .
 baselineage |  -1.978252          .        .       .            .           .
baselineed~s |  -13.21793          .        .       .            .           .
baselinefi~e |   -.019139          .        .       .            .           .
       _cons |  -1242.498          .        .       .            .           .
------------------------------------------------------------------------------
Note: 8 failures and 2 successes completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 130 if _treated==0 | _treated==1
(10 real changes made)
    - replace psmatchid = _id if _treated==0
(8 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(80 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(781 real changes made)
    - keep if weight1==1
(781 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1999 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1999
    - tempfile matched`matchround'
    = tempfile matched130
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001w
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001w saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 130+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,428  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(706 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(506 real changes made)
    - drop if baselinerestrictions==0
(1,165 observations deleted)
    - drop baselinerestrictions
    - count
  557
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(68 real changes made)
    - drop if sep==9
(75 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(438 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(440 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(440 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(440 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(440 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(440 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(484 missing values generated)
    - g int matchround = .
(484 missing values generated)
    - g int psmatchid = .
(484 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 131+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,225  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,229 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(59 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(834 real changes made)
    - drop if baselinerestrictions==0
(2,078 observations deleted)
    - drop baselinerestrictions
    - count
  918
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(120 real changes made)
    - drop if sep==9
(132 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(714 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(720 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(720 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(720 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(720 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(720 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(720 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(720 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(720 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(720 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(792 missing values generated)
    - g int matchround = .
(792 missing values generated)
    - g int psmatchid = .
(792 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 132+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,692  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(776 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(26 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(457 real changes made)
    - drop if baselinerestrictions==0
(1,413 observations deleted)
    - drop baselinerestrictions
    - count
  503
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(90 real changes made)
    - drop if sep==9
(99 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(367 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(370 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(370 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(370 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(370 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(370 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(407 missing values generated)
    - g int matchround = .
(407 missing values generated)
    - g int psmatchid = .
(407 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         37
                                                  LR chi2(6)      =      15.56
                                                  Prob > chi2     =     0.0163
Log likelihood = -2.957e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -230.2701          .        .       .            .           .
baselinelo~2 |   98.11037          .        .       .            .           .
 baselineage |   .9695366   353.8067     0.00   0.998    -692.4789     694.418
baselineed~s |   1.693285          .        .       .            .           .
baselinete~e |  -.4339112          .        .       .            .           .
baselinefi~e |   .0290561   25.28733     0.00   0.999     -49.5332    49.59131
       _cons |   1101.528          .        .       .            .           .
------------------------------------------------------------------------------
Note: 34 failures and 1 success completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 133 if _treated==0 | _treated==1
(37 real changes made)
    - replace psmatchid = _id if _treated==0
(35 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(350 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(407 real changes made)
    - keep if weight1==1
(407 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1999 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1999
    - tempfile matched`matchround'
    = tempfile matched133
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001x
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001x saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 133+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,916  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,406 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(50 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(877 real changes made)
    - drop if baselinerestrictions==0
(2,545 observations deleted)
    - drop baselinerestrictions
    - count
  965
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(68 real changes made)
    - drop if sep==9
(75 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(809 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(810 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(810 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(810 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(810 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(810 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(810 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(810 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(810 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(810 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(891 missing values generated)
    - g int matchround = .
(891 missing values generated)
    - g int psmatchid = .
(891 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 9 predicts failure perfectly;
      baselinetenure omitted and 44 obs not used.


Probit regression                                 Number of obs   =         37
                                                  LR chi2(5)      =       9.19
                                                  Prob > chi2     =     0.1016
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -222.1445          .        .       .            .           .
baselinelo~2 |   9.252651          .        .       .            .           .
 baselineage |    4.69969          .        .       .            .           .
baselineed~s |   31.34285          .        .       .            .           .
baselinefi~e |  -.0641726          .        .       .            .           .
       _cons |   1424.875          .        .       .            .           .
------------------------------------------------------------------------------
Note: 36 failures and 1 success completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 134 if _treated==0 | _treated==1
(37 real changes made)
    - replace psmatchid = _id if _treated==0
(36 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(360 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(891 real changes made)
    - keep if weight1==1
(891 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1999 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1999
    - tempfile matched`matchround'
    = tempfile matched134
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000020
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000020 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 134+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,378  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(925 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(44 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(716 real changes made)
    - drop if baselinerestrictions==0
(1,665 observations deleted)
    - drop baselinerestrictions
    - count
  788
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(70 real changes made)
    - drop if sep==9
(77 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(646 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(650 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(650 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(650 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(650 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(650 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(650 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(650 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(650 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(650 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(715 missing values generated)
    - g int matchround = .
(715 missing values generated)
    - g int psmatchid = .
(715 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 135+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,435  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,851 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(91 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,082 real changes made)
    - drop if baselinerestrictions==0
(3,393 observations deleted)
    - drop baselinerestrictions
    - count
  1,191
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(90 real changes made)
    - drop if sep==9
(99 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(992 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(8 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(8 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(8 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1000 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1000 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1000 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1000 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1000 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1000 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1000 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,000 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1000 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,100 missing values generated)
    - g int matchround = .
(1,100 missing values generated)
    - g int psmatchid = .
(1,100 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =        100
                                                  LR chi2(6)      =      11.20
                                                  Prob > chi2     =     0.0824
Log likelihood = -1.672e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   -553.869   1108.028    -0.50   0.617    -2725.564    1617.826
baselinelo~2 |  -72.68687          .        .       .            .           .
 baselineage |   7.335518   570.0003     0.01   0.990    -1109.845    1124.516
baselineed~s |   52.25137   2206.709     0.02   0.981    -4272.818    4377.321
baselinete~e |  -5.625137          .        .       .            .           .
baselinefi~e |   .0312964   6.702475     0.00   0.996    -13.10531    13.16791
       _cons |   4944.467          .        .       .            .           .
------------------------------------------------------------------------------
Note: 96 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 136 if _treated==0 | _treated==1
(100 real changes made)
    - replace psmatchid = _id if _treated==0
(99 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(990 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(1,100 real changes made)
    - keep if weight1==1
(1,100 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1999 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1999
    - tempfile matched`matchround'
    = tempfile matched136
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000021
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000021 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 136+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,709  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,374 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(84 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(710 real changes made)
    - drop if baselinerestrictions==0
(2,554 observations deleted)
    - drop baselinerestrictions
    - count
  781
    - if r(N)==0 continue
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(80 real changes made)
    - drop if sep==9
(88 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(630 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(630 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(630 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(630 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(630 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(630 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(630 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(630 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(630 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(630 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(693 missing values generated)
    - g int matchround = .
(693 missing values generated)
    - g int psmatchid = .
(693 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 29 predicts failure perfectly;
      baselineage omitted and 60 obs not used.

outcome = baselinelogearn1 > 8.98513 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 137+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             7,223  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(2,119 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(159 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,265 real changes made)
    - drop if baselinerestrictions==0
(3,712 observations deleted)
    - drop baselinerestrictions
    - count
  1,392
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(14 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(139 real changes made)
    - drop if sep==9
(153 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(1126 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(1130 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(1130 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(1130 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(1130 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(1130 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(1130 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(1130 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(1,130 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(1130 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,243 missing values generated)
    - g int matchround = .
(1,243 missing values generated)
    - g int psmatchid = .
(1,243 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 102 obs not used.

outcome = baselineage > 49 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 138+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,329  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,255 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(40 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(829 real changes made)
    - drop if baselinerestrictions==0
(2,162 observations deleted)
    - drop baselinerestrictions
    - count
  912
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(120 real changes made)
    - drop if sep==9
(132 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(709 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(710 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(710 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(710 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(710 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(710 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(781 missing values generated)
    - g int matchround = .
(781 missing values generated)
    - g int psmatchid = .
(781 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 63 obs not used.

outcome = baselinelogearn1 > 9.024786 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 139+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,021  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(1,172 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(55 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(648 real changes made)
    - drop if baselinerestrictions==0
(2,136 observations deleted)
    - drop baselinerestrictions
    - count
  713
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(60 real changes made)
    - drop if sep==9
(66 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(588 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(590 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(590 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(590 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(590 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(590 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(590 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(590 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(590 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(590 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(649 missing values generated)
    - g int matchround = .
(649 missing values generated)
    - g int psmatchid = .
(649 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 9 predicts failure perfectly;
      baselinetenure omitted and 33 obs not used.

outcome = baselinelogearn2 > 9.726394 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 140+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001v if time==1999 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,599  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1995,2010)
(725 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(5 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(508 real changes made)
    - drop if baselinerestrictions==0
(1,315 observations deleted)
    - drop baselinerestrictions
    - count
  559
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - drop if sep==9
(33 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(478 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==1999
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(480 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(480 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1995 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(480 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(528 missing values generated)
    - g int matchround = .
(528 missing values generated)
    - g int psmatchid = .
(528 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 9 predicts failure perfectly;
      baselinetenure omitted and 30 obs not used.


Probit regression                                 Number of obs   =         18
                                                  LR chi2(5)      =      12.56
                                                  Prob > chi2     =     0.0279
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   730.9455          .        .       .            .           .
baselinelo~2 |  -724.6106          .        .       .            .           .
 baselineage |  -3.803373          .        .       .            .           .
baselineed~s |   19.57638          .        .       .            .           .
baselinefi~e |  -.0445246          .        .       .            .           .
       _cons |  -143.1303          .        .       .            .           .
------------------------------------------------------------------------------
Note: 16 failures and 2 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 141 if _treated==0 | _treated==1
(18 real changes made)
    - replace psmatchid = _id if _treated==0
(16 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(160 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(528 real changes made)
    - keep if weight1==1
(528 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 1999 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 1999
    - tempfile matched`matchround'
    = tempfile matched141
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000022
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000022 saved as .dta format
    - }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==2000, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(110 missing values generated)
    - tempfile cells`t'
    = tempfile cells2000
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 141+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,508  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,557 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(44 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(795 real changes made)
    - drop if baselinerestrictions==0
(2,067 observations deleted)
    - drop baselinerestrictions
    - count
  884
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(26 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(90 real changes made)
    - drop if sep==9
(100 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(705 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(711 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(711 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(711 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(711 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(711 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(711 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(711 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(711 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(711 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(790 missing values generated)
    - g int matchround = .
(790 missing values generated)
    - g int psmatchid = .
(790 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         79
                                                  LR chi2(6)      =       7.41
                                                  Prob > chi2     =     0.2845
Log likelihood = -9.0493817                       Pseudo R2       =     0.2905

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.817735   4.339857    -0.65   0.516     -11.3237    5.688229
baselinelo~2 |   10.05657   7.528186     1.34   0.182    -4.698399    24.81155
 baselineage |  -.0648176   .1113863    -0.58   0.561    -.2831307    .1534955
baselineed~s |  -.6583015   .7801817    -0.84   0.399     -2.18743    .8708265
baselinete~e |  -.1576755   .1447857    -1.09   0.276    -.4414503    .1260992
baselinefi~e |  -.0011503   .0009353    -1.23   0.219    -.0029834    .0006829
       _cons |  -58.22129   69.59081    -0.84   0.403    -194.6168    78.17418
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 142 if _treated==0 | _treated==1
(79 real changes made)
    - replace psmatchid = _id if _treated==0
(76 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(711 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(54 real changes made)
    - replace weight1 = 0 if weight1==.
(730 real changes made)
    - keep if weight1==1
(730 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(30 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched142
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000024
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000024 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 142+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,102  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,032 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(19 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(528 real changes made)
    - drop if baselinerestrictions==0
(1,483 observations deleted)
    - drop baselinerestrictions
    - count
  587
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(54 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(474 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(477 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(477 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(477 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(530 missing values generated)
    - g int matchround = .
(530 missing values generated)
    - g int psmatchid = .
(530 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 143+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,714  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,268 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(21 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(646 real changes made)
    - drop if baselinerestrictions==0
(1,728 observations deleted)
    - drop baselinerestrictions
    - count
  718
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(54 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(592 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(594 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(594 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(594 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(660 missing values generated)
    - g int matchround = .
(660 missing values generated)
    - g int psmatchid = .
(660 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         66
                                                  LR chi2(6)      =       5.88
                                                  Prob > chi2     =     0.4365
Log likelihood = -6.0210763                       Pseudo R2       =     0.3282

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.138114   7.500511    -0.29   0.776    -16.83885    12.56262
baselinelo~2 |  -8.098302   13.20912    -0.61   0.540    -33.98769    17.79109
 baselineage |  -.0065809   .1493462    -0.04   0.965    -.2992941    .2861323
baselineed~s |   .8097687   1.483625     0.55   0.585    -2.098083     3.71762
baselinete~e |   .5171746   .5175304     1.00   0.318    -.4971663    1.531516
baselinefi~e |  -.0095747    .012775    -0.75   0.454    -.0346131    .0154638
       _cons |   81.79911   130.6142     0.63   0.531       -174.2    337.7982
------------------------------------------------------------------------------
Note: 17 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 144 if _treated==0 | _treated==1
(66 real changes made)
    - replace psmatchid = _id if _treated==0
(64 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(594 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(620 real changes made)
    - keep if weight1==1
(620 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(20 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched144
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000025
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000025 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 144+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,196  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(754 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(413 real changes made)
    - drop if baselinerestrictions==0
(983 observations deleted)
    - drop baselinerestrictions
    - count
  459
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - drop if sep==9
(50 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(368 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(369 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(369 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(369 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(369 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(369 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(369 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(369 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(369 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(369 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(410 missing values generated)
    - g int matchround = .
(410 missing values generated)
    - g int psmatchid = .
(410 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         41
                                                  LR chi2(6)      =       7.40
                                                  Prob > chi2     =     0.2850
Log likelihood = -4.2888324                       Pseudo R2       =     0.4633

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   5.495871   14.13159     0.39   0.697    -22.20154    33.19328
baselinelo~2 |   25.50835   39.92628     0.64   0.523    -52.74571    103.7624
 baselineage |  -.6554315   1.028271    -0.64   0.524    -2.670805    1.359942
baselineed~s |  -3.461976   4.992567    -0.69   0.488    -13.24723    6.323276
baselinete~e |   .1323706   .3185528     0.42   0.678    -.4919813    .7567226
baselinefi~e |   .0021356   .0063537     0.34   0.737    -.0103174    .0145886
       _cons |   -224.318   351.0726    -0.64   0.523    -912.4078    463.7717
------------------------------------------------------------------------------
Note: 15 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 145 if _treated==0 | _treated==1
(41 real changes made)
    - replace psmatchid = _id if _treated==0
(39 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(360 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(18 real changes made)
    - replace weight1 = 0 if weight1==.
(390 real changes made)
    - keep if weight1==1
(390 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(10 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched145
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000026
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000026 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 145+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,090  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,399 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(696 real changes made)
    - drop if baselinerestrictions==0
(1,917 observations deleted)
    - drop baselinerestrictions
    - count
  774
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(26 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(53 real changes made)
    - drop if sep==9
(59 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(643 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(648 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(648 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(648 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(648 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(648 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(720 missing values generated)
    - g int matchround = .
(720 missing values generated)
    - g int psmatchid = .
(720 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         72
                                                  LR chi2(6)      =       9.09
                                                  Prob > chi2     =     0.1686
Log likelihood = -7.9264057                       Pseudo R2       =     0.3644

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   4.395873   5.602153     0.78   0.433    -6.584146    15.37589
baselinelo~2 |   12.46537   8.733956     1.43   0.154    -4.652869    29.58361
 baselineage |  -.3421373   .1971307    -1.74   0.083    -.7285064    .0442318
baselineed~s |  -1.629471   .9312856    -1.75   0.080    -3.454757    .1958156
baselinete~e |   .2777947   .2707921     1.03   0.305    -.2529481    .8085374
baselinefi~e |  -.0019457   .0017628    -1.10   0.270    -.0054008    .0015094
       _cons |  -130.1312   76.63193    -1.70   0.089    -280.3271    20.06459
------------------------------------------------------------------------------
Note: 3 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 146 if _treated==0 | _treated==1
(72 real changes made)
    - replace psmatchid = _id if _treated==0
(69 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(639 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(680 real changes made)
    - keep if weight1==1
(680 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(20 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched146
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000027
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000027 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 146+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,674  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(922 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(19 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(377 real changes made)
    - drop if baselinerestrictions==0
(1,333 observations deleted)
    - drop baselinerestrictions
    - count
  419
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - drop if sep==9
(50 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(332 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(333 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(333 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(333 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(333 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(333 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(333 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(333 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(333 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(333 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(370 missing values generated)
    - g int matchround = .
(370 missing values generated)
    - g int psmatchid = .
(370 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         37
                                                  LR chi2(6)      =       5.28
                                                  Prob > chi2     =     0.5087
Log likelihood = -5.1415134                       Pseudo R2       =     0.3392

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   5.349636   4.051192     1.32   0.187    -2.590554    13.28983
baselinelo~2 |  -6.743659    11.7383    -0.57   0.566     -29.7503    16.26299
 baselineage |  -.0866868   .1539298    -0.56   0.573    -.3883837    .2150102
baselineed~s |   .0287307   1.156506     0.02   0.980     -2.23798    2.295441
baselinete~e |  -.4109233   .4183272    -0.98   0.326     -1.23083     .408983
baselinefi~e |   .0016509    .002732     0.60   0.546    -.0037039    .0070056
       _cons |   14.64872   93.54228     0.16   0.876    -168.6908    197.9882
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 147 if _treated==0 | _treated==1
(37 real changes made)
    - replace psmatchid = _id if _treated==0
(35 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(333 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(330 real changes made)
    - keep if weight1==1
(330 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(20 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched147
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000028
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000028 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 147+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             5,296  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,804 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(72 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(772 real changes made)
    - drop if baselinerestrictions==0
(2,634 observations deleted)
    - drop baselinerestrictions
    - count
  858
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(89 real changes made)
    - drop if sep==9
(99 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(683 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(684 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(684 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(684 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(684 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(684 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(684 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(684 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(684 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(684 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(760 missing values generated)
    - g int matchround = .
(760 missing values generated)
    - g int psmatchid = .
(760 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         76
                                                  LR chi2(6)      =       2.49
                                                  Prob > chi2     =     0.8693
Log likelihood = -8.0025065                       Pseudo R2       =     0.1347

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -1.930219   4.232041    -0.46   0.648    -10.22487     6.36443
baselinelo~2 |   1.364248   4.979005     0.27   0.784    -8.394422    11.12292
 baselineage |    .037437   .0809969     0.46   0.644     -.121314    .1961881
baselineed~s |   .0107864   .5960485     0.02   0.986    -1.157447     1.17902
baselinete~e |   -.052957   .1394341    -0.38   0.704    -.3262427    .2203288
baselinefi~e |   .0011171   .0008887     1.26   0.209    -.0006247    .0028589
       _cons |   1.209879   52.31111     0.02   0.982     -101.318    103.7378
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 148 if _treated==0 | _treated==1
(76 real changes made)
    - replace psmatchid = _id if _treated==0
(74 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(684 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(720 real changes made)
    - keep if weight1==1
(720 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(20 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched148
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000029
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000029 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 148+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,466  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,150 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(35 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(616 real changes made)
    - drop if baselinerestrictions==0
(1,631 observations deleted)
    - drop baselinerestrictions
    - count
  685
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - drop if sep==9
(50 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(571 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(576 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(576 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(576 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(576 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(576 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(576 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(576 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(576 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(576 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(640 missing values generated)
    - g int matchround = .
(640 missing values generated)
    - g int psmatchid = .
(640 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 149+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,245  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(2,158 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(76 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(907 real changes made)
    - drop if baselinerestrictions==0
(3,079 observations deleted)
    - drop baselinerestrictions
    - count
  1,008
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(9 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(108 real changes made)
    - drop if sep==9
(120 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(799 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(801 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(801 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(801 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(801 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(801 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(801 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(801 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(801 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(801 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(890 missing values generated)
    - g int matchround = .
(890 missing values generated)
    - g int psmatchid = .
(890 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 76 obs not used.

note: baselinetenure != 10 predicts failure perfectly;
      baselinetenure omitted and 6 obs not used.


Probit regression                                 Number of obs   =          7
                                                  LR chi2(4)      =       5.74
                                                  Prob > chi2     =     0.2193
Log likelihood = -4.543e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -210.4639   65389.84    -0.00   0.997    -128372.2    127951.3
baselinelo~2 |   6.278841   78034.17     0.00   1.000    -152937.9    152950.4
 baselineage |   3.617006   3681.993     0.00   0.999    -7212.957    7220.191
baselinefi~e |  -.0944407   71.60997    -0.00   0.999    -140.4474    140.2585
       _cons |   1729.518          .        .       .            .           .
------------------------------------------------------------------------------
Note: 3 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 150 if _treated==0 | _treated==1
(7 real changes made)
    - replace psmatchid = _id if _treated==0
(6 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(54 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(890 real changes made)
    - keep if weight1==1
(890 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched150
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002a
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002a saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 150+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,550  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,587 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(77 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(574 real changes made)
    - drop if baselinerestrictions==0
(2,325 observations deleted)
    - drop baselinerestrictions
    - count
  638
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(63 real changes made)
    - drop if sep==9
(70 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(511 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(513 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(513 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(513 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(513 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(513 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(513 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(513 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(513 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(513 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(570 missing values generated)
    - g int matchround = .
(570 missing values generated)
    - g int psmatchid = .
(570 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         57
                                                  LR chi2(6)      =       5.61
                                                  Prob > chi2     =     0.4684
Log likelihood = -5.8598615                       Pseudo R2       =     0.3237

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   5.244029    9.03635     0.58   0.562    -12.46689    22.95495
baselinelo~2 |   -19.0001   18.23848    -1.04   0.298    -54.74687    16.74666
 baselineage |   .1959329   .1942851     1.01   0.313    -.1848589    .5767248
baselineed~s |   1.706662   1.505895     1.13   0.257    -1.244837    4.658161
baselinete~e |  -.1187915   .2159297    -0.55   0.582    -.5420059    .3044229
baselinefi~e |  -.0166601   .0147115    -1.13   0.257    -.0454941    .0121739
       _cons |   100.0171   98.99768     1.01   0.312    -94.01483     294.049
------------------------------------------------------------------------------
Note: 18 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 151 if _treated==0 | _treated==1
(57 real changes made)
    - replace psmatchid = _id if _treated==0
(55 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(513 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(530 real changes made)
    - keep if weight1==1
(530 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(20 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched151
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002b
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002b saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 151+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,960  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(2,402 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(97 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(1,027 real changes made)
    - drop if baselinerestrictions==0
(3,416 observations deleted)
    - drop baselinerestrictions
    - count
  1,142
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(27 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(15 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(134 real changes made)
    - drop if sep==9
(149 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(893 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(7 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(7 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(7 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(900 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(900 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(900 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(900 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(900 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(900 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(900 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(900 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(900 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(1,000 missing values generated)
    - g int matchround = .
(1,000 missing values generated)
    - g int psmatchid = .
(1,000 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =        100
                                                  LR chi2(6)      =      10.45
                                                  Prob > chi2     =     0.1070
Log likelihood = -8.2497331                       Pseudo R2       =     0.3877

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   .4182617   3.698258     0.11   0.910     -6.83019    7.666714
baselinelo~2 |   8.241992   8.723787     0.94   0.345    -8.856317     25.3403
 baselineage |  -.0534866   .1048174    -0.51   0.610    -.2589249    .1519518
baselineed~s |  -1.491251   1.151303    -1.30   0.195    -3.747763    .7652606
baselinete~e |  -.1873667   .1819097    -1.03   0.303    -.5439032    .1691697
baselinefi~e |  -.0003145   .0008328    -0.38   0.706    -.0019468    .0013177
       _cons |  -63.90281   81.75668    -0.78   0.434     -224.143    96.33735
------------------------------------------------------------------------------
Note: 13 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 152 if _treated==0 | _treated==1
(100 real changes made)
    - replace psmatchid = _id if _treated==0
(97 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(891 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(960 real changes made)
    - keep if weight1==1
(960 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
(20 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched152
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002c
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002c saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 152+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,449  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,532 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(63 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(644 real changes made)
    - drop if baselinerestrictions==0
(2,201 observations deleted)
    - drop baselinerestrictions
    - count
  716
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(54 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(590 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(594 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(594 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(594 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(594 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(594 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(660 missing values generated)
    - g int matchround = .
(660 missing values generated)
    - g int psmatchid = .
(660 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         66
                                                  LR chi2(6)      =      17.92
                                                  Prob > chi2     =     0.0064
Log likelihood = -1.582e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -5685.744   66151.82    -0.09   0.932    -135340.9    123969.4
baselinelo~2 |  -2521.736    71274.1    -0.04   0.972    -142216.4    137172.9
 baselineage |   76.95225   490.2912     0.16   0.875    -884.0008    1037.905
baselineed~s |   775.8703   1179.708     0.66   0.511    -1536.315    3088.056
baselinete~e |  -73.20957   1322.829    -0.06   0.956    -2665.906    2519.487
baselinefi~e |  -4.292736   76.96415    -0.06   0.956    -155.1397    146.5542
       _cons |   64384.04          .        .       .            .           .
------------------------------------------------------------------------------
Note: 60 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 153 if _treated==0 | _treated==1
(66 real changes made)
    - replace psmatchid = _id if _treated==0
(64 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(576 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(660 real changes made)
    - keep if weight1==1
(660 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2000 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2000
    - tempfile matched`matchround'
    = tempfile matched153
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002d
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002d saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 153+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,880  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(1,340 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(530 real changes made)
    - drop if baselinerestrictions==0
(1,951 observations deleted)
    - drop baselinerestrictions
    - count
  589
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(9 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(54 real changes made)
    - drop if sep==9
(60 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(476 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(477 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(477 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(477 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(477 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(477 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(530 missing values generated)
    - g int matchround = .
(530 missing values generated)
    - g int psmatchid = .
(530 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinefirmsize != 2323.086 predicts failure perfectly;
      baselinefirmsize omitted and 47 obs not used.

outcome = baselineage <= 30 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 154+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000023 if time==2000 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,513  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1996,2011)
(837 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(5 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(455 real changes made)
    - drop if baselinerestrictions==0
(1,170 observations deleted)
    - drop baselinerestrictions
    - count
  506
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(8 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(45 real changes made)
    - drop if sep==9
(50 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(410 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2000
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(414 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(414 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1996 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(414 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(460 missing values generated)
    - g int matchround = .
(460 missing values generated)
    - g int psmatchid = .
(460 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 28 predicts failure perfectly;
      baselineage omitted and 42 obs not used.

outcome = baselinelogearn1 > 9.150911 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==2001, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(129 missing values generated)
    - tempfile cells`t'
    = tempfile cells2001
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 155+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,329  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,733 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(645 real changes made)
    - drop if baselinerestrictions==0
(1,870 observations deleted)
    - drop baselinerestrictions
    - count
  726
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(47 real changes made)
    - drop if sep==9
(53 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(598 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(600 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(600 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(600 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(600 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(600 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(600 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(600 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(600 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(600 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(675 missing values generated)
    - g int matchround = .
(675 missing values generated)
    - g int psmatchid = .
(675 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         75
                                                  LR chi2(6)      =       2.45
                                                  Prob > chi2     =     0.8742
Log likelihood = -11.371453                       Pseudo R2       =     0.0972

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   1.182854   3.187579     0.37   0.711    -5.064686    7.430393
baselinelo~2 |   2.293465   3.695522     0.62   0.535    -4.949625    9.536555
 baselineage |    .004163   .0672451     0.06   0.951     -.127635    .1359611
baselineed~s |   -.204935   .4839837    -0.42   0.672    -1.153526    .7436557
baselinete~e |  -.0308324   .1063279    -0.29   0.772    -.2392313    .1775664
baselinefi~e |  -.0000346   .0006194    -0.06   0.955    -.0012486    .0011795
       _cons |  -32.25646   43.24486    -0.75   0.456    -117.0148    52.50191
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 156 if _treated==0 | _treated==1
(75 real changes made)
    - replace psmatchid = _id if _treated==0
(72 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(600 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(48 real changes made)
    - replace weight1 = 0 if weight1==.
(621 real changes made)
    - keep if weight1==1
(621 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(27 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched156
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002f
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002f saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 156+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,087  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,196 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(21 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(483 real changes made)
    - drop if baselinerestrictions==0
(1,347 observations deleted)
    - drop baselinerestrictions
    - count
  544
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(8 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(55 real changes made)
    - drop if sep==9
(62 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(428 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(432 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(432 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(432 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(432 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(432 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(432 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(432 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(432 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(432 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(486 missing values generated)
    - g int matchround = .
(486 missing values generated)
    - g int psmatchid = .
(486 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 46 obs not used.


Probit regression                                 Number of obs   =          8
                                                  LR chi2(5)      =       6.03
                                                  Prob > chi2     =     0.3035
Log likelihood = -2.008e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -40.67844          .        .       .            .           .
baselinelo~2 |   13.89818          .        .       .            .           .
 baselineage |   .7137577   418.2235     0.00   0.999    -818.9893    820.4168
baselineed~s |   .3989477          .        .       .            .           .
baselinefi~e |    .000849   13.23517     0.00   1.000    -25.93961    25.94131
       _cons |   213.8991          .        .       .            .           .
------------------------------------------------------------------------------
Note: 6 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 157 if _treated==0 | _treated==1
(8 real changes made)
    - replace psmatchid = _id if _treated==0
(7 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(56 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(486 real changes made)
    - keep if weight1==1
(486 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched157
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002g
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002g saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 157+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,539  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,387 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(15 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(588 real changes made)
    - drop if baselinerestrictions==0
(1,490 observations deleted)
    - drop baselinerestrictions
    - count
  662
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(39 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(39 real changes made)
    - drop if sep==9
(44 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(549 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(552 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(552 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(552 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(621 missing values generated)
    - g int matchround = .
(621 missing values generated)
    - g int psmatchid = .
(621 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         69
                                                  LR chi2(6)      =       5.81
                                                  Prob > chi2     =     0.4443
Log likelihood = -15.030348                       Pseudo R2       =     0.1621

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -3.902691   2.739063    -1.42   0.154    -9.271156    1.465774
baselinelo~2 |   1.067735   4.178811     0.26   0.798    -7.122584    9.258053
 baselineage |   .0412248   .0714893     0.58   0.564    -.0988916    .1813412
baselineed~s |   .3587422   .5442692     0.66   0.510    -.7080058     1.42549
baselinete~e |  -.0226167   .0824137    -0.27   0.784    -.1841445    .1389111
baselinefi~e |    .002145   .0016517     1.30   0.194    -.0010923    .0053823
       _cons |   18.64486    43.6617     0.43   0.669     -66.9305    104.2202
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(10 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 158 if _treated==0 | _treated==1
(69 real changes made)
    - replace psmatchid = _id if _treated==0
(64 real changes made)
    - replace psmatchid = _n1 if _treated==1
(5 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(552 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(80 real changes made)
    - replace weight1 = 0 if weight1==.
(531 real changes made)
    - keep if weight1==1
(531 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(45 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched158
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002h
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002h saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 158+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,171  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(884 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(320 real changes made)
    - drop if baselinerestrictions==0
(927 observations deleted)
    - drop baselinerestrictions
    - count
  360
    - if r(N)==0 continue
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(8 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(32 real changes made)
    - drop if sep==9
(36 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(288 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(288 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(288 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(288 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(288 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(288 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(288 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(288 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(288 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(288 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(324 missing values generated)
    - g int matchround = .
(324 missing values generated)
    - g int psmatchid = .
(324 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         36
                                                  LR chi2(6)      =       9.14
                                                  Prob > chi2     =     0.1659
Log likelihood = -1.402e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -59.83379          .        .       .            .           .
baselinelo~2 |   -194.621          .        .       .            .           .
 baselineage |   1.896758          .        .       .            .           .
baselineed~s |   28.66224          .        .       .            .           .
baselinete~e |   -7.39272          .        .       .            .           .
baselinefi~e |   .1172422   7.250214     0.02   0.987    -14.09292     14.3274
       _cons |   1900.199          .        .       .            .           .
------------------------------------------------------------------------------
Note: 35 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 159 if _treated==0 | _treated==1
(36 real changes made)
    - replace psmatchid = _id if _treated==0
(35 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(280 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(324 real changes made)
    - keep if weight1==1
(324 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched159
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002i
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002i saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 159+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,158  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,677 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(603 real changes made)
    - drop if baselinerestrictions==0
(1,802 observations deleted)
    - drop baselinerestrictions
    - count
  679
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(23 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - drop if sep==9
(63 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(547 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(552 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(552 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(552 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(552 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(552 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(621 missing values generated)
    - g int matchround = .
(621 missing values generated)
    - g int psmatchid = .
(621 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         69
                                                  LR chi2(6)      =      13.14
                                                  Prob > chi2     =     0.0409
Log likelihood = -5.7723517                       Pseudo R2       =     0.5322

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -10.45081   8.025194    -1.30   0.193    -26.17991    5.278279
baselinelo~2 |  -4.870722   7.888765    -0.62   0.537    -20.33242    10.59097
 baselineage |   .0394039   .0965173     0.41   0.683    -.1497666    .2285744
baselineed~s |    1.36955   1.008047     1.36   0.174     -.606186    3.345286
baselinete~e |   -.145172   .1912679    -0.76   0.448    -.5200502    .2297061
baselinefi~e |  -.0082753   .0054999    -1.50   0.132    -.0190549    .0025043
       _cons |   126.6105   98.68807     1.28   0.200    -66.81459    320.0355
------------------------------------------------------------------------------
Note: 17 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 160 if _treated==0 | _treated==1
(69 real changes made)
    - replace psmatchid = _id if _treated==0
(66 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(552 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(48 real changes made)
    - replace weight1 = 0 if weight1==.
(567 real changes made)
    - keep if weight1==1
(567 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(27 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched160
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002j
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002j saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 160+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,734  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,088 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(22 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(324 real changes made)
    - drop if baselinerestrictions==0
(1,281 observations deleted)
    - drop baselinerestrictions
    - count
  365
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(47 real changes made)
    - drop if sep==9
(53 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(277 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(280 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(280 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(280 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(280 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(280 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(280 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(280 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(280 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(280 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(315 missing values generated)
    - g int matchround = .
(315 missing values generated)
    - g int psmatchid = .
(315 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 161+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             5,096  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(2,033 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(57 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(626 real changes made)
    - drop if baselinerestrictions==0
(2,358 observations deleted)
    - drop baselinerestrictions
    - count
  705
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(48 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - drop if sep==9
(27 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(602 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(608 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(608 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(608 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(608 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(608 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(608 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(608 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(608 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(608 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(684 missing values generated)
    - g int matchround = .
(684 missing values generated)
    - g int psmatchid = .
(684 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         76
                                                  LR chi2(6)      =       4.78
                                                  Prob > chi2     =     0.5721
Log likelihood = -18.599471                       Pseudo R2       =     0.1139

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   1.092191    2.20617     0.50   0.621    -3.231823    5.416205
baselinelo~2 |  -3.300189   2.632746    -1.25   0.210    -8.460276    1.859898
 baselineage |   .0391336   .0447154     0.88   0.381    -.0485069    .1267741
baselineed~s |   .0438194   .2727205     0.16   0.872     -.490703    .5783418
baselinete~e |   .0149347   .0816687     0.18   0.855    -.1451329    .1750024
baselinefi~e |  -.0010405   .0009753    -1.07   0.286    -.0029521     .000871
       _cons |   17.57998   26.20666     0.67   0.502    -33.78412    68.94409
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(12 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 162 if _treated==0 | _treated==1
(76 real changes made)
    - replace psmatchid = _id if _treated==0
(70 real changes made)
    - replace psmatchid = _n1 if _treated==1
(6 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(608 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(96 real changes made)
    - replace weight1 = 0 if weight1==.
(576 real changes made)
    - keep if weight1==1
(576 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(54 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched162
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002k
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002k saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 162+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,425  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,329 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(17 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(557 real changes made)
    - drop if baselinerestrictions==0
(1,469 observations deleted)
    - drop baselinerestrictions
    - count
  627
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(16 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - drop if sep==9
(27 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(533 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(536 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(536 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(536 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(536 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(536 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(536 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(536 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(536 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(536 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(603 missing values generated)
    - g int matchround = .
(603 missing values generated)
    - g int psmatchid = .
(603 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 57 obs not used.


Probit regression                                 Number of obs   =         10
                                                  LR chi2(5)      =      10.01
                                                  Prob > chi2     =     0.0750
Log likelihood = -3.266e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |    49.5833          .        .       .            .           .
baselinelo~2 |   9.430038          .        .       .            .           .
 baselineage |  -.4168694   265.2541    -0.00   0.999    -520.3053    519.4715
baselineed~s |  -4.277515          .        .       .            .           .
baselinefi~e |  -.0138596   37.94517    -0.00   1.000    -74.38504    74.35732
       _cons |  -476.6491          .        .       .            .           .
------------------------------------------------------------------------------
Note: 7 failures and 1 success completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 163 if _treated==0 | _treated==1
(10 real changes made)
    - replace psmatchid = _id if _treated==0
(8 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(64 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(603 real changes made)
    - keep if weight1==1
(603 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched163
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002l
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002l saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 163+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,545  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(2,621 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(73 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(716 real changes made)
    - drop if baselinerestrictions==0
(3,118 observations deleted)
    - drop baselinerestrictions
    - count
  806
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(15 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(64 real changes made)
    - drop if sep==9
(72 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(652 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(656 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(656 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(656 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(656 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(656 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(656 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(656 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(656 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(656 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(738 missing values generated)
    - g int matchround = .
(738 missing values generated)
    - g int psmatchid = .
(738 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         82
                                                  LR chi2(6)      =       6.75
                                                  Prob > chi2     =     0.3446
Log likelihood =  -6.027416                       Pseudo R2       =     0.3590

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -4.373214    5.82888    -0.75   0.453    -15.79761     7.05118
baselinelo~2 |    4.46206   6.687485     0.67   0.505     -8.64517    17.56929
 baselineage |  -.0837509   .1039422    -0.81   0.420     -.287474    .1199721
baselineed~s |  -.0307197   .6363925    -0.05   0.961    -1.278026    1.216587
baselinete~e |  -.6935221    .725255    -0.96   0.339    -2.114996    .7279517
baselinefi~e |  -.0175264   .0189006    -0.93   0.354    -.0545708    .0195181
       _cons |    7.17052   57.58488     0.12   0.901    -105.6938    120.0348
------------------------------------------------------------------------------
Note: 37 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 164 if _treated==0 | _treated==1
(82 real changes made)
    - replace psmatchid = _id if _treated==0
(80 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(656 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(32 real changes made)
    - replace weight1 = 0 if weight1==.
(702 real changes made)
    - keep if weight1==1
(702 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(18 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched164
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002m
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002m saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 164+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,714  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,902 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(65 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(518 real changes made)
    - drop if baselinerestrictions==0
(2,229 observations deleted)
    - drop baselinerestrictions
    - count
  583
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(8 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(40 real changes made)
    - drop if sep==9
(45 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(478 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(480 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(480 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(480 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(540 missing values generated)
    - g int matchround = .
(540 missing values generated)
    - g int psmatchid = .
(540 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 54 obs not used.

note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 4 obs not used.

outcome = baselinelogearn1 > 8.675585 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 165+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,657  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(2,642 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(71 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(930 real changes made)
    - drop if baselinerestrictions==0
(2,967 observations deleted)
    - drop baselinerestrictions
    - count
  1,048
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(16 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(70 real changes made)
    - drop if sep==9
(79 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(860 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(12 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(12 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(12 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(12 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(12 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(12 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(12 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(872 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(872 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(872 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(872 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(872 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(872 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(872 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(872 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(872 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(981 missing values generated)
    - g int matchround = .
(981 missing values generated)
    - g int psmatchid = .
(981 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =        109
                                                  LR chi2(6)      =       4.04
                                                  Prob > chi2     =     0.6715
Log likelihood =  -7.958867                       Pseudo R2       =     0.2024

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |    .583454   3.407981     0.17   0.864    -6.096067    7.262975
baselinelo~2 |   .7983725   4.643071     0.17   0.863     -8.30188    9.898625
 baselineage |   .0104316   .0805456     0.13   0.897    -.1474349    .1682981
baselineed~s |   .2459877   .6274259     0.39   0.695    -.9837444     1.47572
baselinete~e |   .0105602    .124297     0.08   0.932    -.2330575    .2541778
baselinefi~e |   .0000204   .0007539     0.03   0.978    -.0014571     .001498
       _cons |  -19.25012   47.64349    -0.40   0.686    -112.6296     74.1294
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 166 if _treated==0 | _treated==1
(109 real changes made)
    - replace psmatchid = _id if _treated==0
(107 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(872 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(32 real changes made)
    - replace weight1 = 0 if weight1==.
(945 real changes made)
    - keep if weight1==1
(945 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(18 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched166
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002n
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002n saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 166+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,230  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,684 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(41 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(589 real changes made)
    - drop if baselinerestrictions==0
(1,883 observations deleted)
    - drop baselinerestrictions
    - count
  663
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(48 real changes made)
    - drop if sep==9
(54 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(541 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(544 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(544 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(544 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(544 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(544 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(544 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(544 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(544 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(544 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(612 missing values generated)
    - g int matchround = .
(612 missing values generated)
    - g int psmatchid = .
(612 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 167+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,920  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(1,544 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(48 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(476 real changes made)
    - drop if baselinerestrictions==0
(1,840 observations deleted)
    - drop baselinerestrictions
    - count
  536
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(32 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(78 real changes made)
    - drop if sep==9
(88 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(398 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(400 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(400 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(400 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(400 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(400 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(450 missing values generated)
    - g int matchround = .
(450 missing values generated)
    - g int psmatchid = .
(450 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         50
                                                  LR chi2(6)      =       4.14
                                                  Prob > chi2     =     0.6573
Log likelihood = -11.866785                       Pseudo R2       =     0.1486

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   4.002951   3.148728     1.27   0.204    -2.168442    10.17434
baselinelo~2 |   2.575575   4.553898     0.57   0.572    -6.349901    11.50105
 baselineage |  -.1279863   .0974145    -1.31   0.189    -.3189152    .0629427
baselineed~s |  -.5641302   .4910492    -1.15   0.251    -1.526569    .3983086
baselinete~e |   .0626174   .1324633     0.47   0.636    -.1970059    .3222408
baselinefi~e |    .000399   .0003835     1.04   0.298    -.0003527    .0011507
       _cons |  -52.53822   46.26354    -1.14   0.256    -143.2131    38.13665
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 168 if _treated==0 | _treated==1
(50 real changes made)
    - replace psmatchid = _id if _treated==0
(46 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(400 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(64 real changes made)
    - replace weight1 = 0 if weight1==.
(378 real changes made)
    - keep if weight1==1
(378 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2001 - 1
    - g timesincemov = timesince if sep
(36 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2001
    - tempfile matched`matchround'
    = tempfile matched168
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002o
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002o saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 168+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002e if time==2001 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,362  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1997,2012)
(931 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(12 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(382 real changes made)
    - drop if baselinerestrictions==0
(1,001 observations deleted)
    - drop baselinerestrictions
    - count
  430
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(40 real changes made)
    - drop if sep==9
(45 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(342 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2001
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(344 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(344 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(344 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(344 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(344 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(344 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(344 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1997 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(344 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(344 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(387 missing values generated)
    - g int matchround = .
(387 missing values generated)
    - g int psmatchid = .
(387 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==2002, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(143 missing values generated)
    - tempfile cells`t'
    = tempfile cells2002
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 169+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,682  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(2,141 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(550 real changes made)
    - drop if baselinerestrictions==0
(1,912 observations deleted)
    - drop baselinerestrictions
    - count
  629
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(9 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(63 real changes made)
    - drop if sep==9
(72 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(487 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(490 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(490 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(490 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(490 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(490 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(490 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(490 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(490 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(490 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(560 missing values generated)
    - g int matchround = .
(560 missing values generated)
    - g int psmatchid = .
(560 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         70
                                                  LR chi2(6)      =       5.45
                                                  Prob > chi2     =     0.4879
Log likelihood = -6.3582798                       Pseudo R2       =     0.2999

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   3.371384   3.810894     0.88   0.376    -4.097832     10.8406
baselinelo~2 |  -.9393867   4.479672    -0.21   0.834    -9.719383     7.84061
 baselineage |  -.0463198   .1001856    -0.46   0.644      -.24268    .1500403
baselineed~s |  -.5478772   .7516256    -0.73   0.466    -2.021036    .9252819
baselinete~e |   .1493905   .1369059     1.09   0.275    -.1189402    .4177212
baselinefi~e |  -.0006051   .0010743    -0.56   0.573    -.0027106    .0015004
       _cons |  -18.22267   54.22401    -0.34   0.737    -124.4998    88.05444
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 170 if _treated==0 | _treated==1
(70 real changes made)
    - replace psmatchid = _id if _treated==0
(68 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(490 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(28 real changes made)
    - replace weight1 = 0 if weight1==.
(528 real changes made)
    - keep if weight1==1
(528 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(16 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched170
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002q
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002q saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 170+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,239  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,448 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(20 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(409 real changes made)
    - drop if baselinerestrictions==0
(1,323 observations deleted)
    - drop baselinerestrictions
    - count
  468
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(55 real changes made)
    - drop if sep==9
(63 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(354 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(357 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(357 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(357 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(357 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(357 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(357 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(357 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(357 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(357 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(408 missing values generated)
    - g int matchround = .
(408 missing values generated)
    - g int psmatchid = .
(408 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         51
                                                  LR chi2(6)      =       6.80
                                                  Prob > chi2     =     0.3395
Log likelihood = -5.0365376                       Pseudo R2       =     0.4031

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   4.013492   4.601162     0.87   0.383    -5.004619     13.0316
baselinelo~2 |  -1.959493   5.059678    -0.39   0.699    -11.87628    7.957293
 baselineage |    .010416   .1196137     0.09   0.931    -.2240225    .2448545
baselineed~s |  -.2167472   .4737744    -0.46   0.647    -1.145328    .7118335
baselinete~e |  -.3473607   .2811336    -1.24   0.217    -.8983725    .2036511
baselinefi~e |   .0009761   .0009567     1.02   0.308     -.000899    .0028511
       _cons |  -18.08477   50.09732    -0.36   0.718    -116.2737    80.10418
------------------------------------------------------------------------------
Note: 1 failure and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 171 if _treated==0 | _treated==1
(51 real changes made)
    - replace psmatchid = _id if _treated==0
(49 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(357 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(28 real changes made)
    - replace weight1 = 0 if weight1==.
(376 real changes made)
    - keep if weight1==1
(376 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(16 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched171
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002r
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002r saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 171+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,520  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,583 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(18 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(492 real changes made)
    - drop if baselinerestrictions==0
(1,374 observations deleted)
    - drop baselinerestrictions
    - count
  563
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - drop if sep==9
(48 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(450 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(455 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(455 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(455 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(455 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(455 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(520 missing values generated)
    - g int matchround = .
(520 missing values generated)
    - g int psmatchid = .
(520 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 12 predicts failure perfectly;
      baselinetenure omitted and 44 obs not used.


Probit regression                                 Number of obs   =         21
                                                  LR chi2(5)      =       3.55
                                                  Prob > chi2     =     0.6158
Log likelihood = -8.4501474                       Pseudo R2       =     0.1736

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -5.668715   4.311156    -1.31   0.189    -14.11843    2.780996
baselinelo~2 |  -4.296448   5.010242    -0.86   0.391    -14.11634    5.523446
 baselineage |    .040282   .0841684     0.48   0.632     -.124685     .205249
baselineed~s |   .7011219    .722067     0.97   0.332    -.7141035    2.116347
baselinefi~e |  -.0013252   .0023843    -0.56   0.578    -.0059983     .003348
       _cons |   84.53593   69.40563     1.22   0.223     -51.4966    220.5685
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 172 if _treated==0 | _treated==1
(21 real changes made)
    - replace psmatchid = _id if _treated==0
(17 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(147 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(56 real changes made)
    - replace weight1 = 0 if weight1==.
(456 real changes made)
    - keep if weight1==1
(456 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(32 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched172
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002s
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002s saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 172+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,236  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,040 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(237 real changes made)
    - drop if baselinerestrictions==0
(925 observations deleted)
    - drop baselinerestrictions
    - count
  271
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(21 real changes made)
    - drop if sep==9
(24 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(216 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(217 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(217 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(217 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(217 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(217 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(217 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(217 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(217 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(217 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(248 missing values generated)
    - g int matchround = .
(248 missing values generated)
    - g int psmatchid = .
(248 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         31
                                                  LR chi2(6)      =      14.83
                                                  Prob > chi2     =     0.0216
Log likelihood = -1.747e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   36.48643          .        .       .            .           .
baselinelo~2 |   169.6259   8052.706     0.02   0.983    -15613.39    15952.64
 baselineage |   .3100767   470.2033     0.00   0.999    -921.2714    921.8915
baselineed~s |  -16.36352   4138.623    -0.00   0.997    -8127.915    8095.188
baselinete~e |  -4.382223   1759.954    -0.00   0.998    -3453.828    3445.064
baselinefi~e |   .0061669   17.73022     0.00   1.000    -34.74443    34.75676
       _cons |  -1743.332          .        .       .            .           .
------------------------------------------------------------------------------
Note: 26 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 173 if _treated==0 | _treated==1
(31 real changes made)
    - replace psmatchid = _id if _treated==0
(29 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(203 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(248 real changes made)
    - keep if weight1==1
(248 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched173
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002t
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002t saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 173+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,188  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,906 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(29 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(499 real changes made)
    - drop if baselinerestrictions==0
(1,711 observations deleted)
    - drop baselinerestrictions
    - count
  571
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - drop if sep==9
(48 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(457 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(462 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(462 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(462 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(462 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(462 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(462 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(462 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(462 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(462 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(528 missing values generated)
    - g int matchround = .
(528 missing values generated)
    - g int psmatchid = .
(528 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         66
                                                  LR chi2(6)      =       5.79
                                                  Prob > chi2     =     0.4469
Log likelihood = -6.0664689                       Pseudo R2       =     0.3231

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   8.509248   5.410956     1.57   0.116     -2.09603    19.11453
baselinelo~2 |   .6244838   4.325012     0.14   0.885    -7.852383    9.101351
 baselineage |  -.0568604    .068686    -0.83   0.408    -.1914825    .0777618
baselineed~s |  -.7504276   .6949409    -1.08   0.280    -2.112487    .6116315
baselinete~e |  -.1098643   .1503171    -0.73   0.465    -.4044803    .1847517
baselinefi~e |  -.0011351   .0023389    -0.49   0.627    -.0057192     .003449
       _cons |   -76.7865   61.76203    -1.24   0.214    -197.8379    44.26486
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 174 if _treated==0 | _treated==1
(66 real changes made)
    - replace psmatchid = _id if _treated==0
(64 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(455 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(14 real changes made)
    - replace weight1 = 0 if weight1==.
(512 real changes made)
    - keep if weight1==1
(512 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(8 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched174
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002u
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002u saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 174+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,767  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,263 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(22 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(265 real changes made)
    - drop if baselinerestrictions==0
(1,201 observations deleted)
    - drop baselinerestrictions
    - count
  303
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(7 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(2 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - drop if sep==9
(16 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(251 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(252 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(252 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(252 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(288 missing values generated)
    - g int matchround = .
(288 missing values generated)
    - g int psmatchid = .
(288 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome = baselinelogearn2 <= 8.804584 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 175+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,796  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(2,175 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(33 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(542 real changes made)
    - drop if baselinerestrictions==0
(2,001 observations deleted)
    - drop baselinerestrictions
    - count
  620
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(7 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(49 real changes made)
    - drop if sep==9
(56 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(493 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(497 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(497 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(497 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(568 missing values generated)
    - g int matchround = .
(568 missing values generated)
    - g int psmatchid = .
(568 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         71
                                                  LR chi2(6)      =      10.51
                                                  Prob > chi2     =     0.1047
Log likelihood = -6.310e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |    57.0239          .        .       .            .           .
baselinelo~2 |   37.18725   3322.331     0.01   0.991    -6474.462    6548.837
 baselineage |  -.4497021   689.1643    -0.00   0.999    -1351.187    1350.288
baselineed~s |  -13.01778     2155.5    -0.01   0.995    -4237.721    4211.685
baselinete~e |   5.576427          .        .       .            .           .
baselinefi~e |  -.0002093   43.37262    -0.00   1.000    -85.00898    85.00856
       _cons |  -802.8015          .        .       .            .           .
------------------------------------------------------------------------------
Note: 67 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 176 if _treated==0 | _treated==1
(71 real changes made)
    - replace psmatchid = _id if _treated==0
(70 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(490 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(568 real changes made)
    - keep if weight1==1
(568 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched176
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002v
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002v saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 176+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,295  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,457 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(527 real changes made)
    - drop if baselinerestrictions==0
(1,235 observations deleted)
    - drop baselinerestrictions
    - count
  603
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(7 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(34 real changes made)
    - drop if sep==9
(39 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(493 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(497 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(497 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(497 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(497 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(497 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(568 missing values generated)
    - g int matchround = .
(568 missing values generated)
    - g int psmatchid = .
(568 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 15 predicts failure perfectly;
      baselineedyrs omitted and 62 obs not used.

note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 7 obs not used.

outcome = baselinelogearn1 > 9.433936 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 177+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,279  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(2,875 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(49 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(579 real changes made)
    - drop if baselinerestrictions==0
(2,741 observations deleted)
    - drop baselinerestrictions
    - count
  663
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(14 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(11 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(75 real changes made)
    - drop if sep==9
(86 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(504 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(7 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(7 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(7 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(511 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(511 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(511 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(511 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(511 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(511 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(511 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(511 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(511 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(584 missing values generated)
    - g int matchround = .
(584 missing values generated)
    - g int psmatchid = .
(584 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         73
                                                  LR chi2(6)      =       5.15
                                                  Prob > chi2     =     0.5248
Log likelihood =  -6.592114                       Pseudo R2       =     0.2809

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -3.796954   4.414855    -0.86   0.390    -12.44991    4.856002
baselinelo~2 |  -.9968103   4.576904    -0.22   0.828    -9.967378    7.973757
 baselineage |   .1215276   .0931453     1.30   0.192    -.0610339    .3040891
baselineed~s |   .3053868   .4485072     0.68   0.496    -.5736712    1.184445
baselinete~e |  -.1742119    .249036    -0.70   0.484    -.6623134    .3138896
baselinefi~e |  -.0069668   .0072316    -0.96   0.335    -.0211405    .0072069
       _cons |   37.44017   47.53374     0.79   0.431    -55.72426    130.6046
------------------------------------------------------------------------------
Note: 15 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 178 if _treated==0 | _treated==1
(73 real changes made)
    - replace psmatchid = _id if _treated==0
(71 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(511 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(28 real changes made)
    - replace weight1 = 0 if weight1==.
(552 real changes made)
    - keep if weight1==1
(552 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(16 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched178
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002w
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002w saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 178+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,493  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(2,070 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(51 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(464 real changes made)
    - drop if baselinerestrictions==0
(1,892 observations deleted)
    - drop baselinerestrictions
    - count
  531
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(7 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(13 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(88 real changes made)
    - drop if sep==9
(101 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(376 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(378 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(378 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(378 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(378 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(378 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(378 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(378 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(378 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(378 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(432 missing values generated)
    - g int matchround = .
(432 missing values generated)
    - g int psmatchid = .
(432 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         54
                                                  LR chi2(6)      =       9.96
                                                  Prob > chi2     =     0.1264
Log likelihood = -2.056e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -50.69821          .        .       .            .           .
baselinelo~2 |  -76.93403          .        .       .            .           .
 baselineage |  -3.630867   672.7748    -0.01   0.996    -1322.245    1314.984
baselineed~s |   8.371009          .        .       .            .           .
baselinete~e |   8.625325          .        .       .            .           .
baselinefi~e |   -.168068   106.1362    -0.00   0.999    -208.1912    207.8551
       _cons |     1154.2          .        .       .            .           .
------------------------------------------------------------------------------
Note: 52 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 179 if _treated==0 | _treated==1
(54 real changes made)
    - replace psmatchid = _id if _treated==0
(53 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(371 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(432 real changes made)
    - keep if weight1==1
(432 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched179
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002x
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002x saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 179+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,539  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(2,942 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(62 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(782 real changes made)
    - drop if baselinerestrictions==0
(2,703 observations deleted)
    - drop baselinerestrictions
    - count
  894
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(56 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(83 real changes made)
    - drop if sep==9
(95 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(699 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(700 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(700 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(700 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(700 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(700 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(700 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(700 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(700 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(700 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(800 missing values generated)
    - g int matchround = .
(800 missing values generated)
    - g int psmatchid = .
(800 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =        100
                                                  LR chi2(6)      =      11.31
                                                  Prob > chi2     =     0.0793
Log likelihood = -22.222477                       Pseudo R2       =     0.2028

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   .5640564   1.444925     0.39   0.696    -2.267944    3.396057
baselinelo~2 |   1.982825   1.977557     1.00   0.316    -1.893115    5.858765
 baselineage |  -.1112665   .0488105    -2.28   0.023    -.2069334   -.0155996
baselineed~s |  -.1836198   .2258012    -0.81   0.416    -.6261821    .2589424
baselinete~e |   .0860786   .0895394     0.96   0.336    -.0894154    .2615727
baselinefi~e |   .0005624   .0003523     1.60   0.110    -.0001281     .001253
       _cons |  -20.04811   19.16135    -1.05   0.295    -57.60366    17.50744
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(14 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 180 if _treated==0 | _treated==1
(100 real changes made)
    - replace psmatchid = _id if _treated==0
(92 real changes made)
    - replace psmatchid = _n1 if _treated==1
(7 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(693 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(98 real changes made)
    - replace weight1 = 0 if weight1==.
(688 real changes made)
    - keep if weight1==1
(688 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(56 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched180
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000030
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000030 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 180+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,228  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,931 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(28 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(514 real changes made)
    - drop if baselinerestrictions==0
(1,709 observations deleted)
    - drop baselinerestrictions
    - count
  588
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(69 real changes made)
    - drop if sep==9
(79 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(445 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(448 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(448 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(448 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(448 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(448 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(448 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(448 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(448 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(448 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(512 missing values generated)
    - g int matchround = .
(512 missing values generated)
    - g int psmatchid = .
(512 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         64
                                                  LR chi2(6)      =       9.91
                                                  Prob > chi2     =     0.1286
Log likelihood =  -10.00835                       Pseudo R2       =     0.3311

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   -.313994   3.106583    -0.10   0.919    -6.402785    5.774797
baselinelo~2 |  -3.552799   2.818571    -1.26   0.207    -9.077097    1.971498
 baselineage |   .1085478   .0837151     1.30   0.195    -.0555309    .2726264
baselineed~s |   .4212703   .3752502     1.12   0.262    -.3142065    1.156747
baselinete~e |  -.1389407   .1283541    -1.08   0.279    -.3905101    .1126288
baselinefi~e |   .0012148    .000566     2.15   0.032     .0001055     .002324
       _cons |   24.53859   29.56825     0.83   0.407    -33.41411    82.49129
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 181 if _treated==0 | _treated==1
(64 real changes made)
    - replace psmatchid = _id if _treated==0
(60 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(448 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(56 real changes made)
    - replace weight1 = 0 if weight1==.
(448 real changes made)
    - keep if weight1==1
(448 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2002 - 1
    - g timesincemov = timesince if sep
(32 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2002
    - tempfile matched`matchround'
    = tempfile matched181
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000031
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000031 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 181+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,713  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,692 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(44 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(346 real changes made)
    - drop if baselinerestrictions==0
(1,625 observations deleted)
    - drop baselinerestrictions
    - count
  396
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(49 real changes made)
    - drop if sep==9
(56 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(297 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(301 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(301 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(301 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(301 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(301 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(301 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(301 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(301 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(301 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(344 missing values generated)
    - g int matchround = .
(344 missing values generated)
    - g int psmatchid = .
(344 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 182+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002p if time==2002 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,279  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1998,2013)
(1,030 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(12 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(321 real changes made)
    - drop if baselinerestrictions==0
(882 observations deleted)
    - drop baselinerestrictions
    - count
  367
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(28 real changes made)
    - drop if sep==9
(32 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(293 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2002
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(294 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(294 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(294 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(294 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(294 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(294 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(294 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1998 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(294 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(294 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(336 missing values generated)
    - g int matchround = .
(336 missing values generated)
    - g int psmatchid = .
(336 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==2003, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(164 missing values generated)
    - tempfile cells`t'
    = tempfile cells2003
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 183+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,505  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(2,316 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(455 real changes made)
    - drop if baselinerestrictions==0
(1,657 observations deleted)
    - drop baselinerestrictions
    - count
  532
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(6 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(47 real changes made)
    - drop if sep==9
(55 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(408 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(414 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(414 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(414 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(414 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(414 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(483 missing values generated)
    - g int matchround = .
(483 missing values generated)
    - g int psmatchid = .
(483 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 8 predicts failure perfectly;
      baselineedyrs omitted and 61 obs not used.


Probit regression                                 Number of obs   =          8
                                                  LR chi2(5)      =       6.03
                                                  Prob > chi2     =     0.3035
Log likelihood = -1.009e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   4.918721          .        .       .            .           .
baselinelo~2 |   9.005435          .        .       .            .           .
 baselineage |  -.7448957          .        .       .            .           .
baselinete~e |  -1.437141          .        .       .            .           .
baselinefi~e |  -.0180539    46.6788    -0.00   1.000    -91.50681    91.47071
       _cons |  -84.72804          .        .       .            .           .
------------------------------------------------------------------------------
Note: 7 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 184 if _treated==0 | _treated==1
(8 real changes made)
    - replace psmatchid = _id if _treated==0
(7 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(42 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(483 real changes made)
    - keep if weight1==1
(483 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched184
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000033
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000033 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 184+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,001  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,514 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(17 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(367 real changes made)
    - drop if baselinerestrictions==0
(1,058 observations deleted)
    - drop baselinerestrictions
    - count
  429
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(6 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(36 real changes made)
    - drop if sep==9
(42 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(331 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(336 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(336 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(336 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(336 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(336 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(336 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(336 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(336 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(336 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(392 missing values generated)
    - g int matchround = .
(392 missing values generated)
    - g int psmatchid = .
(392 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         56
                                                  LR chi2(6)      =       7.93
                                                  Prob > chi2     =     0.2432
Log likelihood = -4.6624491                       Pseudo R2       =     0.4596

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -.5457075    3.86592    -0.14   0.888    -8.122771    7.031357
baselinelo~2 |   11.96384   7.321351     1.63   0.102    -2.385748    26.31342
 baselineage |  -.0568322   .0677086    -0.84   0.401    -.1895386    .0758743
baselineed~s |  -1.202894   .7568006    -1.59   0.112    -2.686196    .2804078
baselinete~e |   .0872609   .1631143     0.53   0.593    -.2324373    .4069591
baselinefi~e |  -.0005535   .0011726    -0.47   0.637    -.0028517    .0017448
       _cons |   -92.8962   60.52359    -1.53   0.125    -211.5203    25.72785
------------------------------------------------------------------------------
Note: 2 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 185 if _treated==0 | _treated==1
(56 real changes made)
    - replace psmatchid = _id if _treated==0
(54 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(330 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(12 real changes made)
    - replace weight1 = 0 if weight1==.
(378 real changes made)
    - keep if weight1==1
(378 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(7 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched185
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000034
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000034 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 185+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,338  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,688 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(358 real changes made)
    - drop if baselinerestrictions==0
(1,232 observations deleted)
    - drop baselinerestrictions
    - count
  418
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(6 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - drop if sep==9
(35 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(328 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(330 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(330 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(330 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(330 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(330 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(330 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(330 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(330 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(330 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(385 missing values generated)
    - g int matchround = .
(385 missing values generated)
    - g int psmatchid = .
(385 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 15 predicts failure perfectly;
      baselineedyrs omitted and 46 obs not used.

note: baselineage != 54 predicts failure perfectly;
      baselineage omitted and 7 obs not used.

outcome = baselinelogearn1 <= 9.88299 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 186+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,284  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,184 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(17 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(184 real changes made)
    - drop if baselinerestrictions==0
(885 observations deleted)
    - drop baselinerestrictions
    - count
  215
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(23 real changes made)
    - drop if sep==9
(27 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(161 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(162 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(162 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(162 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(162 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(162 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(189 missing values generated)
    - g int matchround = .
(189 missing values generated)
    - g int psmatchid = .
(189 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 187+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,870  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,961 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(25 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(420 real changes made)
    - drop if baselinerestrictions==0
(1,418 observations deleted)
    - drop baselinerestrictions
    - count
  491
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(42 real changes made)
    - drop if sep==9
(49 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(378 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(384 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(384 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(384 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(448 missing values generated)
    - g int matchround = .
(448 missing values generated)
    - g int psmatchid = .
(448 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         64
                                                  LR chi2(6)      =       8.35
                                                  Prob > chi2     =     0.2133
Log likelihood = -4.7231272                       Pseudo R2       =     0.4693

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -8.234871   5.984766    -1.38   0.169     -19.9648    3.495055
baselinelo~2 |  -6.730237   5.301524    -1.27   0.204    -17.12103    3.660558
 baselineage |  -3.664808   3.435963    -1.07   0.286    -10.39917    3.069555
baselineed~s |   1.249676   .8970902     1.39   0.164    -.5085887     3.00794
baselinete~e |   3.854569    3.31991     1.16   0.246    -2.652336    10.36147
baselinefi~e |  -.0000867   .0017486    -0.05   0.960    -.0035139    .0033406
       _cons |   213.7015          .        .       .            .           .
------------------------------------------------------------------------------
Note: 37 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 188 if _treated==0 | _treated==1
(64 real changes made)
    - replace psmatchid = _id if _treated==0
(62 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(384 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(24 real changes made)
    - replace weight1 = 0 if weight1==.
(420 real changes made)
    - keep if weight1==1
(420 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(14 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched188
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000035
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000035 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 188+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,620  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,353 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(19 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(233 real changes made)
    - drop if baselinerestrictions==0
(995 observations deleted)
    - drop baselinerestrictions
    - count
  272
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(47 real changes made)
    - drop if sep==9
(55 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(186 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(186 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(186 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(186 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(186 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(186 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(186 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(186 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(186 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(186 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(217 missing values generated)
    - g int matchround = .
(217 missing values generated)
    - g int psmatchid = .
(217 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 189+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,882  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(2,512 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(30 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(518 real changes made)
    - drop if baselinerestrictions==0
(1,765 observations deleted)
    - drop baselinerestrictions
    - count
  605
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - drop if sep==9
(35 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(488 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(492 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(492 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(492 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(492 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(492 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(492 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(492 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(492 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(492 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(574 missing values generated)
    - g int matchround = .
(574 missing values generated)
    - g int psmatchid = .
(574 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselinetenure != 3 predicts failure perfectly;
      baselinetenure omitted and 60 obs not used.


Probit regression                                 Number of obs   =         22
                                                  LR chi2(5)      =      13.40
                                                  Prob > chi2     =     0.0199
Log likelihood =          0                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   -19.0299          .        .       .            .           .
baselinelo~2 |   199.3099          .        .       .            .           .
 baselineage |   9.424906          .        .       .            .           .
baselineed~s |  -27.62612          .        .       .            .           .
baselinefi~e |  -.0236655          .        .       .            .           .
       _cons |  -1854.718          .        .       .            .           .
------------------------------------------------------------------------------
Note: 20 failures and 2 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 190 if _treated==0 | _treated==1
(22 real changes made)
    - replace psmatchid = _id if _treated==0
(20 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(120 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(574 real changes made)
    - keep if weight1==1
(574 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched190
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000036
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000036 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 190+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,207  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,607 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(434 real changes made)
    - drop if baselinerestrictions==0
(1,093 observations deleted)
    - drop baselinerestrictions
    - count
  507
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(41 real changes made)
    - drop if sep==9
(48 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(393 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(396 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(396 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(396 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(396 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(396 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(396 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(396 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(396 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(396 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(462 missing values generated)
    - g int matchround = .
(462 missing values generated)
    - g int psmatchid = .
(462 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         66
                                                  LR chi2(6)      =      17.92
                                                  Prob > chi2     =     0.0064
Log likelihood = -1.073e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -34.97488          .        .       .            .           .
baselinelo~2 |  -2.105181          .        .       .            .           .
 baselineage |   4.403069          .        .       .            .           .
baselineed~s |   3.068545          .        .       .            .           .
baselinete~e |   -.781907          .        .       .            .           .
baselinefi~e |  -.0053482   14.74847    -0.00   1.000    -28.91181    28.90112
       _cons |   84.70321          .        .       .            .           .
------------------------------------------------------------------------------
Note: 63 failures and 2 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 191 if _treated==0 | _treated==1
(66 real changes made)
    - replace psmatchid = _id if _treated==0
(64 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(384 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(462 real changes made)
    - keep if weight1==1
(462 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched191
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000037
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000037 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 191+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,182  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(3,192 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(50 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(442 real changes made)
    - drop if baselinerestrictions==0
(2,474 observations deleted)
    - drop baselinerestrictions
    - count
  516
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(10 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(60 real changes made)
    - drop if sep==9
(70 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(382 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(384 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(384 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(384 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(448 missing values generated)
    - g int matchround = .
(448 missing values generated)
    - g int psmatchid = .
(448 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         64
                                                  LR chi2(6)      =      13.66
                                                  Prob > chi2     =     0.0336
Log likelihood = -5.2774149                       Pseudo R2       =     0.5642

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   4.314235   5.352611     0.81   0.420    -6.176689    14.80516
baselinelo~2 |   1.159168   5.374663     0.22   0.829    -9.374977    11.69331
 baselineage |   .0140102   .1056925     0.13   0.895    -.1931434    .2211637
baselineed~s |   .8753646   .8130061     1.08   0.282    -.7180981    2.468827
baselinete~e |  -.4252615   .3151621    -1.35   0.177    -1.042968    .1924448
baselinefi~e |  -.0031503   .0032292    -0.98   0.329    -.0094795    .0031789
       _cons |  -63.76265   70.84094    -0.90   0.368    -202.6083    75.08303
------------------------------------------------------------------------------
Note: 31 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 192 if _treated==0 | _treated==1
(64 real changes made)
    - replace psmatchid = _id if _treated==0
(61 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(384 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(406 real changes made)
    - keep if weight1==1
(406 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(21 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched192
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000038
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000038 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 192+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,283  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(2,218 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(29 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(368 real changes made)
    - drop if baselinerestrictions==0
(1,635 observations deleted)
    - drop baselinerestrictions
    - count
  430
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(12 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(47 real changes made)
    - drop if sep==9
(55 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(321 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(324 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(324 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(324 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(324 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(324 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(324 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(324 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(324 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(324 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(378 missing values generated)
    - g int matchround = .
(378 missing values generated)
    - g int psmatchid = .
(378 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         54
                                                  LR chi2(6)      =       9.39
                                                  Prob > chi2     =     0.1528
Log likelihood = -3.8586992                       Pseudo R2       =     0.5489

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   124.8692   320.0312     0.39   0.696    -502.3804    752.1188
baselinelo~2 |   19.75643   42.71707     0.46   0.644    -63.96748    103.4803
 baselineage |  -1.295304    3.42011    -0.38   0.705    -7.998595    5.407988
baselineed~s |  -15.87303   39.72345    -0.40   0.689    -93.72955     61.9835
baselinete~e |  -1.433279   3.428721    -0.42   0.676    -8.153448     5.28689
baselinefi~e |   -.058412   .1344261    -0.43   0.664    -.3218823    .2050583
       _cons |  -1112.782   2766.449    -0.40   0.688    -6534.922    4309.358
------------------------------------------------------------------------------
Note: 46 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 193 if _treated==0 | _treated==1
(54 real changes made)
    - replace psmatchid = _id if _treated==0
(52 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(318 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(12 real changes made)
    - replace weight1 = 0 if weight1==.
(364 real changes made)
    - keep if weight1==1
(364 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(7 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched193
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000039
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000039 saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 193+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,283  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(3,187 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(39 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(585 real changes made)
    - drop if baselinerestrictions==0
(2,412 observations deleted)
    - drop baselinerestrictions
    - count
  684
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(19 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(111 real changes made)
    - drop if sep==9
(130 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(474 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(480 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(480 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(480 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(480 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(480 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(560 missing values generated)
    - g int matchround = .
(560 missing values generated)
    - g int psmatchid = .
(560 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         80
                                                  LR chi2(6)      =       5.33
                                                  Prob > chi2     =     0.5024
Log likelihood = -10.128749                       Pseudo R2       =     0.2083

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -4.540871   3.799225    -1.20   0.232    -11.98722    2.905473
baselinelo~2 |   3.457601   2.502385     1.38   0.167    -1.446984    8.362185
 baselineage |   .0597513   .0741306     0.81   0.420    -.0855419    .2050446
baselineed~s |   .0443554   .3776243     0.12   0.906    -.6957747    .7844854
baselinete~e |  -.0537044   .1115395    -0.48   0.630    -.2723178    .1649089
baselinefi~e |  -.0003659   .0007867    -0.47   0.642    -.0019077    .0011759
       _cons |   5.678425   32.24766     0.18   0.860    -57.52583    68.88268
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(6 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 194 if _treated==0 | _treated==1
(80 real changes made)
    - replace psmatchid = _id if _treated==0
(77 real changes made)
    - replace psmatchid = _n1 if _treated==1
(3 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(480 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(36 real changes made)
    - replace weight1 = 0 if weight1==.
(518 real changes made)
    - keep if weight1==1
(518 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(21 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched194
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003a
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003a saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 194+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,025  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(2,051 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(14 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(405 real changes made)
    - drop if baselinerestrictions==0
(1,500 observations deleted)
    - drop baselinerestrictions
    - count
  474
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(11 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(30 real changes made)
    - drop if sep==9
(35 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(375 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(9 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(9 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(9 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(9 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(384 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(384 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(384 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(384 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(384 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(448 missing values generated)
    - g int matchround = .
(448 missing values generated)
    - g int psmatchid = .
(448 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         64
                                                  LR chi2(6)      =       3.35
                                                  Prob > chi2     =     0.7640
Log likelihood = -7.2257902                       Pseudo R2       =     0.1881

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   4.446118   3.431529     1.30   0.195    -2.279555    11.17179
baselinelo~2 |   1.624182   3.862649     0.42   0.674    -5.946471    9.194835
 baselineage |  -.1304579   .1390771    -0.94   0.348    -.4030441    .1421282
baselineed~s |  -.7722347   .6273689    -1.23   0.218    -2.001855    .4573857
baselinete~e |   .0913498   .1991581     0.46   0.646    -.2989929    .4816924
baselinefi~e |   .0001695   .0007073     0.24   0.811    -.0012167    .0015556
       _cons |  -45.10465   42.95361    -1.05   0.294    -129.2922    39.08288
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 195 if _treated==0 | _treated==1
(64 real changes made)
    - replace psmatchid = _id if _treated==0
(62 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(384 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(24 real changes made)
    - replace weight1 = 0 if weight1==.
(420 real changes made)
    - keep if weight1==1
(420 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(14 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched195
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003b
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003b saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 195+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,859  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,983 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(25 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(269 real changes made)
    - drop if baselinerestrictions==0
(1,562 observations deleted)
    - drop baselinerestrictions
    - count
  314
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(6 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(3 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(18 real changes made)
    - drop if sep==9
(21 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(251 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(252 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(252 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(252 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(252 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(252 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(294 missing values generated)
    - g int matchround = .
(294 missing values generated)
    - g int psmatchid = .
(294 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineage != 55 predicts failure perfectly;
      baselineage omitted and 40 obs not used.

outcome = baselinelogearn1 <= 9.273847 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 196+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000032 if time==2003 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,426  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,1999,2014)
(1,250 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(239 real changes made)
    - drop if baselinerestrictions==0
(897 observations deleted)
    - drop baselinerestrictions
    - count
  279
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(24 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(1 real change made)
    - bys persid (sep): replace sep = sep[_N]
(6 real changes made)
    - drop if sep==9
(7 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(233 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2003
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(234 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(234 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(234 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(234 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(234 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(234 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(234 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 1999 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(234 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(234 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(273 missing values generated)
    - g int matchround = .
(273 missing values generated)
    - g int psmatchid = .
(273 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         39
                                                  LR chi2(6)      =       5.36
                                                  Prob > chi2     =     0.4987
Log likelihood = -10.217268                       Pseudo R2       =     0.2078

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -1.906423   3.095226    -0.62   0.538    -7.972955    4.160109
baselinelo~2 |     4.0095   3.097622     1.29   0.196    -2.061727    10.08073
 baselineage |   .0171283   .0656961     0.26   0.794    -.1116337    .1458903
baselineed~s |   -.272381   .3459174    -0.79   0.431    -.9503666    .4056045
baselinete~e |   .0435133   .1070114     0.41   0.684    -.1662251    .2532518
baselinefi~e |  -.0011694   .0010633    -1.10   0.271    -.0032535    .0009147
       _cons |  -18.37118   26.97861    -0.68   0.496    -71.24829    34.50593
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 197 if _treated==0 | _treated==1
(39 real changes made)
    - replace psmatchid = _id if _treated==0
(35 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(222 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(24 real changes made)
    - replace weight1 = 0 if weight1==.
(245 real changes made)
    - keep if weight1==1
(245 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2003 - 1
    - g timesincemov = timesince if sep
(14 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2003
    - tempfile matched`matchround'
    = tempfile matched197
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003c
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003c saved as .dta format
    - }
    - }
    - }
    - use persid time displaced `cell_vars' using `in' if time==`t', clear
    = use persid time displaced industry female using ../data/person_year_data.dta if time==2004, clear
    - egen cellID = group(`cell_vars')
    = egen cellID = group(industry female)
(181 missing values generated)
    - tempfile cells`t'
    = tempfile cells2004
    - save `cells`t''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d saved as .dta format
    - levelsof cellID , local(cellIDs)
1 2 3 4 5 6 7 8 9 10 11 12 13 14
    - foreach cell in `cellIDs' {
    = foreach cell in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 {
    - local matchround = `matchround'+1
    = local matchround = 197+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==1 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,610  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(2,654 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(386 real changes made)
    - drop if baselinerestrictions==0
(1,492 observations deleted)
    - drop baselinerestrictions
    - count
  464
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(7 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(35 real changes made)
    - drop if sep==9
(42 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(351 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(355 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(355 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(355 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(355 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(355 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(355 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(355 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(355 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(355 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(426 missing values generated)
    - g int matchround = .
(426 missing values generated)
    - g int psmatchid = .
(426 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         71
                                                  LR chi2(6)      =      18.22
                                                  Prob > chi2     =     0.0057
Log likelihood = -7.217e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -153.9707   9246.039    -0.02   0.987    -18275.87    17967.93
baselinelo~2 |  -43.26537   9409.493    -0.00   0.996    -18485.53       18399
 baselineage |   .9653496   441.4695     0.00   0.998    -864.2989    866.2296
baselineed~s |   7.929472    1607.94     0.00   0.996    -3143.575    3159.434
baselinete~e |   2.217521          .        .       .            .           .
baselinefi~e |   .0599275   17.81874     0.00   0.997    -34.86417    34.98403
       _cons |   1602.151          .        .       .            .           .
------------------------------------------------------------------------------
Note: 66 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 198 if _treated==0 | _treated==1
(71 real changes made)
    - replace psmatchid = _id if _treated==0
(69 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(345 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(426 real changes made)
    - keep if weight1==1
(426 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched198
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003e
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003e saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 198+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==2 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,919  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(1,642 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(11 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(269 real changes made)
    - drop if baselinerestrictions==0
(954 observations deleted)
    - drop baselinerestrictions
    - count
  323
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(2 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - drop if sep==9
(12 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(259 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(260 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(260 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(260 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(260 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(260 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(260 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(260 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(260 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(260 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(312 missing values generated)
    - g int matchround = .
(312 missing values generated)
    - g int psmatchid = .
(312 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 15 predicts failure perfectly;
      baselineedyrs omitted and 45 obs not used.

outcome = baselineage <= 31 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 199+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==3 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,156  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(1,796 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(15 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(292 real changes made)
    - drop if baselinerestrictions==0
(1,009 observations deleted)
    - drop baselinerestrictions
    - count
  351
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(2 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - drop if sep==9
(12 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(282 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(285 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(285 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(285 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(285 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(285 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(285 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(285 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(285 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(285 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(342 missing values generated)
    - g int matchround = .
(342 missing values generated)
    - g int psmatchid = .
(342 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         57
                                                  LR chi2(6)      =      17.33
                                                  Prob > chi2     =     0.0081
Log likelihood = -7.812e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -66.57239          .        .       .            .           .
baselinelo~2 |   3.408884          .        .       .            .           .
 baselineage |  -2.357212   534.4218    -0.00   0.996    -1049.805     1045.09
baselineed~s |   8.169669   3455.609     0.00   0.998      -6764.7    6781.039
baselinete~e |   1.410052   1416.477     0.00   0.999    -2774.834    2777.654
baselinefi~e |  -.0407213   243.2712    -0.00   1.000    -476.8435    476.7621
       _cons |   558.5735          .        .       .            .           .
------------------------------------------------------------------------------
Note: 52 failures and 1 success completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 200 if _treated==0 | _treated==1
(57 real changes made)
    - replace psmatchid = _id if _treated==0
(55 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(275 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(342 real changes made)
    - keep if weight1==1
(342 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched200
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003f
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003f saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 200+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==4 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,282  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(1,328 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(12 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(130 real changes made)
    - drop if baselinerestrictions==0
(798 observations deleted)
    - drop baselinerestrictions
    - count
  156
    - if r(N)==0 continue
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(2 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - drop if sep==9
(12 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(120 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(0 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(0 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(0 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(0 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(120 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(120 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(120 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(120 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(120 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(120 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(120 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(120 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(120 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(144 missing values generated)
    - g int matchround = .
(144 missing values generated)
    - g int psmatchid = .
(144 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 201+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==5 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,630  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(2,045 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(13 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(341 real changes made)
    - drop if baselinerestrictions==0
(1,175 observations deleted)
    - drop baselinerestrictions
    - count
  410
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(5 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(25 real changes made)
    - drop if sep==9
(30 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(316 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(4 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(4 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(4 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(4 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(320 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(320 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(320 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(320 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(320 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(320 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(320 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(320 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(320 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(384 missing values generated)
    - g int matchround = .
(384 missing values generated)
    - g int psmatchid = .
(384 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         64
                                                  LR chi2(6)      =       4.13
                                                  Prob > chi2     =     0.6591
Log likelihood = -3.0860662                       Pseudo R2       =     0.4009

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   6.648562   7.921728     0.84   0.401    -8.877739    22.17486
baselinelo~2 |  -1.468093   4.606595    -0.32   0.750    -10.49685    7.560667
 baselineage |  -1.297577   2.661246    -0.49   0.626    -6.513524     3.91837
baselineed~s |  -.7189466   1.251229    -0.57   0.566     -3.17131    1.733417
baselinete~e |   1.035567   2.669481     0.39   0.698    -4.196518    6.267653
baselinefi~e |   .0017837   .0033916     0.53   0.599    -.0048637    .0084312
       _cons |  -9.529179          .        .       .            .           .
------------------------------------------------------------------------------
Note: 36 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 202 if _treated==0 | _treated==1
(64 real changes made)
    - replace psmatchid = _id if _treated==0
(63 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(320 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(10 real changes made)
    - replace weight1 = 0 if weight1==.
(372 real changes made)
    - keep if weight1==1
(372 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
(6 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched202
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003g
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003g saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 202+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==6 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,329  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(1,341 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(13 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(177 real changes made)
    - drop if baselinerestrictions==0
(775 observations deleted)
    - drop baselinerestrictions
    - count
  213
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(5 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(23 real changes made)
    - drop if sep==9
(28 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(154 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(1 real change made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(1 real change made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(1 real change made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(1 real change made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(155 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(155 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(155 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(155 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(155 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(155 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(155 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(155 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(155 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(186 missing values generated)
    - g int matchround = .
(186 missing values generated)
    - g int psmatchid = .
(186 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         31
                                                  LR chi2(6)      =       3.20
                                                  Prob > chi2     =     0.7829
Log likelihood = -2.8160531                       Pseudo R2       =     0.3625

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -.5727073    7.32768    -0.08   0.938     -14.9347    13.78928
baselinelo~2 |   2.824586    8.73543     0.32   0.746    -14.29654    19.94571
 baselineage |   .0759417    .183461     0.41   0.679    -.2836353    .4355186
baselineed~s |   -.400567   .8887652    -0.45   0.652    -2.142515    1.341381
baselinete~e |  -.4037848   .5496772    -0.73   0.463    -1.481132    .6735627
baselinefi~e |  -.0050294   .0083259    -0.60   0.546    -.0213479     .011289
       _cons |  -18.02039   67.39286    -0.27   0.789     -150.108    114.0672
------------------------------------------------------------------------------
Note: 5 failures and 0 successes completely determined.
    - replace weight1 = 1 if _weight==1
(2 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 203 if _treated==0 | _treated==1
(31 real changes made)
    - replace psmatchid = _id if _treated==0
(30 real changes made)
    - replace psmatchid = _n1 if _treated==1
(1 real change made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(155 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(10 real changes made)
    - replace weight1 = 0 if weight1==.
(174 real changes made)
    - keep if weight1==1
(174 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
(6 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched203
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003h
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003h saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 203+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==7 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,715  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(2,694 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(16 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(429 real changes made)
    - drop if baselinerestrictions==0
(1,505 observations deleted)
    - drop baselinerestrictions
    - count
  516
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(5 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(59 real changes made)
    - drop if sep==9
(71 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(370 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(5 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(5 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(5 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(5 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(375 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(375 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(375 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(375 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(375 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(375 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(375 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(375 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(375 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(450 missing values generated)
    - g int matchround = .
(450 missing values generated)
    - g int psmatchid = .
(450 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         75
                                                  LR chi2(6)      =      10.62
                                                  Prob > chi2     =     0.1008
Log likelihood = -8.194e-09                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -139.6063   6905.426    -0.02   0.984    -13673.99    13394.78
baselinelo~2 |   56.77618          .        .       .            .           .
 baselineage |   1.784066   1932.392     0.00   0.999    -3785.635    3789.203
baselineed~s |   4.687211          .        .       .            .           .
baselinete~e |   4.324884   1125.872     0.00   0.997    -2202.343    2210.993
baselinefi~e |   .0146355   10.77496     0.00   0.999    -21.10391    21.13318
       _cons |   564.6854          .        .       .            .           .
------------------------------------------------------------------------------
Note: 71 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 204 if _treated==0 | _treated==1
(75 real changes made)
    - replace psmatchid = _id if _treated==0
(74 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(370 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(450 real changes made)
    - keep if weight1==1
(450 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched204
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003i
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003i saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 204+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==8 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,918  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(1,637 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(10 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(327 real changes made)
    - drop if baselinerestrictions==0
(888 observations deleted)
    - drop baselinerestrictions
    - count
  393
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(0 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(8 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(40 real changes made)
    - drop if sep==9
(48 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(287 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(290 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(290 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(290 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(290 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(290 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(290 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(290 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(290 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(290 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(348 missing values generated)
    - g int matchround = .
(348 missing values generated)
    - g int psmatchid = .
(348 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
outcome does not vary; remember:
                                  0 = negative outcome,
        all other nonmissing values = positive outcome
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 205+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==9 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,090  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(3,527 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(43 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(364 real changes made)
    - drop if baselinerestrictions==0
(2,125 observations deleted)
    - drop baselinerestrictions
    - count
  438
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(10 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(5 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(25 real changes made)
    - drop if sep==9
(30 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(339 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(345 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(345 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(345 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(345 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(345 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(345 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(345 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(345 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(345 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(414 missing values generated)
    - g int matchround = .
(414 missing values generated)
    - g int psmatchid = .
(414 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         69
                                                  LR chi2(6)      =       5.86
                                                  Prob > chi2     =     0.4393
Log likelihood = -6.1238491                       Pseudo R2       =     0.3235

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   1.221982   2.921182     0.42   0.676     -4.50343    6.947394
baselinelo~2 |    2.88157   3.762961     0.77   0.444    -4.493699    10.25684
 baselineage |   .0100379   .1144221     0.09   0.930    -.2142253     .234301
baselineed~s |  -.3020569   .4952417    -0.61   0.542    -1.272713    .6685991
baselinete~e |   .1890985   .1691961     1.12   0.264    -.1425198    .5207168
baselinefi~e |  -.0017174   .0026231    -0.65   0.513    -.0068585    .0034237
       _cons |  -39.21094    41.4619    -0.95   0.344    -120.4748    42.05288
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(4 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 206 if _treated==0 | _treated==1
(69 real changes made)
    - replace psmatchid = _id if _treated==0
(67 real changes made)
    - replace psmatchid = _n1 if _treated==1
(2 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(345 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(20 real changes made)
    - replace weight1 = 0 if weight1==.
(390 real changes made)
    - keep if weight1==1
(390 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
(12 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched206
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003j
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003j saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 206+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==10 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,216  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(2,453 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(15 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(301 real changes made)
    - drop if baselinerestrictions==0
(1,401 observations deleted)
    - drop baselinerestrictions
    - count
  362
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(5 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(14 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(69 real changes made)
    - drop if sep==9
(83 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(232 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(3 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(3 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(3 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(3 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(235 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(235 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(235 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(235 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(235 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(235 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(235 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(235 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(235 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(282 missing values generated)
    - g int matchround = .
(282 missing values generated)
    - g int psmatchid = .
(282 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common
note: baselineedyrs != 15 predicts failure perfectly;
      baselineedyrs omitted and 37 obs not used.

outcome = baselineage > 52 predicts data perfectly
      replace weight1 = 1 if _weight==1
      drop _weight
      replace matchround = `matchround' if _treated==0 | _treated==1
      replace psmatchid = _id if _treated==0
      replace psmatchid = _n1 if _treated==1
      bys persid (psmatchid): replace psmatchid = psmatchid[1]
      bys persid (weight1): replace weight1 = weight1[1]
      replace weight1 = 0 if weight1==.
      keep if weight1==1
      g timesince = time - `t' - 1
      g timesincemov = timesince if sep
      sort persid time
      g baselinetime = `t'
      tempfile matched`matchround'
      save `matched`matchround''
      }
    - }
    - local matchround = `matchround'+1
    = local matchround = 207+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==11 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             6,131  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(3,478 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(31 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(456 real changes made)
    - drop if baselinerestrictions==0
(2,104 observations deleted)
    - drop baselinerestrictions
    - count
  549
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(12 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(59 real changes made)
    - drop if sep==9
(71 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(397 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(8 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(8 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(8 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(8 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(405 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(405 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(405 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(405 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(405 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(405 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(405 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(405 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(405 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(486 missing values generated)
    - g int matchround = .
(486 missing values generated)
    - g int psmatchid = .
(486 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         81
                                                  LR chi2(6)      =       4.67
                                                  Prob > chi2     =     0.5870
Log likelihood = -13.598142                       Pseudo R2       =     0.1465

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -2.340848   1.637282    -1.43   0.153    -5.549861    .8681653
baselinelo~2 |  -1.252007   1.964532    -0.64   0.524     -5.10242    2.598405
 baselineage |   .0233641   .0592471     0.39   0.693    -.0927581    .1394863
baselineed~s |   .2963205    .290938     1.02   0.308    -.2739075    .8665485
baselinete~e |   .0182695   .0959596     0.19   0.849    -.1698078    .2063469
baselinefi~e |  -.0009173   .0009582    -0.96   0.338    -.0027953    .0009607
       _cons |   28.12701   20.38685     1.38   0.168    -11.83048     68.0845
------------------------------------------------------------------------------
    - replace weight1 = 1 if _weight==1
(8 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 208 if _treated==0 | _treated==1
(81 real changes made)
    - replace psmatchid = _id if _treated==0
(77 real changes made)
    - replace psmatchid = _n1 if _treated==1
(4 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(405 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(40 real changes made)
    - replace weight1 = 0 if weight1==.
(438 real changes made)
    - keep if weight1==1
(438 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
(24 missing values generated)
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched208
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003k
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003k saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 208+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==12 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             4,072  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(2,307 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(13 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(319 real changes made)
    - drop if baselinerestrictions==0
(1,381 observations deleted)
    - drop baselinerestrictions
    - count
  384
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(9 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - drop if sep==9
(24 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(299 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(6 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(6 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(6 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(6 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(305 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(305 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(305 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(305 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(305 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(305 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(305 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(305 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(305 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(366 missing values generated)
    - g int matchround = .
(366 missing values generated)
    - g int psmatchid = .
(366 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         61
                                                  LR chi2(6)      =      17.60
                                                  Prob > chi2     =     0.0073
Log likelihood = -2.095e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |  -44.88854   4135.288    -0.01   0.991    -8149.905    8060.128
baselinelo~2 |  -54.54032          .        .       .            .           .
 baselineage |   1.829582   520.3308     0.00   0.997        -1018    1021.659
baselineed~s |   14.89273   2030.011     0.01   0.994    -3963.856    3993.641
baselinete~e |  -2.068176   783.3294    -0.00   0.998    -1537.366    1533.229
baselinefi~e |   .0136707   6.373162     0.00   0.998     -12.4775    12.50484
       _cons |   649.0653          .        .       .            .           .
------------------------------------------------------------------------------
Note: 55 failures and 1 success completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 209 if _treated==0 | _treated==1
(61 real changes made)
    - replace psmatchid = _id if _treated==0
(59 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(295 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(366 real changes made)
    - keep if weight1==1
(366 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched209
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003l
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003l saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 209+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==13 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             3,778  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(2,173 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(20 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(253 real changes made)
    - drop if baselinerestrictions==0
(1,300 observations deleted)
    - drop baselinerestrictions
    - count
  305
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(9 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - drop if sep==9
(24 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(233 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(7 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(7 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(7 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(7 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(240 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(240 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(240 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(240 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(240 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(240 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(240 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(240 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(240 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(288 missing values generated)
    - g int matchround = .
(288 missing values generated)
    - g int psmatchid = .
(288 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         48
                                                  LR chi2(6)      =      16.63
                                                  Prob > chi2     =     0.0108
Log likelihood = -1.182e-08                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   302.7489   18192.32     0.02   0.987    -35353.54    35959.03
baselinelo~2 |   290.6212          .        .       .            .           .
 baselineage |  -3.792007   525.7706    -0.01   0.994    -1034.283    1026.699
baselineed~s |  -42.34128   9325.749    -0.00   0.996    -18320.47    18235.79
baselinete~e |  -11.80838   15546.74    -0.00   0.999    -30482.86    30459.24
baselinefi~e |  -.0708279   52.33824    -0.00   0.999    -102.6519    102.5102
       _cons |  -4955.711          .        .       .            .           .
------------------------------------------------------------------------------
Note: 43 failures and 0 successes completely determined.
There are observations with identical propensity score values.
The sort order of the data could affect your results.
Make sure that the sort order is random before calling psmatch2.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 210 if _treated==0 | _treated==1
(48 real changes made)
    - replace psmatchid = _id if _treated==0
(46 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(230 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(288 real changes made)
    - keep if weight1==1
(288 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched210
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003m
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003m saved as .dta format
    - }
    - }
    - local matchround = `matchround'+1
    = local matchround = 210+1
    - use persid time cellID using `cells`t'' if time==`t' & cellID==`cell' , clear
    = use persid time cellID using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003d if time==2004 & cellID==14 , clear
    - bys persid: keep if _n==1
(0 observations deleted)
    - keep persid
    - merge 1:m persid using `in' , keep(matched) nogen
    = merge 1:m persid using ../data/person_year_data.dta , keep(matched) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,452  
    -----------------------------------------
    - keep if inrange(time,`=`t'-`preperiods'+1',`=`t'+`postperiods'+1')
    = keep if inrange(time,2000,2015)
(1,414 observations deleted)
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - bys persid (time): replace displaced = displaced[_n-1] if _n>1 & displaced[_n]==0
(6 real changes made)
    - g byte displacement_event = l.displaced==0 & displaced==1
    - g byte mover = estabid != f.estabid & (!missing(estabid))
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - g byte baselinerestrictions = employed==1 & baselinetime_dummy==1 & firmsize>=50 & tenure>=3 & inrange(age,20,55) & l.displaced==0
    - replace baselinerestrictions = 0 if baselinerestrictions>=.
(0 real changes made)
    - bys persid (baselinerestrictions): replace baselinerestrictions = baselinerestrictions[_N]
(193 real changes made)
    - drop if baselinerestrictions==0
(806 observations deleted)
    - drop baselinerestrictions
    - count
  232
    - if r(N)==0 continue
    - tsset

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g byte sep = (baselinetime_dummy & (displacement_event==1))
    - bys persid (sep): replace sep = sep[_N]
(5 real changes made)
    - replace sep = 9 if baselinetime_dummy==1 & displacement_event==0 & mover==1
(4 real changes made)
    - bys persid (sep): replace sep = sep[_N]
(20 real changes made)
    - drop if sep==9
(24 observations deleted)
    - g uniform = uniform()
    - bys persid: replace uniform=uniform[1]
(173 real changes made)
    - drop baselinetime_dummy
    - tsset persid time

Panel variable: persid (unbalanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - tsfill
    - g byte noleavers = 1
    - tsfill, full
    - g byte baselinetime_dummy = time==`t'
    = g byte baselinetime_dummy = time==2004
    - foreach v in earn employed {
    - replace `v'=0 if `v'==.
    = replace earn=0 if earn==.
(2 real changes made)
    - }
    - replace `v'=0 if `v'==.
    = replace employed=0 if employed==.
(2 real changes made)
    - }
    - foreach v in sep byear edyrs female uniform {
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (sep): replace sep=sep[1] if sep==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (byear): replace byear=byear[1] if byear==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (edyrs): replace edyrs=edyrs[1] if edyrs==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (female): replace female=female[1] if female==.
(2 real changes made)
    - }
    - bys persid (`v'): replace `v'=`v'[1] if `v'==.
    = bys persid (uniform): replace uniform=uniform[1] if uniform==.
(2 real changes made)
    - }
    - foreach v in earn logearn age edyrs firmsize tenure {
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineearn = earn if baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineearn): replace baselineearn = baselineearn[1]
(175 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinelogearn = logearn if baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinelogearn): replace baselinelogearn = baselinelogearn[1]
(175 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineage = age if baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineage): replace baselineage = baselineage[1]
(175 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselineedyrs = edyrs if baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselineedyrs): replace baselineedyrs = baselineedyrs[1]
(175 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinefirmsize = firmsize if baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinefirmsize): replace baselinefirmsize = baselinefirmsize[1]
(175 real changes made)
    - }
    - g baseline`v' = `v' if baselinetime_dummy==1
    = g baselinetenure = tenure if baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'): replace baseline`v' = baseline`v'[1]
    = bys persid (baselinetenure): replace baselinetenure = baselinetenure[1]
(175 real changes made)
    - }
    - tsset persid time

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'1 = `v' if f1.baselinetime_dummy==1
    = g baselinelogearn1 = logearn if f1.baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'1): replace baseline`v'1 = baseline`v'1[1]
    = bys persid (baselinelogearn1): replace baselinelogearn1 = baselinelogearn1[1]
(175 real changes made)
    - }
    - foreach v in logearn {
    - tsset

Panel variable: persid (strongly balanced)
 Time variable: time, 2000 to 2005
         Delta: 1 unit
    - g baseline`v'2 = `v' if f2.baselinetime_dummy==1
    = g baselinelogearn2 = logearn if f2.baselinetime_dummy==1
(175 missing values generated)
    - bys persid (baseline`v'2): replace baseline`v'2 = baseline`v'2[1]
    = bys persid (baselinelogearn2): replace baselinelogearn2 = baselinelogearn2[1]
(175 real changes made)
    - }
    - local matchlist baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize
    - g byte weight1 = .
(210 missing values generated)
    - g int matchround = .
(210 missing values generated)
    - g int psmatchid = .
(210 missing values generated)
    - cap noi {
    - psmatch2 sep `matchlist' if baselinetime_dummy==1 , noreplacement common
    = psmatch2 sep baselinelogearn1 baselinelogearn2 baselineage baselineedyrs baselinetenure baselinefirmsize if baselinetime_dummy==1 , noreplacement common

Probit regression                                 Number of obs   =         35
                                                  LR chi2(6)      =       9.08
                                                  Prob > chi2     =     0.1690
Log likelihood = -9.984e-10                       Pseudo R2       =     1.0000

------------------------------------------------------------------------------
         sep | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
baselinelo~1 |   34.01922          .        .       .            .           .
baselinelo~2 |  -2.651667          .        .       .            .           .
 baselineage |   .2552931          .        .       .            .           .
baselineed~s |  -3.209443          .        .       .            .           .
baselinete~e |     .30411          .        .       .            .           .
baselinefi~e |  -.0127542   77.13011    -0.00   1.000     -151.185    151.1595
       _cons |  -276.6623          .        .       .            .           .
------------------------------------------------------------------------------
Note: 33 failures and 1 success completely determined.
    - replace weight1 = 1 if _weight==1
(0 real changes made)
    - drop _weight
    - replace matchround = `matchround' if _treated==0 | _treated==1
    = replace matchround = 211 if _treated==0 | _treated==1
(35 real changes made)
    - replace psmatchid = _id if _treated==0
(34 real changes made)
    - replace psmatchid = _n1 if _treated==1
(0 real changes made)
    - bys persid (psmatchid): replace psmatchid = psmatchid[1]
(170 real changes made)
    - bys persid (weight1): replace weight1 = weight1[1]
(0 real changes made)
    - replace weight1 = 0 if weight1==.
(210 real changes made)
    - keep if weight1==1
(210 observations deleted)
    - g timesince = time - `t' - 1
    = g timesince = time - 2004 - 1
    - g timesincemov = timesince if sep
    - sort persid time
    - g baselinetime = `t'
    = g baselinetime = 2004
    - tempfile matched`matchround'
    = tempfile matched211
    - save `matched`matchround''
    = save /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003n
(dataset contains 0 observations)
file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003n saved as .dta format
    - }
    - }
    - }
    - local j 1
    - forval m = 2/`matchround' {
    = forval m = 2/211 {
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use , clear
invalid file specification
      else append using `matched`m''
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 1==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000005, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000005
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000006, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000006
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000007, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000007
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000008, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000008
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000009, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000009
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000a, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000a
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000b, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000b
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000c, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000c
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000d, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000d
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000e, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000e
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000f, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000f
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000h, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000h
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000i, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000i
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000j, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000j
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000k, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000k
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000l, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000l
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000m, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000m
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000n, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000n
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000o, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000o
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000p, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000p
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000q, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000q
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000r, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000r
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000s, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000s
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000u, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000u
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000v, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000v
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000w, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000w
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000x, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00000x
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000010, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000010
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000011, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000011
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000012, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000012
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000013, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000013
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000014, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000014
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000015, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000015
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000016, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000016
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000018, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000018
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000019, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000019
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001a, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001a
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001b, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001b
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001c, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001c
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001d, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001d
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001e, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001e
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001f, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001f
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001g, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001g
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001h, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001h
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001j, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001j
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001k, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001k
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001l, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001l
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001m, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001m
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001n, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001n
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001o, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001o
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001p, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001p
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001q, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001q
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001r, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001r
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001s, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001s
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001t, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001t
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001w, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001w
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001x, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00001x
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000020, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000020
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000021, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000021
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000022, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000022
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000024, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000024
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000025, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000025
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000026, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000026
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000027, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000027
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000028, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000028
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000029, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000029
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002a, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002a
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002b, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002b
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002c, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002c
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002d, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002d
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002f, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002f
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002g, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002g
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002h, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002h
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002i, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002i
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002j, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002j
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002k, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002k
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002l, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002l
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002m, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002m
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002n, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002n
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002o, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002o
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002q, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002q
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002r, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002r
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002s, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002s
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002t, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002t
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002u, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002u
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002v, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002v
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002w, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002w
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002x, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00002x
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000030, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000030
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000031, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000031
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000033, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000033
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000034, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000034
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000035, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000035
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000036, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000036
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000037, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000037
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000038, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000038
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000039, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000039
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003a, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003a
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003b, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003b
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003c, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003c
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003e, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003e
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003f, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003f
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003g, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003g
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003h, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003h
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003i, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003i
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003j, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003j
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use , clear
    - else append using `matched`m''
    = else append using 
invalid file specification
      local j 2
      }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003k, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003k
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003l, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003l
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003m, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003m
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - cap noi {
    - if `j'==1 use `matched`m'', clear
    = if 2==1 use /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003n, clear
    - else append using `matched`m''
    = else append using /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.00003n
(label _support already defined)
(label _treated already defined)
(label industry already defined)
(label sep1 already defined)
    - local j 2
    - }
    - }
    - tab matchround

 matchround |      Freq.     Percent        Cum.
------------+-----------------------------------
         45 |          2        0.51        0.51
         46 |          6        1.52        2.03
         48 |          8        2.03        4.06
         49 |          8        2.03        6.09
         50 |          8        2.03        8.12
         51 |          4        1.02        9.14
         52 |          8        2.03       11.17
         54 |          8        2.03       13.20
         56 |          8        2.03       15.23
         58 |          2        0.51       15.74
         60 |          6        1.52       17.26
         61 |          4        1.02       18.27
         63 |          2        0.51       18.78
         66 |          6        1.52       20.30
         67 |          6        1.52       21.83
         68 |          4        1.02       22.84
         69 |          4        1.02       23.86
         70 |          4        1.02       24.87
         71 |          2        0.51       25.38
         72 |          8        2.03       27.41
         73 |          6        1.52       28.93
         75 |          6        1.52       30.46
         76 |          6        1.52       31.98
         77 |          8        2.03       34.01
         78 |          4        1.02       35.03
         79 |          4        1.02       36.04
         80 |          8        2.03       38.07
         81 |         10        2.54       40.61
         83 |          4        1.02       41.62
         86 |          6        1.52       43.15
         90 |          4        1.02       44.16
         92 |          2        0.51       44.67
         96 |          4        1.02       45.69
         99 |          8        2.03       47.72
        100 |          4        1.02       48.73
        101 |          4        1.02       49.75
        104 |          6        1.52       51.27
        106 |          6        1.52       52.79
        108 |          8        2.03       54.82
        111 |          4        1.02       55.84
        112 |          4        1.02       56.85
        142 |          6        1.52       58.38
        144 |          4        1.02       59.39
        145 |          2        0.51       59.90
        146 |          4        1.02       60.91
        147 |          4        1.02       61.93
        148 |          4        1.02       62.94
        151 |          4        1.02       63.96
        152 |          4        1.02       64.97
        156 |          6        1.52       66.50
        158 |         10        2.54       69.04
        160 |          6        1.52       70.56
        162 |         12        3.05       73.60
        164 |          4        1.02       74.62
        166 |          4        1.02       75.63
        168 |          8        2.03       77.66
        170 |          4        1.02       78.68
        171 |          4        1.02       79.70
        172 |          8        2.03       81.73
        174 |          2        0.51       82.23
        178 |          4        1.02       83.25
        180 |         14        3.55       86.80
        181 |          8        2.03       88.83
        185 |          2        0.51       89.34
        188 |          4        1.02       90.36
        192 |          6        1.52       91.88
        193 |          2        0.51       92.39
        194 |          6        1.52       93.91
        195 |          4        1.02       94.92
        197 |          4        1.02       95.94
        202 |          2        0.51       96.45
        203 |          2        0.51       96.95
        206 |          4        1.02       97.97
        208 |          8        2.03      100.00
------------+-----------------------------------
      Total |        394      100.00
    - rename psmatchid psmatchid_temp
    - egen psmatchid = group( matchround psmatchid_temp)
(4,324 missing values generated)
    - bys psmatchid timesince: g NumMatches = _N
    - tab NumMatches

 NumMatches |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        394        8.35        8.35
        100 |        100        2.12       10.47
        164 |        164        3.48       13.95
        188 |        188        3.98       17.93
        224 |        672       14.24       32.17
        256 |        256        5.43       37.60
        306 |        306        6.49       44.09
        334 |        334        7.08       51.17
        350 |        350        7.42       58.58
        378 |        378        8.01       66.60
        394 |      1,576       33.40      100.00
------------+-----------------------------------
      Total |      4,718      100.00
    - drop if psmatchid_temp>=.
(0 observations deleted)
    - drop psmatchid_temp
    - label define sep 0 "Non-displaced" 1 "displaced"
    - label values sep sep
    - save `out' , replace
    = save ../data/analysis_data.dta , replace
file ../data/analysis_data.dta saved
    - cellgraph logearn, by(timesince sep)
(32 missing values generated)
(32 real changes made)


    ---------------------------------------------------------------------------------------------------------------------------- end generate_treatment_control ---
  - descriptive_analysis, in(${data}analysis_data)
  = descriptive_analysis, in(../data/analysis_data)
    -------------------------------------------------------------------------------------------------------------------------------- begin descriptive_analysis ---
    - syntax, in(str)
    - use `in' , clear
    = use ../data/analysis_data , clear
    - local file ${log}descriptive_analysis.tex
    = local file ../log/descriptive_analysis.tex
    - latexlog `file': open
    = latexlog ../log/descriptive_analysis.tex: open
    - latexlog `file': title "Descriptives for Displacement Analysis Sample"
    = latexlog ../log/descriptive_analysis.tex: title "Descriptives for Displacement Analysis Sample"
    - latexlog `file': section "Summary Table"
    = latexlog ../log/descriptive_analysis.tex: section "Summary Table"
    - local vars byear age female edyrs earn logearn employed firmsize
    - g N = 1
    - label var N "Number of Observations"
    - collect clear
    - foreach column in All Non_Disp Disp {
    - if "`column'"=="All" local cond 1
    = if "All"=="All" local cond 1
    - if "`column'"=="Non_Disp" local cond sep==0
    = if "All"=="Non_Disp" local cond sep==0
    - if "`column'"=="Disp" local cond sep==1
    = if "All"=="Disp" local cond sep==1
    - egen N_estab = tag(estabid) if timesince==-1 & `cond'
    = egen N_estab = tag(estabid) if timesince==-1 & 1
    - table (var) if timesince==-1 , statistic(mean `vars') statistic(sd `vars') statistic(count N ) statistic(total N_estab) nformat(%9.1f) nototals name(`column'
> )
    = table (var) if timesince==-1 , statistic(mean byear age female edyrs earn logearn employed firmsize) statistic(sd byear age female edyrs earn logearn employe
> d firmsize) statistic(count N ) statistic(total N_estab) nformat(%9.1f) nototals name(All)

--------------------------------------------------------------------------------------------
                       |     Mean   Standard deviation   Number of nonmissing values   Total
-----------------------+--------------------------------------------------------------------
Birth Year             |   1956.7                  9.2                                      
Age                    |     41.0                  8.3                                      
Female                 |      0.3                  0.5                                      
Years of Schooling     |     11.6                  2.3                                      
Earnings               |  11943.3               3350.4                                      
Log Earnings           |      9.4                  0.3                                      
Employed               |      1.0                  0.0                                      
Firm size              |    512.3                454.8                                      
Number of Observations |                                                       394.0        
tag(estabid)           |                                                                91.0
--------------------------------------------------------------------------------------------
    - collect addtag group[`column']
    = collect addtag group[All]
(18 items changed in collection All)
    - drop N_estab
    - }
    - if "`column'"=="All" local cond 1
    = if "Non_Disp"=="All" local cond 1
    - if "`column'"=="Non_Disp" local cond sep==0
    = if "Non_Disp"=="Non_Disp" local cond sep==0
    - if "`column'"=="Disp" local cond sep==1
    = if "Non_Disp"=="Disp" local cond sep==1
    - egen N_estab = tag(estabid) if timesince==-1 & `cond'
    = egen N_estab = tag(estabid) if timesince==-1 & sep==0
    - table (var) if timesince==-1 , statistic(mean `vars') statistic(sd `vars') statistic(count N ) statistic(total N_estab) nformat(%9.1f) nototals name(`column'
> )
    = table (var) if timesince==-1 , statistic(mean byear age female edyrs earn logearn employed firmsize) statistic(sd byear age female edyrs earn logearn employe
> d firmsize) statistic(count N ) statistic(total N_estab) nformat(%9.1f) nototals name(Non_Disp)

--------------------------------------------------------------------------------------------
                       |     Mean   Standard deviation   Number of nonmissing values   Total
-----------------------+--------------------------------------------------------------------
Birth Year             |   1956.7                  9.2                                      
Age                    |     41.0                  8.3                                      
Female                 |      0.3                  0.5                                      
Years of Schooling     |     11.6                  2.3                                      
Earnings               |  11943.3               3350.4                                      
Log Earnings           |      9.4                  0.3                                      
Employed               |      1.0                  0.0                                      
Firm size              |    512.3                454.8                                      
Number of Observations |                                                       394.0        
tag(estabid)           |                                                                83.0
--------------------------------------------------------------------------------------------
    - collect addtag group[`column']
    = collect addtag group[Non_Disp]
(18 items changed in collection Non_Disp)
    - drop N_estab
    - }
    - if "`column'"=="All" local cond 1
    = if "Disp"=="All" local cond 1
    - if "`column'"=="Non_Disp" local cond sep==0
    = if "Disp"=="Non_Disp" local cond sep==0
    - if "`column'"=="Disp" local cond sep==1
    = if "Disp"=="Disp" local cond sep==1
    - egen N_estab = tag(estabid) if timesince==-1 & `cond'
    = egen N_estab = tag(estabid) if timesince==-1 & sep==1
    - table (var) if timesince==-1 , statistic(mean `vars') statistic(sd `vars') statistic(count N ) statistic(total N_estab) nformat(%9.1f) nototals name(`column'
> )
    = table (var) if timesince==-1 , statistic(mean byear age female edyrs earn logearn employed firmsize) statistic(sd byear age female edyrs earn logearn employe
> d firmsize) statistic(count N ) statistic(total N_estab) nformat(%9.1f) nototals name(Disp)

--------------------------------------------------------------------------------------------
                       |     Mean   Standard deviation   Number of nonmissing values   Total
-----------------------+--------------------------------------------------------------------
Birth Year             |   1956.7                  9.2                                      
Age                    |     41.0                  8.3                                      
Female                 |      0.3                  0.5                                      
Years of Schooling     |     11.6                  2.3                                      
Earnings               |  11943.3               3350.4                                      
Log Earnings           |      9.4                  0.3                                      
Employed               |      1.0                  0.0                                      
Firm size              |    512.3                454.8                                      
Number of Observations |                                                       394.0        
tag(estabid)           |                                                                86.0
--------------------------------------------------------------------------------------------
    - collect addtag group[`column']
    = collect addtag group[Disp]
(18 items changed in collection Disp)
    - drop N_estab
    - }
    - collect combine comb = All Non_Disp Disp
(current collection is comb)
    - collect style autolevels group All Non_Disp Disp
    - collect style header result[mean sd] title(hide) level(hide)
(dimension level(hide) not found)
(dimension title(hide) not found)
    - collect style header group, title(hide)
    - collect style header result, level(hide)
    - collect style cell result[sd], sformat("[%s]")
    - collect style cell result[count], nformat("%8.0gc")
    - collect style cell result[total], nformat("%8.0gc")
    - collect style cell result, halign(center)
    - collect style cell var[N], border(top)
    - collect label levels var N_estab "Number of Establishments", modify
    - collect label levels group All "All workers" Non_Disp "Non-Displaced" Disp "Displaced"
    - collect layout (var#result) (group)

Collection: comb
      Rows: var#result
   Columns: group
   Table 1: 18 x 3

-------------------------------------------------------------------
                         |  All workers   Non-Displaced   Displaced
-------------------------+-----------------------------------------
Birth Year               |     1956.7         1956.7        1956.7 
                         |     [9.2]          [9.2]         [9.2]  
Age                      |      41.0           41.0          41.0  
                         |     [8.3]          [8.3]         [8.3]  
Female                   |      0.3            0.3           0.3   
                         |     [0.5]          [0.5]         [0.5]  
Years of Schooling       |      11.6           11.6          11.6  
                         |     [2.3]          [2.3]         [2.3]  
Earnings                 |    11943.3        11943.3       11943.3 
                         |    [3350.4]       [3350.4]      [3350.4]
Log Earnings             |      9.4            9.4           9.4   
                         |     [0.3]          [0.3]         [0.3]  
Employed                 |      1.0            1.0           1.0   
                         |     [0.0]          [0.0]         [0.0]  
Firm size                |     512.3          512.3         512.3  
                         |    [454.8]        [454.8]       [454.8] 
-------------------------+-----------------------------------------
Number of Observations   |      394            394           394   
Number of Establishments |       91             83            86   
-------------------------------------------------------------------
    - collect preview

-------------------------------------------------------------------
                         |  All workers   Non-Displaced   Displaced
-------------------------+-----------------------------------------
Birth Year               |     1956.7         1956.7        1956.7 
                         |     [9.2]          [9.2]         [9.2]  
Age                      |      41.0           41.0          41.0  
                         |     [8.3]          [8.3]         [8.3]  
Female                   |      0.3            0.3           0.3   
                         |     [0.5]          [0.5]         [0.5]  
Years of Schooling       |      11.6           11.6          11.6  
                         |     [2.3]          [2.3]         [2.3]  
Earnings                 |    11943.3        11943.3       11943.3 
                         |    [3350.4]       [3350.4]      [3350.4]
Log Earnings             |      9.4            9.4           9.4   
                         |     [0.3]          [0.3]         [0.3]  
Employed                 |      1.0            1.0           1.0   
                         |     [0.0]          [0.0]         [0.0]  
Firm size                |     512.3          512.3         512.3  
                         |    [454.8]        [454.8]       [454.8] 
-------------------------+-----------------------------------------
Number of Observations   |      394            394           394   
Number of Establishments |       91             83            86   
-------------------------------------------------------------------
    - latexlog `file': collect export , booktabs novert three title(Summary Statistics by Displacement Status) notes(Average characteristics of individuals. Standa
> rd deviations in brackets.)
    = latexlog ../log/descriptive_analysis.tex: collect export , booktabs novert three title(Summary Statistics by Displacement Status) notes(Average characteristi
> cs of individuals. Standard deviations in brackets.)
, booktabs novert three title(Summary Statistics by Displacement Status) notes(Average characteristics of individuals. Standard deviations in brackets.)
(collection comb exported to file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001)
    - table (var) if timesince==-1, statistic(p10 `vars') statistic(p25 `vars') statistic(p50 `vars') statistic(p75 `vars') statistic(p90 `vars') statistic(mean `v
> ars') statistic(sd `vars') statistic(count `vars') nformat(%9.2f)
    = table (var) if timesince==-1, statistic(p10 byear age female edyrs earn logearn employed firmsize) statistic(p25 byear age female edyrs earn logearn employed
>  firmsize) statistic(p50 byear age female edyrs earn logearn employed firmsize) statistic(p75 byear age female edyrs earn logearn employed firmsize) statistic(p9
> 0 byear age female edyrs earn logearn employed firmsize) statistic(mean byear age female edyrs earn logearn employed firmsize) statistic(sd byear age female edyr
> s earn logearn employed firmsize) statistic(count byear age female edyrs earn logearn employed firmsize) nformat(%9.2f)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                   |  10th percentile   25th percentile   50th percentile   75th percentile   90th percentile       Mean   Standard deviation   Number of nonmissing values
-------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------
Birth Year         |          1943.00           1950.00           1956.00           1964.00           1970.00    1956.68                 9.20                        394.00
Age                |            30.00             34.00             40.00             48.00             53.00      41.04                 8.26                        394.00
Female             |             0.00              0.00              0.00              1.00              1.00       0.31                 0.46                        394.00
Years of Schooling |             8.00             10.00             12.00             14.00             15.00      11.63                 2.29                        394.00
Earnings           |          8087.93           9416.35          11417.13          14096.48          16701.68   11943.30              3350.41                        394.00
Log Earnings       |             9.00              9.15              9.34              9.55              9.72       9.35                 0.27                        394.00
Employed           |             1.00              1.00              1.00              1.00              1.00       1.00                 0.00                        394.00
Firm size          |           115.81            188.56            366.99            629.32           1099.06     512.35               454.78                        394.00
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    - collect label levels result p10 "10th pct", modify
    - collect label levels result p25 "25th pct", modify
    - collect label levels result p50 "50th pct", modify
    - collect label levels result p75 "75th pct", modify
    - collect label levels result p90 "90th pct", modify
    - collect label levels result mean "Mean", modify
    - collect label levels result sd "SD", modify
    - collect label levels result count "N", modify
    - collect style cell result[sd], sformat("[%s]")
    - collect style cell result[count], nformat("%8.0gc")
    - collect style cell result, halign(center)
    - collect style cell var[N], border(top)
(level N of dimension var not found)
    - collect preview

-------------------------------------------------------------------------------------------------------
                   |  10th pct   25th pct   50th pct   75th pct   90th pct     Mean         SD       N 
-------------------+-----------------------------------------------------------------------------------
Birth Year         |   1943.00    1950.00    1956.00    1964.00    1970.00    1956.68     [9.20]    394
Age                |    30.00      34.00      40.00      48.00      53.00      41.04      [8.26]    394
Female             |    0.00       0.00       0.00       1.00       1.00       0.31       [0.46]    394
Years of Schooling |    8.00       10.00      12.00      14.00      15.00      11.63      [2.29]    394
Earnings           |   8087.93    9416.35   11417.13   14096.48   16701.68   11943.30   [3350.41]   394
Log Earnings       |    9.00       9.15       9.34       9.55       9.72       9.35       [0.27]    394
Employed           |    1.00       1.00       1.00       1.00       1.00       1.00       [0.00]    394
Firm size          |   115.81     188.56     366.99     629.32     1099.06    512.35     [454.78]   394
-------------------------------------------------------------------------------------------------------
    - latexlog `file': collect export , booktabs novert three title(Summary Statistics with Percentiles)
    = latexlog ../log/descriptive_analysis.tex: collect export , booktabs novert three title(Summary Statistics with Percentiles)
, booktabs novert three title(Summary Statistics with Percentiles)
(collection Table exported to file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001)
    - table (industry) (sep) if timesince==-1, statistic(percent, across(industry)) nformat(%9.3f) totals(sep)

----------------------------------------------------
                        |             sep           
                        |  Non-displaced   displaced
------------------------+---------------------------
Industry                |                           
  Mining                |         13.706      13.706
  Construction          |         11.675      11.675
  Manufacturing         |         16.751      16.751
  Health                |         11.168      11.168
  Finance               |         17.766      17.766
  FCSL                  |         19.289      19.289
  Professional Services |          9.645       9.645
  Total                 |        100.000     100.000
----------------------------------------------------
    - collect style cell result, nformat("%8.1f")
    - collect style cell result, halign(center)
    - collect style cell var[N], border(top)
(dimension var not found)
    - collect label levels sep 0 "Non-displaced" 1 "Displaced", modify
    - collect style header sep, title(hide)
    - collect style header industry, title(hide)
    - collect preview

--------------------------------------------------
                      |  Non-displaced   Displaced
----------------------+---------------------------
        Mining        |       13.7          13.7  
     Construction     |       11.7          11.7  
    Manufacturing     |       16.8          16.8  
        Health        |       11.2          11.2  
       Finance        |       17.8          17.8  
         FCSL         |       19.3          19.3  
Professional Services |       9.6           9.6   
        Total         |      100.0         100.0  
--------------------------------------------------
    - latexlog `file': collect export , booktabs novert three title(Industry Distribution by Displacement Status)
    = latexlog ../log/descriptive_analysis.tex: collect export , booktabs novert three title(Industry Distribution by Displacement Status)
, booktabs novert three title(Industry Distribution by Displacement Status)
(collection Table exported to file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001)
    - table (industry) (year) if timesince==-1, nototals

----------------------------------------------------------------------------------------------
                        |                                  year                               
                        |  1993   1994   1995   1996   1997   2000   2001   2002   2003   2004
------------------------+---------------------------------------------------------------------
Industry                |                                                                     
  Mining                |     2      2     14      6      8      6      6      8      2       
  Construction          |     6     10      6                    6     10      8              
  Manufacturing         |    16      2     14      4      6      8      6      2      4      4
  Health                |    12             8      2      6      4     12                     
  Finance               |     8     12     18             8      4      4      4      8      4
  FCSL                  |     8      8      4      4      4      4      4     22     10      8
  Professional Services |     8      6             8      4             8             4       
----------------------------------------------------------------------------------------------
    - collect style header year, title(hide)
    - collect style header industry, title(hide)
    - latexlog `file': collect export , booktabs novert three title(Number of Workers by Industry and Year) notes(Each cell shows number of workers per cell)
    = latexlog ../log/descriptive_analysis.tex: collect export , booktabs novert three title(Number of Workers by Industry and Year) notes(Each cell shows number o
> f workers per cell)
, booktabs novert three title(Number of Workers by Industry and Year) notes(Each cell shows number of workers per cell)
(collection Table exported to file /var/folders/_9/2y5yv8z136xb0j5wc3rp_kr40000gp/T//S_73834.000001)
    - latexlog `file': section "Consistency Checks"
    = latexlog ../log/descriptive_analysis.tex: section "Consistency Checks"
    - cap mkdir ${log}Consistency/
    = cap mkdir ../log/Consistency/
    - cellgraph N , by(time) nonotes stat(sum)
    - latexlog `file': addfig, file(Consistency/counts_by_time.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Consistency/counts_by_time.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Consistency/
Filestub: counts_by_time
Fileend: pdf
Filename: counts_by_time.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Consistency/counts_by_time.pdf saved as PDF
    format
    - cellgraph earn , by(time) nonotes stat(mean)
    - latexlog `file': addfig, file(Consistency/earn_by_time.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Consistency/earn_by_time.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Consistency/
Filestub: earn_by_time
Fileend: pdf
Filename: earn_by_time.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Consistency/earn_by_time.pdf saved as PDF
    format
    - cellgraph logearn , by(time) nonotes stat(mean)
    - latexlog `file': addfig, file(Consistency/logearn_by_time.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Consistency/logearn_by_time.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Consistency/
Filestub: logearn_by_time
Fileend: pdf
Filename: logearn_by_time.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Consistency/logearn_by_time.pdf saved as PDF
    format
    - cellgraph logearn , by(time) nonotes stat(p10 p25 p50 p75 p90)
    - latexlog `file': addfig, file(Consistency/logearn_by_year_pct.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Consistency/logearn_by_year_pct.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Consistency/
Filestub: logearn_by_year_pct
Fileend: pdf
Filename: logearn_by_year_pct.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Consistency/logearn_by_year_pct.pdf saved as
    PDF format
    - cellgraph employed , by(time) nonotes
    - latexlog `file': addfig, file(Consistency/employed_by_time.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Consistency/employed_by_time.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Consistency/
Filestub: employed_by_time
Fileend: pdf
Filename: employed_by_time.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Consistency/employed_by_time.pdf saved as PDF
    format
    - cellgraph displaced , by(time) nonotes
    - latexlog `file': addfig, file(Consistency/displaced_by_time.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Consistency/displaced_by_time.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Consistency/
Filestub: displaced_by_time
Fileend: pdf
Filename: displaced_by_time.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Consistency/displaced_by_time.pdf saved as PDF
    format
    - latexlog `file': section "Treatment and Control around Displacement Event"
    = latexlog ../log/descriptive_analysis.tex: section "Treatment and Control around Displacement Event"
    - cap mkdir ${log}Disp_event_raw/
    = cap mkdir ../log/Disp_event_raw/
    - cellgraph N , by(timesince sep) nonotes stat(sum)
(32 missing values generated)
(32 real changes made)
noci
noci
    - latexlog `file': addfig, file(Disp_event_raw/counts_by_timesince.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Disp_event_raw/counts_by_timesince.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Disp_event_raw/
Filestub: counts_by_timesince
Fileend: pdf
Filename: counts_by_timesince.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Disp_event_raw/counts_by_timesince.pdf saved as
    PDF format
    - cellgraph earn , by(timesince sep) nonotes
(32 missing values generated)
(32 real changes made)


    - latexlog `file': addfig, file(Disp_event_raw/logearn_by_timesince.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Disp_event_raw/logearn_by_timesince.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Disp_event_raw/
Filestub: logearn_by_timesince
Fileend: pdf
Filename: logearn_by_timesince.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Disp_event_raw/logearn_by_timesince.pdf saved
    as PDF format
    - cellgraph logearn , by(timesince sep) nonotes
(32 missing values generated)
(32 real changes made)


    - latexlog `file': addfig, file(Disp_event_raw/earn_by_timesince.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Disp_event_raw/earn_by_timesince.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Disp_event_raw/
Filestub: earn_by_timesince
Fileend: pdf
Filename: earn_by_timesince.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Disp_event_raw/earn_by_timesince.pdf saved as
    PDF format
    - cellgraph employed , by(timesince sep) nonotes
(32 missing values generated)
(32 real changes made)


    - latexlog `file': addfig, file(Disp_event_raw/employed_by_timesince.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Disp_event_raw/employed_by_timesince.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Disp_event_raw/
Filestub: employed_by_timesince
Fileend: pdf
Filename: employed_by_timesince.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Disp_event_raw/employed_by_timesince.pdf saved
    as PDF format
    - cellgraph displaced , by(timesince sep) nonotes
(32 missing values generated)
(32 real changes made)


    - latexlog `file': addfig, file(Disp_event_raw/displaced_by_timesince.pdf) eol
    = latexlog ../log/descriptive_analysis.tex: addfig, file(Disp_event_raw/displaced_by_timesince.pdf) eol
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex

macros:
           r(filename) : "descriptive_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "descriptive_analysis"
               r(path) : "../log/"
../log/
Path: Disp_event_raw/
Filestub: displaced_by_timesince
Fileend: pdf
Filename: displaced_by_timesince.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Disp_event_raw/displaced_by_timesince.pdf saved
    as PDF format
    - latexlog `file': close
    = latexlog ../log/descriptive_analysis.tex: close
    - latexlog `file': pdf, view
    = latexlog ../log/descriptive_analysis.tex: pdf, view
Path: ../log/
Filestub: descriptive_analysis
Fileend: tex
Filename: descriptive_analysis.tex
/Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/log

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)
 \write18 enabled.
 Source specials enabled.
entering extended mode
(./descriptive_analysis.tex
LaTeX2e <2021-11-15> patch level 1
L3 programming layer <2022-02-24>
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/article.cls
Document Class: article 2021/10/04 v1.4n Standard LaTeX document class
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/size10.clo))
(/usr/local/texlive/2022/texmf-dist/tex/latex/geometry/geometry.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/keyval.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/ifvtex.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/iftex.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/booktabs/booktabs.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/longtable.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/pdflscape/pdflscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/lscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphics.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/trig.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/graphics.cfg)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-def/pdftex.def))))
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/rotating.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphicx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/ifthen.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/threeparttable/threeparttable.sty
) (/usr/local/texlive/2022/texmf-dist/tex/latex/caption/subcaption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption3.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/ltcaption.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/float/float.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/tabularx.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/array.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/xcolor/xcolor.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/color.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/colortbl/colortbl.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hyperref.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdftexcmds/pdftexcmds.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/infwarerr/infwarerr.sty))
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdfescape/pdfescape.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hycolor/hycolor.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/auxhook/auxhook.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/kvoptions/kvoptions.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/pd1enc.def)
(/usr/local/texlive/2022/texmf-dist/tex/generic/intcalc/intcalc.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/etexcmds/etexcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/puenc.def)
(/usr/local/texlive/2022/texmf-dist/tex/latex/url/url.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/bitset/bitset.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atbegshi-ltx.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hpdftex.def
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atveryend-ltx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty

(/usr/local/texlive/2022/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty
)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.def)
No file descriptive_analysis.aux.
*geometry* driver: auto-detecting
*geometry* detected driver: pdftex
*geometry* verbose mode - [ preamble ] result:
* driver: pdftex
* paper: letterpaper
* layout: <same size as paper>
* layoutoffset:(h,v)=(0.0pt,0.0pt)
* modes: 
* h-part:(L,W,R)=(71.13188pt, 451.01793pt, 92.14519pt)
* v-part:(T,H,B)=(71.13188pt, 628.44073pt, 95.39737pt)
* \paperwidth=614.295pt
* \paperheight=794.96999pt
* \textwidth=451.01793pt
* \textheight=628.44073pt
* \oddsidemargin=-1.1381pt
* \evensidemargin=-1.1381pt
* \topmargin=-38.1381pt
* \headheight=12.0pt
* \headsep=25.0pt
* \topskip=10.0pt
* \footskip=30.0pt
* \marginparwidth=65.0pt
* \marginparsep=11.0pt
* \columnsep=10.0pt
* \skip\footins=9.0pt plus 4.0pt minus 2.0pt
* \hoffset=0.0pt
* \voffset=0.0pt
* \mag=1000
* \@twocolumnfalse
* \@twosidefalse
* \@mparswitchfalse
* \@reversemarginfalse
* (1in=72.27pt=25.4mm, 1cm=28.453pt)

(/usr/local/texlive/2022/texmf-dist/tex/context/base/mkii/supp-pdf.mkii
[Loading MPS to PDF converter (version 2006.09.02).]
) (/usr/local/texlive/2022/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/nameref.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/refcount/refcount.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/gettitlestring/gettitlestring.s
ty))

LaTeX Warning: No \author given.


Overfull \hbox (15.67747pt too wide) in paragraph at lines 110--201
 [] 

Underfull \hbox (badness 10000) in paragraph at lines 348--354

[1{/usr/local/texlive/2022/texmf-var/fonts/map/pdftex/updmap/pdftex.map}]
[2]
Overfull \vbox (5.12886pt too high) has occurred while \output is active
[3 <./Consistency/counts_by_time.pdf> <./Consistency/earn_by_time.pdf>]
[4 <./Consistency/logearn_by_time.pdf> <./Consistency/logearn_by_year_pct.pdf>]

Underfull \hbox (badness 10000) in paragraph at lines 355--360

[5 <./Consistency/employed_by_time.pdf> <./Consistency/displaced_by_time.pdf>]
[6]
Overfull \vbox (5.12886pt too high) has occurred while \output is active
[7 <./Disp_event_raw/counts_by_timesince.pdf> <./Disp_event_raw/logearn_by_time
since.pdf>] [8 <./Disp_event_raw/earn_by_timesince.pdf> <./Disp_event_raw/emplo
yed_by_timesince.pdf>] [9 <./Disp_event_raw/displaced_by_timesince.pdf>]
(./descriptive_analysis.aux)

Package rerunfilecheck Warning: File `descriptive_analysis.out' has changed.
(rerunfilecheck)                Rerun to get outlines right
(rerunfilecheck)                or use package `bookmark'.

 )
(see the transcript file for additional information)</usr/local/texlive/2022/te
xmf-dist/fonts/type1/public/amsfonts/cm/cmbx12.pfb></usr/local/texlive/2022/tex
mf-dist/fonts/type1/public/amsfonts/cm/cmbx8.pfb></usr/local/texlive/2022/texmf
-dist/fonts/type1/public/amsfonts/cm/cmr10.pfb></usr/local/texlive/2022/texmf-d
ist/fonts/type1/public/amsfonts/cm/cmr17.pfb></usr/local/texlive/2022/texmf-dis
t/fonts/type1/public/amsfonts/cm/cmr8.pfb>
Output written on descriptive_analysis.pdf (9 pages, 304103 bytes).
Transcript written on descriptive_analysis.log.

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)
 \write18 enabled.
 Source specials enabled.
entering extended mode
(./descriptive_analysis.tex
LaTeX2e <2021-11-15> patch level 1
L3 programming layer <2022-02-24>
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/article.cls
Document Class: article 2021/10/04 v1.4n Standard LaTeX document class
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/size10.clo))
(/usr/local/texlive/2022/texmf-dist/tex/latex/geometry/geometry.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/keyval.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/ifvtex.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/iftex.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/booktabs/booktabs.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/longtable.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/pdflscape/pdflscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/lscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphics.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/trig.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/graphics.cfg)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-def/pdftex.def))))
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/rotating.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphicx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/ifthen.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/threeparttable/threeparttable.sty
) (/usr/local/texlive/2022/texmf-dist/tex/latex/caption/subcaption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption3.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/ltcaption.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/float/float.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/tabularx.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/array.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/xcolor/xcolor.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/color.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/colortbl/colortbl.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hyperref.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdftexcmds/pdftexcmds.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/infwarerr/infwarerr.sty))
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdfescape/pdfescape.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hycolor/hycolor.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/auxhook/auxhook.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/kvoptions/kvoptions.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/pd1enc.def)
(/usr/local/texlive/2022/texmf-dist/tex/generic/intcalc/intcalc.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/etexcmds/etexcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/puenc.def)
(/usr/local/texlive/2022/texmf-dist/tex/latex/url/url.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/bitset/bitset.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atbegshi-ltx.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hpdftex.def
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atveryend-ltx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty

(/usr/local/texlive/2022/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty
)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.def)
(./descriptive_analysis.aux)
*geometry* driver: auto-detecting
*geometry* detected driver: pdftex
*geometry* verbose mode - [ preamble ] result:
* driver: pdftex
* paper: letterpaper
* layout: <same size as paper>
* layoutoffset:(h,v)=(0.0pt,0.0pt)
* modes: 
* h-part:(L,W,R)=(71.13188pt, 451.01793pt, 92.14519pt)
* v-part:(T,H,B)=(71.13188pt, 628.44073pt, 95.39737pt)
* \paperwidth=614.295pt
* \paperheight=794.96999pt
* \textwidth=451.01793pt
* \textheight=628.44073pt
* \oddsidemargin=-1.1381pt
* \evensidemargin=-1.1381pt
* \topmargin=-38.1381pt
* \headheight=12.0pt
* \headsep=25.0pt
* \topskip=10.0pt
* \footskip=30.0pt
* \marginparwidth=65.0pt
* \marginparsep=11.0pt
* \columnsep=10.0pt
* \skip\footins=9.0pt plus 4.0pt minus 2.0pt
* \hoffset=0.0pt
* \voffset=0.0pt
* \mag=1000
* \@twocolumnfalse
* \@twosidefalse
* \@mparswitchfalse
* \@reversemarginfalse
* (1in=72.27pt=25.4mm, 1cm=28.453pt)

(/usr/local/texlive/2022/texmf-dist/tex/context/base/mkii/supp-pdf.mkii
[Loading MPS to PDF converter (version 2006.09.02).]
) (/usr/local/texlive/2022/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/nameref.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/refcount/refcount.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/gettitlestring/gettitlestring.s
ty)) (./descriptive_analysis.out) (./descriptive_analysis.out)

LaTeX Warning: No \author given.


Overfull \hbox (15.67747pt too wide) in paragraph at lines 110--201
 [] 

Underfull \hbox (badness 10000) in paragraph at lines 348--354

[1{/usr/local/texlive/2022/texmf-var/fonts/map/pdftex/updmap/pdftex.map}]
[2]
Overfull \vbox (5.12886pt too high) has occurred while \output is active
[3 <./Consistency/counts_by_time.pdf> <./Consistency/earn_by_time.pdf>]
[4 <./Consistency/logearn_by_time.pdf> <./Consistency/logearn_by_year_pct.pdf>]

Underfull \hbox (badness 10000) in paragraph at lines 355--360

[5 <./Consistency/employed_by_time.pdf> <./Consistency/displaced_by_time.pdf>]
[6]
Overfull \vbox (5.12886pt too high) has occurred while \output is active
[7 <./Disp_event_raw/counts_by_timesince.pdf> <./Disp_event_raw/logearn_by_time
since.pdf>] [8 <./Disp_event_raw/earn_by_timesince.pdf> <./Disp_event_raw/emplo
yed_by_timesince.pdf>] [9 <./Disp_event_raw/displaced_by_timesince.pdf>]
(./descriptive_analysis.aux) )
(see the transcript file for additional information)</usr/local/texlive/2022/te
xmf-dist/fonts/type1/public/amsfonts/cm/cmbx12.pfb></usr/local/texlive/2022/tex
mf-dist/fonts/type1/public/amsfonts/cm/cmbx8.pfb></usr/local/texlive/2022/texmf
-dist/fonts/type1/public/amsfonts/cm/cmr10.pfb></usr/local/texlive/2022/texmf-d
ist/fonts/type1/public/amsfonts/cm/cmr17.pfb></usr/local/texlive/2022/texmf-dis
t/fonts/type1/public/amsfonts/cm/cmr8.pfb>
Output written on descriptive_analysis.pdf (9 pages, 304685 bytes).
Transcript written on descriptive_analysis.log.
/Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do

    ---------------------------------------------------------------------------------------------------------------------------------- end descriptive_analysis ---
  - eventstudy_analysis, in(${data}analysis_data)
  = eventstudy_analysis, in(../data/analysis_data)
    --------------------------------------------------------------------------------------------------------------------------------- begin eventstudy_analysis ---
    - syntax , [ in(str) from(int -5) to(int 10) omit(int -1) ]
    - use `in' if timesince>=`from', clear
    = use ../data/analysis_data if timesince>=-5, clear
    - egen persid2 = group(baselinetime persid)
    - qui tab year, gen(_Dyear)
    - drop _Dyear1
    - qui tab timesince, gen(_DtimesinceTreat)
    - foreach v of varlist _Dtime* {
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat1 = 0 if sep==0
(167 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat2 = 0 if sep==0
(197 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat3 = 0 if sep==0
(197 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat4 = 0 if sep==0
(197 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat5 = 0 if sep==0
(197 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat6 = 0 if sep==0
(197 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat7 = 0 if sep==0
(189 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat8 = 0 if sep==0
(175 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat9 = 0 if sep==0
(153 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat10 = 0 if sep==0
(128 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat11 = 0 if sep==0
(112 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat12 = 0 if sep==0
(112 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat13 = 0 if sep==0
(112 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat14 = 0 if sep==0
(94 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat15 = 0 if sep==0
(82 real changes made)
    - }
    - replace `v' = 0 if sep==0
    = replace _DtimesinceTreat16 = 0 if sep==0
(50 real changes made)
    - }
    - local omitdum = `omit'-`from'+1
    = local omitdum = -1--5+1
    - drop _DtimesinceTreat`omitdum'
    = drop _DtimesinceTreat5
    - local omitcat omit(`omit')
    = local omitcat omit(-1)
    - qui tab timesince, gen(_DtimesinceAll)
    - g age2 = age^2
(21 missing values generated)
    - g age3 = age^3
(21 missing values generated)
    - g age4 = age^4
(21 missing values generated)
    - local controls age age2 age3 age4
    - local i 100
    - local treatment_effect -0.2
    - local file ${log}eventstudy_analysis.tex
    = local file ../log/eventstudy_analysis.tex
    - cap mkdir ${log}Eventstudy/
    = cap mkdir ../log/Eventstudy/
    - latexlog `file': open
    = latexlog ../log/eventstudy_analysis.tex: open
    - latexlog `file': title "Eventstudy Analysis for Displacement Events"
    = latexlog ../log/eventstudy_analysis.tex: title "Eventstudy Analysis for Displacement Events"
    - cellgraph logearn, by(timesince sep) title(Raw Means for Disp and Non-Disp Workers)
(32 missing values generated)
(32 real changes made)


    - latexlog `file': addfig, file(Eventstudy/eventstudy_RawMeans.pdf) eol
    = latexlog ../log/eventstudy_analysis.tex: addfig, file(Eventstudy/eventstudy_RawMeans.pdf) eol
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex

macros:
           r(filename) : "eventstudy_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "eventstudy_analysis"
               r(path) : "../log/"
../log/
Path: Eventstudy/
Filestub: eventstudy_RawMeans
Fileend: pdf
Filename: eventstudy_RawMeans.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Eventstudy/eventstudy_RawMeans.pdf saved as PDF
    format
    - local opt ysize(8) xsize(12) xline(-0.5, lcol(gray)) legend(off)
    - reg logearn _DtimesinceTreat* _DtimesinceAll* `controls',
    = reg logearn _DtimesinceTreat* _DtimesinceAll* age age2 age3 age4,
note: _DtimesinceAll15 omitted because of collinearity.

      Source |       SS           df       MS      Number of obs   =     4,170
-------------+----------------------------------   F(34, 4135)     =     35.23
       Model |  77.9720068        34  2.29329432   Prob > F        =    0.0000
    Residual |  269.181819     4,135  .065098384   R-squared       =    0.2246
-------------+----------------------------------   Adj R-squared   =    0.2182
       Total |  347.153825     4,169  .083270287   Root MSE        =    .25514

------------------------------------------------------------------------------------
           logearn | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------------+----------------------------------------------------------------
 _DtimesinceTreat1 |   .0191661   .0288507     0.66   0.507    -.0373969     .075729
 _DtimesinceTreat2 |  -.0001155   .0257233    -0.00   0.996    -.0505469    .0503159
 _DtimesinceTreat3 |   .0025836    .025718     0.10   0.920    -.0478376    .0530048
 _DtimesinceTreat4 |  -.0083525    .025715    -0.32   0.745    -.0587678    .0420629
 _DtimesinceTreat6 |  -.1909096   .0263231    -7.25   0.000     -.242517   -.1393021
 _DtimesinceTreat7 |  -.2124184   .0277654    -7.65   0.000    -.2668535   -.1579832
 _DtimesinceTreat8 |  -.1659193   .0299126    -5.55   0.000     -.224564   -.1072745
 _DtimesinceTreat9 |  -.1882611   .0322711    -5.83   0.000    -.2515298   -.1249925
_DtimesinceTreat10 |  -.1975676   .0353915    -5.58   0.000    -.2669541   -.1281812
_DtimesinceTreat11 |  -.2090435   .0381207    -5.48   0.000    -.2837806   -.1343065
_DtimesinceTreat12 |  -.1792129   .0390063    -4.59   0.000    -.2556863   -.1027396
_DtimesinceTreat13 |  -.1132183   .0405381    -2.79   0.005    -.1926948   -.0337417
_DtimesinceTreat14 |  -.1687999    .044812    -3.77   0.000    -.2566554   -.0809444
_DtimesinceTreat15 |  -.1299153   .0482881    -2.69   0.007     -.224586   -.0352447
_DtimesinceTreat16 |  -.1426755   .0658782    -2.17   0.030    -.2718322   -.0135189
   _DtimesinceAll1 |  -.0531907    .040193    -1.32   0.186    -.1319906    .0256092
   _DtimesinceAll2 |  -.0394494   .0391193    -1.01   0.313    -.1161442    .0372454
   _DtimesinceAll3 |   -.012908   .0390668    -0.33   0.741       -.0895    .0636839
   _DtimesinceAll4 |   .0062618   .0390314     0.16   0.873    -.0702608    .0827844
   _DtimesinceAll5 |   .0204823   .0368223     0.56   0.578    -.0517093    .0926739
   _DtimesinceAll6 |   .0365436   .0391172     0.93   0.350    -.0401471    .1132343
   _DtimesinceAll7 |   .0445146   .0395013     1.13   0.260    -.0329292    .1219583
   _DtimesinceAll8 |  -.0006063   .0399961    -0.02   0.988      -.07902    .0778075
   _DtimesinceAll9 |   .0264885   .0407265     0.65   0.515    -.0533575    .1063344
  _DtimesinceAll10 |   .0195446   .0417137     0.47   0.639    -.0622366    .1013259
  _DtimesinceAll11 |   .0565864   .0427332     1.32   0.186    -.0271936    .1403665
  _DtimesinceAll12 |   .0354842    .042933     0.83   0.409    -.0486876    .1196559
  _DtimesinceAll13 |   -.002149   .0435998    -0.05   0.961     -.087628      .08333
  _DtimesinceAll14 |   .0193051   .0448826     0.43   0.667    -.0686889    .1072992
  _DtimesinceAll15 |          0  (omitted)
  _DtimesinceAll16 |   .0248683   .0549837     0.45   0.651    -.0829293    .1326659
               age |  -.1533874   .1364275    -1.12   0.261    -.4208587    .1140839
              age2 |   .0055906   .0048446     1.15   0.249    -.0039074    .0150885
              age3 |   -.000082   .0000747    -1.10   0.273    -.0002285    .0000645
              age4 |   4.45e-07   4.23e-07     1.05   0.293    -3.85e-07    1.27e-06
             _cons |   10.61238   1.404135     7.56   0.000     7.859525    13.36524
------------------------------------------------------------------------------------
    - eventstudy_figure, from(`from') to(`to') treatment_effect(`treatment_effect') name(g`i++') `omitcat' tit(OLS - Rel. Year Specification) subtit(Control. for P
> erson FE; Year Since Event (for Disp and Non-Disp)) ytitle(Log Earnings) `opt'
    = eventstudy_figure, from(-5) to(10) treatment_effect(-0.2) name(g100) omit(-1) tit(OLS - Rel. Year Specification) subtit(Control. for Person FE; Year Since Ev
> ent (for Disp and Non-Disp)) ytitle(Log Earnings) ysize(8) xsize(12) xline(-0.5, lcol(gray)) legend(off)
16
number of observations will be reset to 15
Press any key to continue, or Break to abort
Number of observations (_N) was 0, now 15.
(0 observations deleted)
(1 observation created)
(1 real change made)
(1 real change made)
(1 real change made)
(4 real changes made)
(11 missing values generated)
(11 real changes made)
    - latexlog `file': addfig, file(Eventstudy/eventstudy_OLS.pdf) eol
    = latexlog ../log/eventstudy_analysis.tex: addfig, file(Eventstudy/eventstudy_OLS.pdf) eol
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex

macros:
           r(filename) : "eventstudy_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "eventstudy_analysis"
               r(path) : "../log/"
../log/
Path: Eventstudy/
Filestub: eventstudy_OLS
Fileend: pdf
Filename: eventstudy_OLS.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Eventstudy/eventstudy_OLS.pdf saved as PDF
    format
    - xtreg logearn _DtimesinceTreat* _Dyear* `controls', fe i(persid2)
    = xtreg logearn _DtimesinceTreat* _Dyear* age age2 age3 age4, fe i(persid2)
warning: existing panel variable is not persid2
note: age omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,170
Group variable: persid2                         Number of groups  =        394

R-squared:                                      Obs per group:
     Within  = 0.3618                                         min =          4
     Between = 0.0430                                         avg =       10.6
     Overall = 0.0156                                         max =         16

                                                F(33, 3743)       =      64.29
corr(u_i, Xb) = -0.8558                         Prob > F          =     0.0000

------------------------------------------------------------------------------------
           logearn | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------------+----------------------------------------------------------------
 _DtimesinceTreat1 |  -.0057965   .0136177    -0.43   0.670    -.0324952    .0209023
 _DtimesinceTreat2 |  -.0163372   .0126959    -1.29   0.198    -.0412286    .0085543
 _DtimesinceTreat3 |  -.0040736   .0123466    -0.33   0.741    -.0282804    .0201331
 _DtimesinceTreat4 |  -.0119845   .0122153    -0.98   0.327    -.0359338    .0119648
 _DtimesinceTreat6 |  -.1874999   .0123891   -15.13   0.000    -.2117899   -.1632099
 _DtimesinceTreat7 |  -.2012659   .0129407   -15.55   0.000    -.2266374   -.1758943
 _DtimesinceTreat8 |  -.2023705   .0139601   -14.50   0.000    -.2297407   -.1750003
 _DtimesinceTreat9 |  -.1972786   .0148335   -13.30   0.000    -.2263611   -.1681961
_DtimesinceTreat10 |  -.1968672   .0160157   -12.29   0.000    -.2282676   -.1654668
_DtimesinceTreat11 |   -.180029   .0169228   -10.64   0.000    -.2132078   -.1468502
_DtimesinceTreat12 |  -.1794714   .0172691   -10.39   0.000    -.2133292   -.1456136
_DtimesinceTreat13 |  -.1513437   .0178582    -8.47   0.000    -.1863564    -.116331
_DtimesinceTreat14 |  -.1677674   .0196959    -8.52   0.000    -.2063832   -.1291516
_DtimesinceTreat15 |  -.1413974   .0209091    -6.76   0.000    -.1823918    -.100403
_DtimesinceTreat16 |  -.1682282   .0270457    -6.22   0.000     -.221254   -.1152023
           _Dyear2 |   .0580167   .0743172     0.78   0.435    -.0876894    .2037228
           _Dyear3 |   .1272635   .1458843     0.87   0.383     -.158757     .413284
           _Dyear4 |   .1981583    .218426     0.91   0.364    -.2300873    .6264039
           _Dyear5 |    .264985   .2909823     0.91   0.363    -.3055144    .8354843
           _Dyear6 |   .3306353   .3635007     0.91   0.363    -.3820435    1.043314
           _Dyear7 |   .3988881   .4361462     0.91   0.360    -.4562193    1.253995
           _Dyear8 |   .4625668   .5089514     0.91   0.363    -.5352822    1.460416
           _Dyear9 |   .5330694   .5817276     0.92   0.360    -.6074645    1.673603
          _Dyear10 |   .6032912   .6542693     0.92   0.357    -.6794679     1.88605
          _Dyear11 |   .6757935   .7269256     0.93   0.353    -.7494153    2.101002
          _Dyear12 |   .7505086   .7995164     0.94   0.348    -.8170215    2.318039
          _Dyear13 |   .8048351   .8721088     0.92   0.356    -.9050197     2.51469
          _Dyear14 |   .8403974   .9447241     0.89   0.374    -1.011827    2.692622
          _Dyear15 |   .9253247   1.017462     0.91   0.363    -1.069509    2.920158
          _Dyear16 |   .9736639   1.089949     0.89   0.372    -1.163288    3.110616
               age |          0  (omitted)
              age2 |  -.0013073   .0025739    -0.51   0.612    -.0063536     .003739
              age3 |   .0000182   .0000396     0.46   0.645    -.0000594    .0000959
              age4 |  -8.99e-08   2.24e-07    -0.40   0.688    -5.28e-07    3.48e-07
             _cons |   10.07097   1.751532     5.75   0.000     6.636918    13.50502
-------------------+----------------------------------------------------------------
           sigma_u |  .51866842
           sigma_e |  .11938814
               rho |  .94968227   (fraction of variance due to u_i)
------------------------------------------------------------------------------------
F test that all u_i=0: F(393, 3743) = 34.51                  Prob > F = 0.0000
    - eventstudy_figure, from(`from') to(`to') treatment_effect(`treatment_effect') name(g`i++') `omitcat' tit(JLS Specification) subtit(Controlling for Year and P
> erson FE) ytitle(Log Earnings) `opt'
    = eventstudy_figure, from(-5) to(10) treatment_effect(-0.2) name(g101) omit(-1) tit(JLS Specification) subtit(Controlling for Year and Person FE) ytitle(Log Ea
> rnings) ysize(8) xsize(12) xline(-0.5, lcol(gray)) legend(off)
16
number of observations will be reset to 15
Press any key to continue, or Break to abort
Number of observations (_N) was 0, now 15.
(0 observations deleted)
(1 observation created)
(1 real change made)
(1 real change made)
(1 real change made)
(4 real changes made)
(11 missing values generated)
(11 real changes made)
    - latexlog `file': addfig, file(Eventstudy/eventstudy_FE_JLS.pdf) eol
    = latexlog ../log/eventstudy_analysis.tex: addfig, file(Eventstudy/eventstudy_FE_JLS.pdf) eol
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex

macros:
           r(filename) : "eventstudy_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "eventstudy_analysis"
               r(path) : "../log/"
../log/
Path: Eventstudy/
Filestub: eventstudy_FE_JLS
Fileend: pdf
Filename: eventstudy_FE_JLS.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Eventstudy/eventstudy_FE_JLS.pdf saved as PDF
    format
    - xtreg logearn _DtimesinceTreat* _DtimesinceAll* `controls', fe i(persid2)
    = xtreg logearn _DtimesinceTreat* _DtimesinceAll* age age2 age3 age4, fe i(persid2)
note: _DtimesinceAll16 omitted because of collinearity.
note: age omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,170
Group variable: persid2                         Number of groups  =        394

R-squared:                                      Obs per group:
     Within  = 0.3633                                         min =          4
     Between = 0.1973                                         avg =       10.6
     Overall = 0.2108                                         max =         16

                                                F(33, 3743)       =      64.72
corr(u_i, Xb) = -0.4036                         Prob > F          =     0.0000

------------------------------------------------------------------------------------
           logearn | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------------+----------------------------------------------------------------
 _DtimesinceTreat1 |   .0184326   .0181779     1.01   0.311     -.017207    .0540722
 _DtimesinceTreat2 |  -.0076519   .0169957    -0.45   0.653    -.0409736    .0256699
 _DtimesinceTreat3 |  -.0046779   .0169934    -0.28   0.783     -.037995    .0286393
 _DtimesinceTreat4 |  -.0153556   .0169922    -0.90   0.366    -.0486704    .0179593
 _DtimesinceTreat6 |  -.1926374   .0172372   -11.18   0.000    -.2264326   -.1588423
 _DtimesinceTreat7 |   -.218091   .0178083   -12.25   0.000    -.2530059   -.1831761
 _DtimesinceTreat8 |  -.1734974   .0186597    -9.30   0.000    -.2100816   -.1369131
 _DtimesinceTreat9 |  -.1944281   .0196056    -9.92   0.000    -.2328669   -.1559894
_DtimesinceTreat10 |  -.1904935   .0208767    -9.12   0.000    -.2314244   -.1495626
_DtimesinceTreat11 |  -.2086877   .0220052    -9.48   0.000    -.2518311   -.1655442
_DtimesinceTreat12 |   -.177662   .0223734    -7.94   0.000    -.2215273   -.1337967
_DtimesinceTreat13 |  -.1194918   .0230111    -5.19   0.000    -.1646073   -.0743763
_DtimesinceTreat14 |  -.1668444    .024808    -6.73   0.000     -.215483   -.1182059
_DtimesinceTreat15 |  -.1286247   .0262953    -4.89   0.000    -.1801792   -.0770703
_DtimesinceTreat16 |  -.1555041   .0340887    -4.56   0.000    -.2223384   -.0886698
   _DtimesinceAll1 |  -.0245554   1.126941    -0.02   0.983    -2.234034    2.184923
   _DtimesinceAll2 |  -.0054828   1.051879    -0.01   0.996    -2.067795    2.056829
   _DtimesinceAll3 |   .0074084    .977483     0.01   0.994    -1.909043    1.923859
   _DtimesinceAll4 |   .0133242   .9029435     0.01   0.988    -1.756985    1.783633
   _DtimesinceAll5 |    .011236   .8282886     0.01   0.989    -1.612705    1.635177
   _DtimesinceAll6 |   .0155913   .7534776     0.02   0.983    -1.461675    1.492858
   _DtimesinceAll7 |   .0256033   .6786571     0.04   0.970     -1.30497    1.356177
   _DtimesinceAll8 |  -.0177739   .6037382    -0.03   0.977    -1.201462    1.165914
   _DtimesinceAll9 |   .0139831    .528774     0.03   0.979     -1.02273    1.050696
  _DtimesinceAll10 |   .0161042   .4537069     0.04   0.972    -.8734327    .9056411
  _DtimesinceAll11 |   .0538963   .3786071     0.14   0.887       -.6884    .7961925
  _DtimesinceAll12 |   .0249955   .3035819     0.08   0.934    -.5702065    .6201974
  _DtimesinceAll13 |  -.0146247   .2286609    -0.06   0.949    -.4629369    .4336875
  _DtimesinceAll14 |   .0156629    .153806     0.10   0.919    -.2858888    .3172146
  _DtimesinceAll15 |  -.0078551   .0803193    -0.10   0.922    -.1653289    .1496188
  _DtimesinceAll16 |          0  (omitted)
               age |          0  (omitted)
              age2 |   .0009478   .0026556     0.36   0.721    -.0042588    .0061545
              age3 |  -.0000161   .0000409    -0.39   0.695    -.0000962    .0000641
              age4 |   1.02e-07   2.31e-07     0.44   0.658    -3.50e-07    5.55e-07
             _cons |     8.5327   3.145644     2.71   0.007     2.365357    14.70004
-------------------+----------------------------------------------------------------
           sigma_u |  .25108053
           sigma_e |  .11924598
               rho |  .81595375   (fraction of variance due to u_i)
------------------------------------------------------------------------------------
F test that all u_i=0: F(393, 3743) = 38.66                  Prob > F = 0.0000
    - eventstudy_figure, from(`from') to(`to') treatment_effect(`treatment_effect') name(g`i++') `omitcat' tit(Rel. Year Specification) subtit(Control. for Person 
> FE; Year Since Event (for Disp and Non-Disp)) ytitle(Log Earnings) `opt'
    = eventstudy_figure, from(-5) to(10) treatment_effect(-0.2) name(g102) omit(-1) tit(Rel. Year Specification) subtit(Control. for Person FE; Year Since Event (f
> or Disp and Non-Disp)) ytitle(Log Earnings) ysize(8) xsize(12) xline(-0.5, lcol(gray)) legend(off)
16
number of observations will be reset to 15
Press any key to continue, or Break to abort
Number of observations (_N) was 0, now 15.
(0 observations deleted)
(1 observation created)
(1 real change made)
(1 real change made)
(1 real change made)
(4 real changes made)
(11 missing values generated)
(11 real changes made)
    - latexlog `file': addfig, file(Eventstudy/eventstudy_FE_RelYear.pdf) eol
    = latexlog ../log/eventstudy_analysis.tex: addfig, file(Eventstudy/eventstudy_FE_RelYear.pdf) eol
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex

macros:
           r(filename) : "eventstudy_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "eventstudy_analysis"
               r(path) : "../log/"
../log/
Path: Eventstudy/
Filestub: eventstudy_FE_RelYear
Fileend: pdf
Filename: eventstudy_FE_RelYear.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Eventstudy/eventstudy_FE_RelYear.pdf saved as
    PDF format
    - xtreg logearn _DtimesinceTreat* _Dyear* _DtimesinceAll* `controls', fe i(persid2)
    = xtreg logearn _DtimesinceTreat* _Dyear* _DtimesinceAll* age age2 age3 age4, fe i(persid2)
note: _DtimesinceAll15 omitted because of collinearity.
note: _DtimesinceAll16 omitted because of collinearity.
note: age omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,170
Group variable: persid2                         Number of groups  =        394

R-squared:                                      Obs per group:
     Within  = 0.3675                                         min =          4
     Between = 0.1841                                         avg =       10.6
     Overall = 0.2166                                         max =         16

                                                F(47, 3729)       =      46.10
corr(u_i, Xb) = 0.0725                          Prob > F          =     0.0000

------------------------------------------------------------------------------------
           logearn | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------------+----------------------------------------------------------------
 _DtimesinceTreat1 |   .0183703   .0181529     1.01   0.312    -.0172204     .053961
 _DtimesinceTreat2 |  -.0077485   .0169715    -0.46   0.648    -.0410228    .0255258
 _DtimesinceTreat3 |   -.004738   .0169691    -0.28   0.780    -.0380076    .0285317
 _DtimesinceTreat4 |  -.0153833   .0169679    -0.91   0.365    -.0486506     .017884
 _DtimesinceTreat6 |   -.192868   .0172135   -11.20   0.000    -.2266168   -.1591193
 _DtimesinceTreat7 |  -.2177271   .0177854   -12.24   0.000    -.2525971    -.182857
 _DtimesinceTreat8 |  -.1733799   .0186361    -9.30   0.000    -.2099178   -.1368421
 _DtimesinceTreat9 |  -.1941142   .0195815    -9.91   0.000    -.2325057   -.1557227
_DtimesinceTreat10 |  -.1903872   .0208498    -9.13   0.000    -.2312653   -.1495092
_DtimesinceTreat11 |  -.2068596   .0219803    -9.41   0.000    -.2499542    -.163765
_DtimesinceTreat12 |  -.1772481   .0223459    -7.93   0.000    -.2210595   -.1334368
_DtimesinceTreat13 |  -.1175471   .0229842    -5.11   0.000      -.16261   -.0724842
_DtimesinceTreat14 |  -.1667311   .0247783    -6.73   0.000    -.2153113   -.1181508
_DtimesinceTreat15 |  -.1279259   .0262614    -4.87   0.000    -.1794141   -.0764378
_DtimesinceTreat16 |  -.1548359    .034042    -4.55   0.000    -.2215786   -.0880931
           _Dyear2 |   .0128918   .0823461     0.16   0.876     -.148556    .1743395
           _Dyear3 |   .0355051   .1622341     0.22   0.827    -.2825712    .3535813
           _Dyear4 |   .0624654   .2430892     0.26   0.797    -.4141354    .5390662
           _Dyear5 |    .083949   .3239218     0.26   0.796    -.5511323    .7190302
           _Dyear6 |    .104526   .4047282     0.26   0.796    -.6889842    .8980363
           _Dyear7 |   .1365452   .4854957     0.28   0.779    -.8153179    1.088408
           _Dyear8 |   .1586608   .5663132     0.28   0.779    -.9516531    1.268975
           _Dyear9 |   .1891974   .6471395     0.29   0.770    -1.079585    1.457979
          _Dyear10 |   .2116535   .7278063     0.29   0.771    -1.215284    1.638591
          _Dyear11 |   .2425101   .8086021     0.30   0.764    -1.342836    1.827856
          _Dyear12 |   .2737014    .889344     0.31   0.758    -1.469947     2.01735
          _Dyear13 |   .2853935   .9700172     0.29   0.769    -1.616423    2.187209
          _Dyear14 |   .2818496   1.050851     0.27   0.789    -1.778449    2.342148
          _Dyear15 |   .3259614   1.131096     0.29   0.773    -1.891665    2.543588
          _Dyear16 |   .3344573   1.211888     0.28   0.783    -2.041572    2.710486
   _DtimesinceAll1 |  -.0069162   .3757408    -0.02   0.985    -.7435937    .7297614
   _DtimesinceAll2 |   .0094658   .3496311     0.03   0.978    -.6760211    .6949528
   _DtimesinceAll3 |   .0209011   .3235045     0.06   0.948     -.613362    .6551641
   _DtimesinceAll4 |    .024953   .2973456     0.08   0.933    -.5580229    .6079289
   _DtimesinceAll5 |   .0218988    .271234     0.08   0.936    -.5098827    .5536803
   _DtimesinceAll6 |   .0262999   .2451351     0.11   0.915    -.4543121    .5069118
   _DtimesinceAll7 |   .0367581   .2190855     0.17   0.867    -.3927811    .4662973
   _DtimesinceAll8 |  -.0108109   .1930688    -0.06   0.955    -.3893417    .3677199
   _DtimesinceAll9 |   .0155382   .1671135     0.09   0.926    -.3121046     .343181
  _DtimesinceAll10 |   .0123979   .1411264     0.09   0.930    -.2642946    .2890905
  _DtimesinceAll11 |   .0470267   .1152285     0.41   0.683    -.1788903    .2729437
  _DtimesinceAll12 |    .017072   .0896126     0.19   0.849    -.1586225    .1927665
  _DtimesinceAll13 |   -.016134   .0641505    -0.25   0.801    -.1419075    .1096396
  _DtimesinceAll14 |   .0153222   .0403001     0.38   0.704    -.0636901    .0943345
  _DtimesinceAll15 |          0  (omitted)
  _DtimesinceAll16 |          0  (omitted)
               age |          0  (omitted)
              age2 |   .0001942    .002668     0.07   0.942    -.0050367    .0054251
              age3 |  -4.84e-06    .000041    -0.12   0.906    -.0000853    .0000756
              age4 |   4.06e-08   2.32e-07     0.18   0.861    -4.14e-07    4.95e-07
             _cons |   9.039019   1.854148     4.88   0.000     5.403776    12.67426
-------------------+----------------------------------------------------------------
           sigma_u |  .23095489
           sigma_e |  .11907562
               rho |  .79000032   (fraction of variance due to u_i)
------------------------------------------------------------------------------------
F test that all u_i=0: F(393, 3729) = 33.98                  Prob > F = 0.0000
    - eventstudy_figure, from(`from') to(`to') treatment_effect(`treatment_effect') name(g`i++') `omitcat' tit(SWH Specification) subtit(Control. for Person FE; Ye
> ar Since Event (for Disp and Non-Disp) and Year FE) ytitle(Log Earnings) `opt'
    = eventstudy_figure, from(-5) to(10) treatment_effect(-0.2) name(g103) omit(-1) tit(SWH Specification) subtit(Control. for Person FE; Year Since Event (for Dis
> p and Non-Disp) and Year FE) ytitle(Log Earnings) ysize(8) xsize(12) xline(-0.5, lcol(gray)) legend(off)
16
number of observations will be reset to 15
Press any key to continue, or Break to abort
Number of observations (_N) was 0, now 15.
(0 observations deleted)
(1 observation created)
(1 real change made)
(1 real change made)
(1 real change made)
(4 real changes made)
(11 missing values generated)
(11 real changes made)
    - latexlog `file': addfig, file(Eventstudy/eventstudy_FE_Full.pdf) eol
    = latexlog ../log/eventstudy_analysis.tex: addfig, file(Eventstudy/eventstudy_FE_Full.pdf) eol
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex

macros:
           r(filename) : "eventstudy_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "eventstudy_analysis"
               r(path) : "../log/"
../log/
Path: Eventstudy/
Filestub: eventstudy_FE_Full
Fileend: pdf
Filename: eventstudy_FE_Full.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Eventstudy/eventstudy_FE_Full.pdf saved as PDF
    format
    - xtreg employed _DtimesinceTreat* _Dyear* _DtimesinceAll* `controls', fe i(persid2)
    = xtreg employed _DtimesinceTreat* _Dyear* _DtimesinceAll* age age2 age3 age4, fe i(persid2)
note: _DtimesinceAll15 omitted because of collinearity.
note: _DtimesinceAll16 omitted because of collinearity.
note: age omitted because of collinearity.

Fixed-effects (within) regression               Number of obs     =      4,697
Group variable: persid2                         Number of groups  =        394

R-squared:                                      Obs per group:
     Within  = 0.2772                                         min =          5
     Between = 0.0324                                         avg =       11.9
     Overall = 0.1707                                         max =         16

                                                F(47, 4256)       =      34.74
corr(u_i, Xb) = -0.1216                         Prob > F          =     0.0000

------------------------------------------------------------------------------------
          employed | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------------+----------------------------------------------------------------
 _DtimesinceTreat1 |  -.0036012    .040258    -0.09   0.929    -.0825279    .0753255
 _DtimesinceTreat2 |  -.0005515   .0376865    -0.01   0.988    -.0744367    .0733338
 _DtimesinceTreat3 |  -.0004438   .0376822    -0.01   0.991    -.0743205     .073433
 _DtimesinceTreat4 |  -.0002611     .03768    -0.01   0.994    -.0741335    .0736114
 _DtimesinceTreat6 |  -.3651394   .0376798    -9.69   0.000    -.4390116   -.2912673
 _DtimesinceTreat7 |  -.2264962   .0381454    -5.94   0.000    -.3012811   -.1517113
 _DtimesinceTreat8 |  -.2409134   .0390272    -6.17   0.000    -.3174271   -.1643997
 _DtimesinceTreat9 |  -.2420747    .040652    -5.95   0.000    -.3217737   -.1623756
_DtimesinceTreat10 |  -.2316139   .0430333    -5.38   0.000    -.3159816   -.1472462
_DtimesinceTreat11 |  -.2353877   .0449897    -5.23   0.000    -.3235911   -.1471844
_DtimesinceTreat12 |  -.1721269   .0449944    -3.83   0.000    -.2603394   -.0839144
_DtimesinceTreat13 |  -.1266728   .0450014    -2.81   0.005    -.2148991   -.0384465
_DtimesinceTreat14 |  -.1520744   .0477805    -3.18   0.001    -.2457491   -.0583997
_DtimesinceTreat15 |  -.0725789   .0501844    -1.45   0.148    -.1709665    .0258086
_DtimesinceTreat16 |   -.109326   .0609025    -1.80   0.073    -.2287267    .0100748
           _Dyear2 |  -.0307465   .1641131    -0.19   0.851    -.3524939    .2910008
           _Dyear3 |   -.049784   .3223526    -0.15   0.877    -.6817633    .5821952
           _Dyear4 |  -.0625488   .4829716    -0.13   0.897    -1.009425    .8843275
           _Dyear5 |  -.0881293    .643566    -0.14   0.891    -1.349854    1.173596
           _Dyear6 |  -.1061022   .8041144    -0.13   0.895    -1.682586    1.470381
           _Dyear7 |  -.0982585    .964528    -0.10   0.919    -1.989236    1.792719
           _Dyear8 |  -.0889125    1.12513    -0.08   0.937    -2.294754    2.116929
           _Dyear9 |  -.1098144   1.285669    -0.09   0.932    -2.630397    2.410768
          _Dyear10 |  -.1368694   1.445964    -0.09   0.925    -2.971713    2.697974
          _Dyear11 |  -.1644933   1.606435    -0.10   0.918    -3.313944    2.984957
          _Dyear12 |  -.1864765   1.766834    -0.11   0.916    -3.650393     3.27744
          _Dyear13 |  -.1948509   1.927152    -0.10   0.919    -3.973073    3.583372
          _Dyear14 |  -.2453588   2.087904    -0.12   0.906    -4.338739    3.848021
          _Dyear15 |  -.2571417   2.247486    -0.11   0.909    -4.663387    4.149104
          _Dyear16 |  -.2875926   2.408252    -0.12   0.905    -5.009022    4.433837
   _DtimesinceAll1 |   .2452425   .6965251     0.35   0.725     -1.12031    1.610795
   _DtimesinceAll2 |   .2616661   .6481999     0.40   0.686    -1.009144    1.532476
   _DtimesinceAll3 |   .2723928   .5998377     0.45   0.650    -.9036019    1.448388
   _DtimesinceAll4 |    .281193   .5513885     0.51   0.610    -.7998161    1.362202
   _DtimesinceAll5 |   .2870935   .5030383     0.57   0.568    -.6991239    1.273311
   _DtimesinceAll6 |   .2529461   .4546869     0.56   0.578    -.6384774     1.14437
   _DtimesinceAll7 |   .1919278   .4064352     0.47   0.637    -.6048972    .9887528
   _DtimesinceAll8 |   .1661547   .3583076     0.46   0.643     -.536315    .8686245
   _DtimesinceAll9 |   .1550903   .3102668     0.50   0.617    -.4531944     .763375
  _DtimesinceAll10 |   .1539694   .2621981     0.59   0.557    -.3600757    .6680145
  _DtimesinceAll11 |   .1538865   .2142198     0.72   0.473    -.2660959     .573869
  _DtimesinceAll12 |   .0935801   .1669201     0.56   0.575    -.2336703    .4208306
  _DtimesinceAll13 |   .0575289   .1195914     0.48   0.631    -.1769325    .2919904
  _DtimesinceAll14 |   .0615793   .0756861     0.81   0.416     -.086805    .2099635
  _DtimesinceAll15 |          0  (omitted)
  _DtimesinceAll16 |          0  (omitted)
               age |          0  (omitted)
              age2 |   .0019714   .0053268     0.37   0.711    -.0084719    .0124147
              age3 |  -.0000539   .0000816    -0.66   0.509    -.0002139    .0001061
              age4 |   4.24e-07   4.59e-07     0.92   0.356    -4.76e-07    1.32e-06
             _cons |   .0573076   3.717973     0.02   0.988    -7.231858    7.346473
-------------------+----------------------------------------------------------------
           sigma_u |  .22716925
           sigma_e |  .26442765
               rho |  .42464232   (fraction of variance due to u_i)
------------------------------------------------------------------------------------
F test that all u_i=0: F(393, 4256) = 8.07                   Prob > F = 0.0000
    - eventstudy_figure, from(`from') to(`to') name(g`i++') `omitcat' tit(SWH Specification) subtit(Outcome: Employment) ytitle(Employed) `opt'
    = eventstudy_figure, from(-5) to(10) name(g104) omit(-1) tit(SWH Specification) subtit(Outcome: Employment) ytitle(Employed) ysize(8) xsize(12) xline(-0.5, lco
> l(gray)) legend(off)
16
number of observations will be reset to 15
Press any key to continue, or Break to abort
Number of observations (_N) was 0, now 15.
(0 observations deleted)
(1 observation created)
(1 real change made)
(1 real change made)
(1 real change made)
(4 real changes made)
    - latexlog `file': addfig, file(Eventstudy/eventstudy_FE_Full_employed.pdf) eol
    = latexlog ../log/eventstudy_analysis.tex: addfig, file(Eventstudy/eventstudy_FE_Full_employed.pdf) eol
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex

macros:
           r(filename) : "eventstudy_analysis.tex"
            r(fileend) : "tex"
           r(filestub) : "eventstudy_analysis"
               r(path) : "../log/"
../log/
Path: Eventstudy/
Filestub: eventstudy_FE_Full_employed
Fileend: pdf
Filename: eventstudy_FE_Full_employed.pdf
file /Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do/../log/Eventstudy/eventstudy_FE_Full_employed.pdf
    saved as PDF format
    - latexlog `file': close
    = latexlog ../log/eventstudy_analysis.tex: close
    - latexlog `file': pdf, view
    = latexlog ../log/eventstudy_analysis.tex: pdf, view
Path: ../log/
Filestub: eventstudy_analysis
Fileend: tex
Filename: eventstudy_analysis.tex
/Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/log

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)
 \write18 enabled.
 Source specials enabled.
entering extended mode
(./eventstudy_analysis.tex
LaTeX2e <2021-11-15> patch level 1
L3 programming layer <2022-02-24>
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/article.cls
Document Class: article 2021/10/04 v1.4n Standard LaTeX document class
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/size10.clo))
(/usr/local/texlive/2022/texmf-dist/tex/latex/geometry/geometry.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/keyval.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/ifvtex.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/iftex.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/booktabs/booktabs.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/longtable.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/pdflscape/pdflscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/lscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphics.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/trig.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/graphics.cfg)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-def/pdftex.def))))
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/rotating.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphicx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/ifthen.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/threeparttable/threeparttable.sty
) (/usr/local/texlive/2022/texmf-dist/tex/latex/caption/subcaption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption3.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/ltcaption.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/float/float.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/tabularx.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/array.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/xcolor/xcolor.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/color.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/colortbl/colortbl.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hyperref.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdftexcmds/pdftexcmds.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/infwarerr/infwarerr.sty))
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdfescape/pdfescape.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hycolor/hycolor.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/auxhook/auxhook.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/kvoptions/kvoptions.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/pd1enc.def)
(/usr/local/texlive/2022/texmf-dist/tex/generic/intcalc/intcalc.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/etexcmds/etexcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/puenc.def)
(/usr/local/texlive/2022/texmf-dist/tex/latex/url/url.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/bitset/bitset.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atbegshi-ltx.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hpdftex.def
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atveryend-ltx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty

(/usr/local/texlive/2022/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty
)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.def)
No file eventstudy_analysis.aux.
*geometry* driver: auto-detecting
*geometry* detected driver: pdftex
*geometry* verbose mode - [ preamble ] result:
* driver: pdftex
* paper: letterpaper
* layout: <same size as paper>
* layoutoffset:(h,v)=(0.0pt,0.0pt)
* modes: 
* h-part:(L,W,R)=(71.13188pt, 451.01793pt, 92.14519pt)
* v-part:(T,H,B)=(71.13188pt, 628.44073pt, 95.39737pt)
* \paperwidth=614.295pt
* \paperheight=794.96999pt
* \textwidth=451.01793pt
* \textheight=628.44073pt
* \oddsidemargin=-1.1381pt
* \evensidemargin=-1.1381pt
* \topmargin=-38.1381pt
* \headheight=12.0pt
* \headsep=25.0pt
* \topskip=10.0pt
* \footskip=30.0pt
* \marginparwidth=65.0pt
* \marginparsep=11.0pt
* \columnsep=10.0pt
* \skip\footins=9.0pt plus 4.0pt minus 2.0pt
* \hoffset=0.0pt
* \voffset=0.0pt
* \mag=1000
* \@twocolumnfalse
* \@twosidefalse
* \@mparswitchfalse
* \@reversemarginfalse
* (1in=72.27pt=25.4mm, 1cm=28.453pt)

(/usr/local/texlive/2022/texmf-dist/tex/context/base/mkii/supp-pdf.mkii
[Loading MPS to PDF converter (version 2006.09.02).]
) (/usr/local/texlive/2022/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/nameref.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/refcount/refcount.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/gettitlestring/gettitlestring.s
ty))

LaTeX Warning: No \author given.


Underfull \hbox (badness 10000) in paragraph at lines 13--19

[1{/usr/local/texlive/2022/texmf-var/fonts/map/pdftex/updmap/pdftex.map} <./Eve
ntstudy/eventstudy_RawMeans.pdf>] [2 <./Eventstudy/eventstudy_OLS.pdf> <./Event
study/eventstudy_FE_JLS.pdf>] [3 <./Eventstudy/eventstudy_FE_RelYear.pdf> <./Ev
entstudy/eventstudy_FE_Full.pdf>] [4 <./Eventstudy/eventstudy_FE_Full_employed.
pdf>] (./eventstudy_analysis.aux)

Package rerunfilecheck Warning: File `eventstudy_analysis.out' has changed.
(rerunfilecheck)                Rerun to get outlines right
(rerunfilecheck)                or use package `bookmark'.

 )
(see the transcript file for additional information)</usr/local/texlive/2022/te
xmf-dist/fonts/type1/public/amsfonts/cm/cmr10.pfb></usr/local/texlive/2022/texm
f-dist/fonts/type1/public/amsfonts/cm/cmr17.pfb>
Output written on eventstudy_analysis.pdf (4 pages, 146766 bytes).
Transcript written on eventstudy_analysis.log.

This is pdfTeX, Version 3.141592653-2.6-1.40.24 (TeX Live 2022) (preloaded format=pdflatex)
 \write18 enabled.
 Source specials enabled.
entering extended mode
(./eventstudy_analysis.tex
LaTeX2e <2021-11-15> patch level 1
L3 programming layer <2022-02-24>
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/article.cls
Document Class: article 2021/10/04 v1.4n Standard LaTeX document class
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/size10.clo))
(/usr/local/texlive/2022/texmf-dist/tex/latex/geometry/geometry.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/keyval.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/ifvtex.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/iftex/iftex.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/booktabs/booktabs.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/longtable.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/pdflscape/pdflscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/lscape.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphics.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/trig.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/graphics.cfg)
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-def/pdftex.def))))
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/rotating.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics/graphicx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/ifthen.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/threeparttable/threeparttable.sty
) (/usr/local/texlive/2022/texmf-dist/tex/latex/caption/subcaption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/caption3.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/caption/ltcaption.sty)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/float/float.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/tabularx.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/tools/array.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/xcolor/xcolor.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/graphics-cfg/color.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/colortbl/colortbl.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hyperref.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/ltxcmds/ltxcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdftexcmds/pdftexcmds.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/infwarerr/infwarerr.sty))
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvsetkeys/kvsetkeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/kvdefinekeys/kvdefinekeys.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/pdfescape/pdfescape.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hycolor/hycolor.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/letltxmacro/letltxmacro.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/auxhook/auxhook.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/kvoptions/kvoptions.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/pd1enc.def)
(/usr/local/texlive/2022/texmf-dist/tex/generic/intcalc/intcalc.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/etexcmds/etexcmds.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/puenc.def)
(/usr/local/texlive/2022/texmf-dist/tex/latex/url/url.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/bitset/bitset.sty
(/usr/local/texlive/2022/texmf-dist/tex/generic/bigintcalc/bigintcalc.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atbegshi-ltx.sty))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/hpdftex.def
(/usr/local/texlive/2022/texmf-dist/tex/latex/base/atveryend-ltx.sty)
(/usr/local/texlive/2022/texmf-dist/tex/latex/rerunfilecheck/rerunfilecheck.sty

(/usr/local/texlive/2022/texmf-dist/tex/generic/uniquecounter/uniquecounter.sty
)))
(/usr/local/texlive/2022/texmf-dist/tex/latex/l3backend/l3backend-pdftex.def)
(./eventstudy_analysis.aux)
*geometry* driver: auto-detecting
*geometry* detected driver: pdftex
*geometry* verbose mode - [ preamble ] result:
* driver: pdftex
* paper: letterpaper
* layout: <same size as paper>
* layoutoffset:(h,v)=(0.0pt,0.0pt)
* modes: 
* h-part:(L,W,R)=(71.13188pt, 451.01793pt, 92.14519pt)
* v-part:(T,H,B)=(71.13188pt, 628.44073pt, 95.39737pt)
* \paperwidth=614.295pt
* \paperheight=794.96999pt
* \textwidth=451.01793pt
* \textheight=628.44073pt
* \oddsidemargin=-1.1381pt
* \evensidemargin=-1.1381pt
* \topmargin=-38.1381pt
* \headheight=12.0pt
* \headsep=25.0pt
* \topskip=10.0pt
* \footskip=30.0pt
* \marginparwidth=65.0pt
* \marginparsep=11.0pt
* \columnsep=10.0pt
* \skip\footins=9.0pt plus 4.0pt minus 2.0pt
* \hoffset=0.0pt
* \voffset=0.0pt
* \mag=1000
* \@twocolumnfalse
* \@twosidefalse
* \@mparswitchfalse
* \@reversemarginfalse
* (1in=72.27pt=25.4mm, 1cm=28.453pt)

(/usr/local/texlive/2022/texmf-dist/tex/context/base/mkii/supp-pdf.mkii
[Loading MPS to PDF converter (version 2006.09.02).]
) (/usr/local/texlive/2022/texmf-dist/tex/latex/epstopdf-pkg/epstopdf-base.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/latexconfig/epstopdf-sys.cfg))
(/usr/local/texlive/2022/texmf-dist/tex/latex/hyperref/nameref.sty
(/usr/local/texlive/2022/texmf-dist/tex/latex/refcount/refcount.sty)
(/usr/local/texlive/2022/texmf-dist/tex/generic/gettitlestring/gettitlestring.s
ty)) (./eventstudy_analysis.out) (./eventstudy_analysis.out)

LaTeX Warning: No \author given.


Underfull \hbox (badness 10000) in paragraph at lines 13--19

[1{/usr/local/texlive/2022/texmf-var/fonts/map/pdftex/updmap/pdftex.map} <./Eve
ntstudy/eventstudy_RawMeans.pdf>] [2 <./Eventstudy/eventstudy_OLS.pdf> <./Event
study/eventstudy_FE_JLS.pdf>] [3 <./Eventstudy/eventstudy_FE_RelYear.pdf> <./Ev
entstudy/eventstudy_FE_Full.pdf>] [4 <./Eventstudy/eventstudy_FE_Full_employed.
pdf>] (./eventstudy_analysis.aux) )
(see the transcript file for additional information)</usr/local/texlive/2022/te
xmf-dist/fonts/type1/public/amsfonts/cm/cmr10.pfb></usr/local/texlive/2022/texm
f-dist/fonts/type1/public/amsfonts/cm/cmr17.pfb>
Output written on eventstudy_analysis.pdf (4 pages, 146766 bytes).
Transcript written on eventstudy_analysis.log.
/Users/johannes/Library/CloudStorage/Dropbox-Personal/research/Code/Stata Tools/MatchingEventstudy/do

    ----------------------------------------------------------------------------------------------------------------------------------- end eventstudy_analysis ---
  - cap log close log
